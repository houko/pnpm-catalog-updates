export const metadata = {
  title: 'å¼€å‘',
  description: 'è®¾ç½® pnpm-catalog-updates è¿›è¡Œå¼€å‘ã€‚äº†è§£é¡¹ç›®ç»“æ„ã€å¼€å‘å·¥ä½œæµç¨‹ä»¥åŠå¦‚ä½•è´¡çŒ®ã€‚',
};

# å¼€å‘

è®¾ç½® PCU è¿›è¡Œå¼€å‘å¹¶å­¦ä¹ å¦‚ä½•ä¸ºé¡¹ç›®åšå‡ºè´¡çŒ®ã€‚æœ¬æŒ‡å—æ¶µç›–é¡¹ç›®è®¾ç½®ã€æ¶æ„å’Œå¼€å‘å·¥ä½œæµç¨‹ã€‚{{ className: 'lead' }}

## å…ˆå†³æ¡ä»¶

åœ¨å¼€å§‹å¼€å‘ PCU ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨æ‹¥æœ‰æ‰€éœ€çš„å·¥å…·ï¼š

<Note>å¼€å‘éœ€è¦ Node.js >= 22.0.0 å’Œ pnpm >= 10.0.0ã€‚</Note>

<CodeGroup>

```bash {{ title: 'æ£€æŸ¥ç‰ˆæœ¬' }}
node --version  # åº”è¯¥æ˜¯ >= 22.0.0
pnpm --version  # åº”è¯¥æ˜¯ >= 10.0.0
```

```bash {{ title: 'å®‰è£…å·¥å…·' }}
# é€šè¿‡ nvm å®‰è£… Node.jsï¼ˆæ¨èï¼‰
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 22
nvm use 22

# å®‰è£… pnpm
npm install -g pnpm@latest
```

</CodeGroup>

## é¡¹ç›®è®¾ç½®

å…‹éš†å¹¶è®¾ç½®å¼€å‘ç¯å¢ƒï¼š

<CodeGroup>

```bash {{ title: 'å…‹éš†å’Œè®¾ç½®' }}
# å…‹éš†ä»“åº“
git clone https://github.com/houko/pnpm-catalog-updates.git
cd pnpm-catalog-updates

# å®‰è£…ä¾èµ–
pnpm install

# æ„å»ºé¡¹ç›®
pnpm build

# è¿è¡Œæµ‹è¯•éªŒè¯è®¾ç½®
pnpm test
```

```bash {{ title: 'å¼€å‘æ¨¡å¼' }}
# ä»¥å¼€å‘æ¨¡å¼è¿è¡Œ
pnpm dev --help

# ç›‘è§†æ¨¡å¼æ„å»º
pnpm build:watch

# ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯•
pnpm test:watch
```

</CodeGroup>

## é¡¹ç›®æ¶æ„

PCU éµå¾ªæ¸…æ´æ¶æ„åŸåˆ™ï¼Œå…³æ³¨ç‚¹æ¸…æ™°åˆ†ç¦»ï¼š

```text
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ cli/                    # CLI åº”ç”¨å±‚
â”‚   â”‚   â”œâ”€â”€ src/cli/           # CLI æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/      # å‘½ä»¤å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters/    # è¾“å‡ºæ ¼å¼åŒ–å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ interactive/   # äº¤äº’å¼æç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ themes/        # é¢œè‰²ä¸»é¢˜
â”‚   â”‚   â”‚   â””â”€â”€ validators/    # è¾“å…¥éªŒè¯
â”‚   â”‚   â””â”€â”€ bin/               # å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶
â”‚   â””â”€â”€ docs/                  # æ–‡æ¡£ç«™ç‚¹
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                  # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ application/   # åº”ç”¨æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ domain/        # é¢†åŸŸæ¨¡å‹ (DDD)
â”‚   â”‚       â””â”€â”€ infrastructure/# åŸºç¡€è®¾æ–½å±‚
â”‚   â””â”€â”€ utils/                 # å…±äº«å·¥å…·
â””â”€â”€ scripts/                   # æ„å»ºå’Œéƒ¨ç½²
```

### æ¶æ„å±‚

<Properties>
  <Property name="CLI å±‚" type="apps/cli">
    ç”¨æˆ·ç•Œé¢ã€å‘½ä»¤è§£æã€è¾“å‡ºæ ¼å¼åŒ–
  </Property>
  <Property name="åº”ç”¨å±‚" type="packages/core/application">
    ä¸šåŠ¡é€»è¾‘ç¼–æ’ã€ç”¨ä¾‹
  </Property>
  <Property name="é¢†åŸŸå±‚" type="packages/core/domain">
    æ ¸å¿ƒä¸šåŠ¡å®ä½“ã€å€¼å¯¹è±¡ã€ä»“åº“æ¥å£
  </Property>
  <Property name="åŸºç¡€è®¾æ–½å±‚" type="packages/core/infrastructure">
    å¤–éƒ¨ API å®¢æˆ·ç«¯ã€æ–‡ä»¶ç³»ç»Ÿè®¿é—®ã€ä»“åº“å®ç°
  </Property>
  <Property name="å·¥å…·å±‚" type="packages/utils">
    å…±äº«å·¥å…·ã€é…ç½®ã€æ—¥å¿—è®°å½•ã€é”™è¯¯å¤„ç†
  </Property>
</Properties>

## å¼€å‘å·¥ä½œæµç¨‹

### è¿›è¡Œæ›´æ”¹

1. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**ï¼š

   ```bash
   git checkout -b feature/amazing-feature
   ```

2. **æŒ‰ç…§ç¼–ç æ ‡å‡†è¿›è¡Œæ›´æ”¹**

3. **ä¸ºæ‚¨çš„æ›´æ”¹æ·»åŠ æµ‹è¯•**ï¼š

   ```bash
   pnpm test:watch  # ä»¥ç›‘è§†æ¨¡å¼è¿è¡Œæµ‹è¯•
   ```

4. **ç¡®ä¿è´¨é‡æ£€æŸ¥é€šè¿‡**ï¼š

   ```bash
   pnpm lint        # æ£€æŸ¥ä»£ç é£æ ¼
   pnpm typecheck   # ç±»å‹æ£€æŸ¥
   pnpm test        # è¿è¡Œæ‰€æœ‰æµ‹è¯•
   ```

5. **æäº¤æ›´æ”¹**ï¼š
   ```bash
   git commit -m 'feat: add amazing feature'
   ```

### æµ‹è¯•ç­–ç•¥

PCU ä½¿ç”¨ç»¼åˆæµ‹è¯•æ–¹æ³•ï¼š

<CodeGroup>

```bash {{ title: 'å•å…ƒæµ‹è¯•' }}
# è¿è¡Œå•å…ƒæµ‹è¯•
pnpm test

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
pnpm test:coverage

# æµ‹è¯•ç‰¹å®šåŒ…
pnpm --filter @pcu/core test
```

```bash {{ title: 'ç«¯åˆ°ç«¯æµ‹è¯•' }}
# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
pnpm test:e2e

# é’ˆå¯¹çœŸå®é¡¹ç›®æµ‹è¯•
pnpm test:e2e --project example-workspace
```

```bash {{ title: 'é›†æˆæµ‹è¯•' }}
# æµ‹è¯• CLI å‘½ä»¤
pnpm test:cli

# ä½¿ç”¨ä¸åŒ Node ç‰ˆæœ¬æµ‹è¯•
nvm use 18 && pnpm test
nvm use 20 && pnpm test
nvm use 22 && pnpm test
```

</CodeGroup>

### ä»£ç è´¨é‡

PCU ä¿æŒé«˜ä»£ç è´¨é‡æ ‡å‡†ï¼š

<CodeGroup>

```bash {{ title: 'ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–' }}
# æ£€æŸ¥ä»£ç é£æ ¼
pnpm lint

# ä¿®å¤ä»£ç æ£€æŸ¥é—®é¢˜
pnpm lint:fix

# æ ¼å¼åŒ–ä»£ç 
pnpm format

# æ£€æŸ¥ TypeScript ç±»å‹
pnpm typecheck
```

```json {{ title: 'è´¨é‡æ ‡å‡†' }}
{
  "coverage": {
    "statements": 85,
    "branches": 80,
    "functions": 85,
    "lines": 85
  },
  "lint": "å¸¦ TypeScript è§„åˆ™çš„ ESLint",
  "format": "å¸¦è‡ªå®šä¹‰é…ç½®çš„ Prettier",
  "types": "ä¸¥æ ¼çš„ TypeScript é…ç½®"
}
```

</CodeGroup>

## æ·»åŠ åŠŸèƒ½

### åˆ›å»ºæ–°å‘½ä»¤

1. **åœ¨ `apps/cli/src/cli/commands/` åˆ›å»ºå‘½ä»¤å¤„ç†å™¨**ï¼š

<CodeGroup>

```typescript {{ title: 'newCommand.ts' }}
import { Command } from 'commander';
import { GlobalOptions } from '../options';

export function createNewCommand(): Command {
  return new Command('new')
    .description('æ–°å‘½ä»¤æè¿°')
    .option('-f, --format <type>', 'è¾“å‡ºæ ¼å¼', 'table')
    .action(async (options: NewCommandOptions) => {
      // å‘½ä»¤å®ç°
    });
}

interface NewCommandOptions extends GlobalOptions {
  format: string;
}
```

```typescript {{ title: 'æ³¨å†Œå‘½ä»¤' }}
// åœ¨ apps/cli/src/cli/index.ts ä¸­
import { createNewCommand } from './commands/newCommand';

program.addCommand(createNewCommand());
```

</CodeGroup>

2. **åœ¨ `packages/core/src/application/services/` æ·»åŠ ä¸šåŠ¡é€»è¾‘**

3. **ä¸º CLI å’Œæ ¸å¿ƒé€»è¾‘åˆ›å»ºæµ‹è¯•**

4. **æ›´æ–°æ–‡æ¡£**

### æ·»åŠ æ–°è¾“å‡ºæ ¼å¼

1. **åœ¨ `apps/cli/src/cli/formatters/` åˆ›å»ºæ ¼å¼åŒ–å™¨**ï¼š

```typescript {{ title: 'xmlFormatter.ts' }}
import { OutputFormatter, FormattedOutput } from './outputFormatter';

export class XmlFormatter implements OutputFormatter {
  format(data: any): FormattedOutput {
    // XML æ ¼å¼åŒ–é€»è¾‘
    return {
      content: xmlContent,
      type: 'xml',
    };
  }
}
```

2. **åœ¨ä¸»æ ¼å¼åŒ–å™¨æ³¨å†Œè¡¨ä¸­æ³¨å†Œæ ¼å¼åŒ–å™¨**

3. **æ·»åŠ æµ‹è¯•**å’Œ**æ›´æ–°æ–‡æ¡£**

## è´¡çŒ®æŒ‡å—

### æäº¤æ¶ˆæ¯çº¦å®š

PCU ä½¿ç”¨[çº¦å®šå¼æäº¤](https://conventionalcommits.org/)ï¼š

<CodeGroup>

```bash {{ title: 'æäº¤ç±»å‹' }}
feat: æ–°åŠŸèƒ½
fix: é”™è¯¯ä¿®å¤
docs: ä»…æ–‡æ¡£æ›´æ”¹
style: ä»£ç é£æ ¼æ›´æ”¹ï¼ˆæ ¼å¼åŒ–ç­‰ï¼‰
refactor: æ—¢ä¸ä¿®å¤é”™è¯¯ä¹Ÿä¸æ·»åŠ åŠŸèƒ½çš„ä»£ç æ›´æ”¹
test: æ·»åŠ ç¼ºå¤±æµ‹è¯•æˆ–æ›´æ­£ç°æœ‰æµ‹è¯•
chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„æ›´æ”¹
```

```bash {{ title: 'ç¤ºä¾‹' }}
feat: æ·»åŠ å¯¹è‡ªå®šä¹‰æ³¨å†Œè¡¨çš„æ”¯æŒ
fix: ä¼˜é›…å¤„ç†ç½‘ç»œè¶…æ—¶
docs: æ›´æ–°é…ç½®ç¤ºä¾‹
test: æ·»åŠ åŒ…è¿‡æ»¤æµ‹è¯•
```

</CodeGroup>

### æ‹‰å–è¯·æ±‚æµç¨‹

1. **Fork ä»“åº“**å¹¶åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
2. **æŒ‰ç…§å¼€å‘å·¥ä½œæµç¨‹è¿›è¡Œæ›´æ”¹**
3. **ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡**å’Œä»£ç è´¨é‡æ£€æŸ¥æˆåŠŸ
4. **å¦‚éœ€è¦æ›´æ–°æ–‡æ¡£**
5. **æäº¤æ‹‰å–è¯·æ±‚**åŒ…å«ï¼š
   - æ›´æ”¹çš„æ¸…æ¥šæè¿°
   - ç›¸å…³é—®é¢˜çš„é“¾æ¥
   - UI æ›´æ”¹çš„å±å¹•æˆªå›¾
   - å¦‚é€‚ç”¨çš„ç ´åæ€§æ›´æ”¹è¯´æ˜

### ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•

- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç è¦†ç›–ç‡ä¿æŒï¼ˆ>85%ï¼‰
- [ ] TypeScript ç±»å‹æ­£ç¡®
- [ ] ä»£ç é£æ ¼éµå¾ªé¡¹ç›®æ ‡å‡†
- [ ] æ–‡æ¡£å·²æ›´æ–°
- [ ] ç ´åæ€§æ›´æ”¹å·²è®°å½•
- [ ] è€ƒè™‘æ€§èƒ½å½±å“

## è°ƒè¯•

### å¼€å‘è°ƒè¯•

<CodeGroup>

```bash {{ title: 'è°ƒè¯• CLI å‘½ä»¤' }}
# ä½¿ç”¨ Node.js æ£€æŸ¥å™¨è°ƒè¯•
node --inspect-brk ./apps/cli/bin/pcu.js --help

# ä½¿ç”¨ VS Code è°ƒè¯•
# ä½¿ç”¨ .vscode/launch.json ä¸­çš„å¯åŠ¨é…ç½®
```

```bash {{ title: 'è¯¦ç»†æ—¥å¿—' }}
# å¯ç”¨è°ƒè¯•æ—¥å¿—
DEBUG=pcu:* pnpm dev --verbose

# è°ƒè¯•ç‰¹å®šæ¨¡å—
DEBUG=pcu:core,pcu:cli pcu -c
```

</CodeGroup>

### æµ‹è¯•è°ƒè¯•

```bash
# è°ƒè¯•ç‰¹å®šæµ‹è¯•
npm test -- --grep "specific test name"

# ä½¿ç”¨ Node æ£€æŸ¥å™¨è°ƒè¯•
node --inspect-brk node_modules/.bin/vitest run
```

## æ„å»ºå’Œå‘å¸ƒ

### æœ¬åœ°æµ‹è¯•

<CodeGroup>

```bash {{ title: 'æµ‹è¯•æœ¬åœ°æ„å»º' }}
# æ„å»ºå¹¶æœ¬åœ°æµ‹è¯•
pnpm build
pnpm --filter @pcu/cli start --help

# æµ‹è¯•å®‰è£…
npm pack apps/cli
npm install -g pcu-*.tgz
```

```bash {{ title: 'åœ¨ç¤ºä¾‹é¡¹ç›®ä¸­æµ‹è¯•' }}
# ä½¿ç”¨ç¤ºä¾‹å·¥ä½œç©ºé—´
cd apps/example
pcu -c
pcu -u --dry-run
```

</CodeGroup>

### å‘å¸ƒæµç¨‹

1. **ä½¿ç”¨ changesets æ›´æ–°ç‰ˆæœ¬**ï¼š

   ```bash
   pnpm changeset
   pnpm changeset version
   ```

2. **æ„å»ºå’Œæµ‹è¯•**ï¼š

   ```bash
   pnpm build
   pnpm test
   pnpm test:e2e
   ```

3. **å‘å¸ƒ**ï¼ˆä»…ç»´æŠ¤è€…ï¼‰ï¼š
   ```bash
   pnpm publish -r
   ```

## è·å–å¸®åŠ©

- ğŸ“– **æ–‡æ¡£**ï¼šæŸ¥çœ‹æ­¤æ–‡æ¡£è·å–è¯¦ç»†æŒ‡å—
- ğŸ› **é—®é¢˜**ï¼šé€šè¿‡ [GitHub Issues](https://github.com/houko/pnpm-catalog-updates/issues) æŠ¥å‘Šé”™è¯¯
- ğŸ’¬ **è®¨è®º**ï¼šåœ¨ [GitHub Discussions](https://github.com/houko/pnpm-catalog-updates/discussions) ä¸­æé—®
- ğŸ”§ **å¼€å‘**ï¼šåŠ å…¥ Issues å’Œ PRs ä¸­çš„å¼€å‘è®¨è®º
