export const metadata = {
  title: 'é…ç½®',
  description:
    'å­¦ä¹ å¦‚ä½•ä½¿ç”¨ .pcurc.json è®¾ç½®ã€åŒ…è§„åˆ™å’Œé«˜çº§é€‰é¡¹ä¸ºæ‚¨çš„å·¥ä½œæµé…ç½® pnpm-catalog-updatesã€‚',
};

# é…ç½®

é…ç½® PCU ä»¥åŒ¹é…æ‚¨çš„å·¥ä½œæµå’Œé¡¹ç›®éœ€æ±‚ã€‚äº†è§£é…ç½®æ–‡ä»¶ã€åŒ…ç‰¹å®šè§„åˆ™å’Œé«˜çº§è®¾ç½®ã€‚{{ className: 'lead' }}

## é…ç½®æ–‡ä»¶ç±»å‹

PCU æ”¯æŒå¤šç§é…ç½®æ–‡ä»¶æ ¼å¼å’Œä½ç½®ä»¥é€‚åº”ä¸åŒçš„å¼€å‘å·¥ä½œæµã€‚

### æ”¯æŒçš„é…ç½®æ–‡ä»¶

PCU æŒ‰ä»¥ä¸‹é¡ºåºæœç´¢é…ç½®æ–‡ä»¶ï¼ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªç”Ÿæ•ˆï¼‰ï¼š

<Properties>
  <Property name=".pcurc.json" type="JSON">
    é¡¹ç›®æ ¹ç›®å½•ä¸­çš„ä¸»è¦ JSON é…ç½®æ–‡ä»¶
  </Property>
  <Property name=".pcurc.js" type="JavaScript">
    æ”¯æŒåŠ¨æ€é…ç½®çš„ JavaScript é…ç½®æ–‡ä»¶
  </Property>
  <Property name="pcu.config.js" type="JavaScript">
    æ›¿ä»£çš„ JavaScript é…ç½®æ–‡ä»¶å
  </Property>
  <Property name="~/.pcurc.json" type="JSON">
    ä¸»ç›®å½•ä¸­çš„å…¨å±€ç”¨æˆ·é…ç½®
  </Property>
  <Property name="package.json" type="JSON">
    package.json ä¸­çš„ "pcu" é”®ä¸‹çš„é…ç½®
  </Property>
</Properties>

### JavaScript é…ç½®æ”¯æŒ

JavaScript é…ç½®æ–‡ä»¶æ”¯æŒåŸºäºç¯å¢ƒã€å·¥ä½œç©ºé—´ç»“æ„æˆ–å…¶ä»–è¿è¡Œæ—¶æ¡ä»¶çš„åŠ¨æ€é…ç½®ï¼š

<CodeGroup>

```javascript {{ title: '.pcurc.js' }}
module.exports = {
  defaults: {
    target: process.env.NODE_ENV === 'production' ? 'minor' : 'latest',
    createBackup: true,
  },
  workspace: {
    autoDiscover: true,
    catalogMode: 'strict',
  },
  // åŸºäºå·¥ä½œç©ºé—´ç»“æ„çš„åŠ¨æ€åŒ…è§„åˆ™
  packageRules: [
    {
      patterns: ['react*'],
      target: 'minor',
      requireConfirmation: process.env.CI !== 'true',
    },
  ],
  // ç¯å¢ƒç‰¹å®šé…ç½®
  ...(process.env.NODE_ENV === 'development' && {
    ui: {
      theme: 'modern',
      progressBarStyle: 'fancy',
    },
  }),
};
```

```javascript {{ title: 'å¸¦å‡½æ•°çš„ pcu.config.js' }}
const fs = require('fs');
const path = require('path');

function getWorkspacePackages() {
  const workspaceFile = path.join(__dirname, 'pnpm-workspace.yaml');
  if (fs.existsSync(workspaceFile)) {
    // åŠ¨æ€è§£æå·¥ä½œç©ºé—´åŒ…
    return ['packages/*', 'apps/*', 'tools/*'];
  }
  return ['packages/*'];
}

module.exports = {
  workspace: {
    packages: getWorkspacePackages(),
    catalogMode: 'flexible',
  },
  packageRules: [
    // åŸºäºç°æœ‰åŒ…ç”Ÿæˆè§„åˆ™
    ...fs.readdirSync('./packages').map((pkg) => ({
      patterns: [`@myorg/${pkg}`],
      target: 'minor',
    })),
  ],
};
```

</CodeGroup>

### Package.json é…ç½®

å¯¹äºç®€å•é¡¹ç›®ï¼Œé…ç½®å¯ä»¥åµŒå…¥åˆ° package.json ä¸­ï¼š

```json
{
  "name": "my-project",
  "pcu": {
    "defaults": {
      "target": "minor",
      "createBackup": true
    },
    "packageRules": [
      {
        "patterns": ["@types/*"],
        "target": "latest",
        "autoUpdate": true
      }
    ]
  }
}
```

### é…ç½®éªŒè¯

PCU è‡ªåŠ¨éªŒè¯é…ç½®æ–‡ä»¶å¹¶ä¸ºå¸¸è§é—®é¢˜æä¾›è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯ï¼š

#### éªŒè¯åŠŸèƒ½

- **JSON æ¨¡å¼éªŒè¯**ï¼šç¡®ä¿æ‰€æœ‰é…ç½®å±æ€§æœ‰æ•ˆ
- **æ¨¡å¼éªŒè¯**ï¼šéªŒè¯é€šé…ç¬¦æ¨¡å¼å’ŒåŒ…åç§°æ ¼å¼
- **ç±»å‹æ£€æŸ¥**ï¼šéªŒè¯æ‰€æœ‰é…ç½®å€¼çš„æ­£ç¡®æ•°æ®ç±»å‹
- **å†²çªæ£€æµ‹**ï¼šè¯†åˆ«å†²çªçš„è§„åˆ™å’Œé…ç½®é€‰é¡¹
- **å»ºè®®ç³»ç»Ÿ**ï¼šä¸ºä¿®å¤é…ç½®é”™è¯¯æä¾›æœ‰ç”¨å»ºè®®

#### éªŒè¯ç¤ºä¾‹

```bash
# éªŒè¯å½“å‰é…ç½®
pcu workspace --validate

# å¸¸è§éªŒè¯é”™è¯¯åŠå»ºè®®ï¼š
# âŒ packageRules[0] ä¸­æ— æ•ˆçš„ç›®æ ‡ "lastest"
#    ğŸ’¡ æ‚¨æ˜¯å¦æƒ³è¦ "latest"ï¼Ÿ
#
# âŒ æ¨¡å¼ "react+" æ˜¯æ— æ•ˆçš„é€šé…ç¬¦è¯­æ³•
#    ğŸ’¡ ä½¿ç”¨ "react*" åŒ¹é…ä»¥ "react" å¼€å¤´çš„åŒ…
#
# âš ï¸  åŒ… "react" å­˜åœ¨å†²çªè§„åˆ™
#    ğŸ“ ç´¢å¼• 0 å’Œ 2 çš„è§„åˆ™éƒ½åŒ¹é…æ­¤åŒ…
```

<CodeGroup>

```json {{ title: 'åŸºæœ¬é…ç½®' }}
{
  "defaults": {
    "target": "latest",
    "timeout": 30000,
    "parallel": 5
  },
  "workspace": {
    "autoDiscover": true,
    "catalogMode": "strict"
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  }
}
```

```json {{ title: 'é«˜çº§é…ç½®' }}
{
  "defaults": {
    "target": "minor",
    "createBackup": true
  },
  "update": {
    "interactive": true,
    "dryRunFirst": true,
    "skipPrereleases": false
  },
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "animations": true
  },
  "advanced": {
    "concurrency": 5,
    "timeout": 30000,
    "retries": 3,
    "cacheValidityMinutes": 60
  }
}
```

</CodeGroup>

## åŒ…è¿‡æ»¤

ä½¿ç”¨åŒ…å«/æ’é™¤æ¨¡å¼å’ŒåŒ…ç‰¹å®šè§„åˆ™æ§åˆ¶è¦æ›´æ–°çš„åŒ…ã€‚

<CodeGroup>

```json {{ title: 'ç®€å•è¿‡æ»¤' }}
{
  "exclude": ["typescript", "@types/node", "react", "react-dom"],
  "include": ["lodash*", "chalk", "commander"]
}
```

```json {{ title: 'åŒ…è§„åˆ™' }}
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": ["@types/react", "@types/react-dom"]
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    },
    {
      "patterns": ["eslint*", "prettier"],
      "target": "minor",
      "groupUpdate": true
    }
  ]
}
```

</CodeGroup>

### åŒ…è§„åˆ™å±æ€§

<Properties>
  <Property name="patterns" type="string[]" required>
    åŒ¹é…åŒ…åç§°çš„é€šé…ç¬¦æ¨¡å¼
  </Property>
  <Property name="target" type="enum">
    æ›´æ–°ç›®æ ‡ï¼šlatestã€greatestã€minorã€patchã€newest
  </Property>
  <Property name="requireConfirmation" type="boolean">
    æ›´æ–°è¿™äº›åŒ…å‰æ€»æ˜¯è¯¢é—®
  </Property>
  <Property name="autoUpdate" type="boolean">
    æ— éœ€ç¡®è®¤è‡ªåŠ¨æ›´æ–°
  </Property>
  <Property name="relatedPackages" type="string[]">
    éµå¾ªç›¸åŒæ›´æ–°ç­–ç•¥çš„åŒ…
  </Property>
  <Property name="groupUpdate" type="boolean">
    å°†ç›¸å…³åŒ…ä¸€èµ·æ›´æ–°
  </Property>
</Properties>

## å®‰å…¨é…ç½®

é…ç½®å®‰å…¨æ¼æ´æ‰«æå’Œè‡ªåŠ¨ä¿®å¤ã€‚

```json
{
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true,
    "notifyOnSecurityUpdate": true
  }
}
```

<Properties>
  <Property name="autoFixVulnerabilities" type="boolean">
    è‡ªåŠ¨æ£€æŸ¥å’Œä¿®å¤å®‰å…¨æ¼æ´
  </Property>
  <Property name="allowMajorForSecurity" type="boolean">
    å…è®¸å®‰å…¨ä¿®å¤çš„ä¸»ç‰ˆæœ¬å‡çº§
  </Property>
  <Property name="notifyOnSecurityUpdate" type="boolean">
    å®‰å…¨æ›´æ–°æ—¶æ˜¾ç¤ºé€šçŸ¥
  </Property>
</Properties>

## é«˜çº§è®¾ç½®

ä½¿ç”¨é«˜çº§é…ç½®é€‰é¡¹å¾®è°ƒæ€§èƒ½å’Œè¡Œä¸ºã€‚

```json
{
  "advanced": {
    "concurrency": 5,
    "timeout": 30000,
    "retries": 3,
    "cacheValidityMinutes": 60,
    "checkForUpdates": true
  }
}
```

<Properties>
  <Property name="concurrency" type="number" default="5">
    å¹¶å‘ç½‘ç»œè¯·æ±‚æ•°é‡
  </Property>
  <Property name="timeout" type="number" default="30000">
    ç½‘ç»œè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  </Property>
  <Property name="retries" type="number" default="3">
    å¤±è´¥æ—¶é‡è¯•æ¬¡æ•°
  </Property>
  <Property name="cacheValidityMinutes" type="number" default="60">
    ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆè®¾ä¸º 0 ç¦ç”¨ç¼“å­˜ï¼‰
  </Property>
  <Property name="checkForUpdates" type="boolean" default="true">
    å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥PCUå·¥å…·æ›´æ–°ã€‚åœ¨CIç¯å¢ƒä¸­ä¼šè·³è¿‡æ£€æŸ¥ã€‚æœ‰æ–°ç‰ˆæœ¬æ—¶ä¼šæ˜¾ç¤ºæ›´æ–°é€šçŸ¥å’Œå®‰è£…è¯´æ˜ã€‚
  </Property>
</Properties>

## UI é…ç½®

è‡ªå®šä¹‰è§†è§‰å¤–è§‚å’Œç”¨æˆ·ç•Œé¢è®¾ç½®ã€‚

```json
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "progressBarStyle": "gradient",
    "animations": true
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  }
}
```

### å¯ç”¨ä¸»é¢˜

- `default` - é€šç”¨ä½¿ç”¨çš„å¹³è¡¡é¢œè‰²
- `modern` - å¼€å‘ç¯å¢ƒçš„æ´»æ³¼é¢œè‰²
- `minimal` - ç”Ÿäº§ç¯å¢ƒçš„ç®€æ´é£æ ¼
- `neon` - æ¼”ç¤ºçš„é«˜å¯¹æ¯”åº¦é¢œè‰²

### è¿›åº¦æ¡æ ·å¼

PCU æ”¯æŒ 6 ç§ä¸åŒçš„è¿›åº¦æ¡æ ·å¼ï¼Œä¸ºæ“ä½œæœŸé—´æä¾›å¢å¼ºçš„è§†è§‰åé¦ˆï¼š

- `default` - åŸºæœ¬æ ·å¼çš„æ ‡å‡†è¿›åº¦æ¡
- `gradient` - ç°ä»£å¤–è§‚çš„æ¸å˜è‰²è¿›åº¦æ¡
- `fancy` - å¸¦è£…é¥°å…ƒç´ çš„å¢å¼ºè¿›åº¦æ¡
- `minimal` - ç®€æ´çš„è¿›åº¦æŒ‡ç¤ºå™¨
- `rainbow` - æ´»æ³¼æ˜¾ç¤ºçš„å¤šå½©è¿›åº¦æ¡
- `neon` - åŒ¹é…éœ“è™¹ä¸»é¢˜çš„é«˜å¯¹æ¯”åº¦è¿›åº¦æ¡

**é…ç½®ç¤ºä¾‹ï¼š**

```json
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "progressBarStyle": "gradient"
  }
}
```

**å‘½ä»¤è¡Œä½¿ç”¨ï¼š**

```bash
pcu check --progress-style fancy
pcu update --progress-style rainbow
pcu security --progress-style neon
```

## é…ç½®ä¼˜å…ˆçº§

é…ç½®è®¾ç½®æŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§é¡ºåºåº”ç”¨ï¼š

1. **å‘½ä»¤è¡Œæ ‡å¿—**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. `.pcurc.json` ä¸­çš„**åŒ…ç‰¹å®šè§„åˆ™**
3. `.pcurc.json` ä¸­çš„**å¸¸è§„è®¾ç½®**
4. **é»˜è®¤å€¼**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰

<Note>ç›¸å…³åŒ…è‡ªåŠ¨ç»§æ‰¿å…¶çˆ¶åŒ…è§„åˆ™çš„è®¾ç½®ï¼Œç¡®ä¿ç”Ÿæ€ç³»ç»ŸåŒ…é—´çš„ç‰ˆæœ¬ä¸€è‡´æ€§ã€‚</Note>

## ç¤ºä¾‹

### React ç”Ÿæ€ç³»ç»Ÿ

```json
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": ["@types/react", "@types/react-dom", "react-router-dom"]
    }
  ]
}
```

### TypeScript é¡¹ç›®

```json
{
  "packageRules": [
    {
      "patterns": ["typescript"],
      "target": "minor",
      "requireConfirmation": true
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    }
  ]
}
```

### ä¼ä¸šè®¾ç½®

```json
{
  "defaults": {
    "target": "minor",
    "createBackup": true
  },
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true
  },
  "ui": {
    "theme": "minimal",
    "progressBars": true,
    "progressBarStyle": "minimal"
  },
  "advanced": {
    "concurrency": 3,
    "timeout": 60000
  },
  "exclude": ["typescript", "@types/node", "react", "react-dom"]
}
```

---

## ç¯å¢ƒå˜é‡

æ‰€æœ‰ CLI é€‰é¡¹éƒ½å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼Œä»¥é€‚åº”è‡ªåŠ¨åŒ–å’Œ CI/CD ç¯å¢ƒï¼š

<CodeGroup>

```bash {{ title: 'å…¨å±€ç¯å¢ƒå˜é‡' }}
# å·¥ä½œç©ºé—´è®¾ç½®
export PCU_WORKSPACE="/path/to/workspace"
export PCU_VERBOSE=true
export PCU_NO_COLOR=true

# æ³¨å†Œè¡¨é…ç½®
export PCU_REGISTRY="https://npm.company.com/"
export PCU_TIMEOUT=30000

# é…ç½®æ–‡ä»¶
export PCU_CONFIG="/path/to/.pcurc.json"
```

```bash {{ title: 'å‘½ä»¤ç‰¹å®šå˜é‡' }}
# æ£€æŸ¥/æ›´æ–°è¡Œä¸º
export PCU_OUTPUT_FORMAT=json
export PCU_UPDATE_TARGET=minor
export PCU_CATALOG=default

# æ›´æ–°é€‰é¡¹
export PCU_INTERACTIVE=true
export PCU_DRY_RUN=true
export PCU_CREATE_BACKUP=true
export PCU_FORCE=false

# è¿‡æ»¤
export PCU_INCLUDE="react*,@types/*"
export PCU_EXCLUDE="eslint*"
export PCU_PRERELEASE=false
```

</CodeGroup>

### ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§

é…ç½®æºæŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½ï¼ˆåè€…è¦†ç›–å‰è€…ï¼‰ï¼š

1. **å†…ç½®é»˜è®¤å€¼**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰
2. **å…¨å±€é…ç½®**ï¼ˆ`~/.pcurc.json`ï¼‰
3. **é¡¹ç›®é…ç½®**ï¼ˆ`.pcurc.json`ï¼‰
4. **ç¯å¢ƒå˜é‡**ï¼ˆ`PCU_*`ï¼‰
5. **å‘½ä»¤è¡Œæ ‡å¿—**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰

---

## æ³¨å†Œè¡¨é…ç½®

PCU è‡ªåŠ¨è¯»å– NPM å’Œ PNPM é…ç½®æ–‡ä»¶çš„æ³¨å†Œè¡¨è®¾ç½®ï¼š

<CodeGroup>

```ini {{ title: '.npmrc / .pnpmrc' }}
# é»˜è®¤æ³¨å†Œè¡¨
registry=https://registry.npmjs.org/

# ä½œç”¨åŸŸæ³¨å†Œè¡¨
@mycompany:registry=https://npm.mycompany.com/
@types:registry=https://registry.npmjs.org/

# è®¤è¯ä»¤ç‰Œ
//npm.mycompany.com/:_authToken=${NPM_TOKEN}
//registry.npmjs.org/:_authToken=${NPM_PUBLIC_TOKEN}

# ä¼ ç»Ÿè®¤è¯ï¼ˆå¦‚æœéœ€è¦ï¼‰
//npm.mycompany.com/:username=myuser
//npm.mycompany.com/:_password=base64encodedpassword
//npm.mycompany.com/:email=user@company.com

# SSL å’Œä»£ç†è®¾ç½®
strict-ssl=true
ca=/path/to/ca.pem
proxy=http://proxy.company.com:8080
https-proxy=http://proxy.company.com:8080
```

```json {{ title: 'PCU æ³¨å†Œè¡¨è¦†ç›–' }}
{
  "registry": {
    "default": "https://registry.npmjs.org/",
    "scoped": {
      "@mycompany": "https://npm.mycompany.com/",
      "@types": "https://registry.npmjs.org/"
    },
    "auth": {
      "npm.mycompany.com": {
        "token": "${NPM_TOKEN}",
        "type": "Bearer"
      }
    },
    "timeout": 30000,
    "retries": 3,
    "userAgent": "pcu-custom/1.0.0"
  }
}
```

</CodeGroup>

### æ³¨å†Œè¡¨ä¼˜å…ˆçº§

1. **CLI `--registry` æ ‡å¿—**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. **PCU é…ç½®**ï¼ˆ`.pcurc.json` æ³¨å†Œè¡¨éƒ¨åˆ†ï¼‰
3. **é¡¹ç›® `.npmrc/.pnpmrc`**
4. **å…¨å±€ `.npmrc/.pnpmrc`**
5. **é»˜è®¤ NPM æ³¨å†Œè¡¨**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰

---

## å¢å¼ºç¼“å­˜é…ç½®

PCU åŒ…å«å…ˆè¿›çš„ç¼“å­˜ç³»ç»Ÿä»¥æé«˜æ€§èƒ½ï¼š

<CodeGroup>

```json {{ title: 'ç¼“å­˜é…ç½®' }}
{
  "cache": {
    "enabled": true,
    "ttl": 3600000,
    "maxSize": 52428800,
    "maxEntries": 10000,
    "persistToDisk": true,
    "cacheDir": "~/.pcu/cache",
    "strategy": "lru"
  }
}
```

```bash {{ title: 'ç¼“å­˜ç®¡ç†' }}
# æ¸…é™¤æ‰€æœ‰ç¼“å­˜
rm -rf ~/.pcu/cache

# åœ¨è¯¦ç»†æ¨¡å¼ä¸‹æ˜¾ç¤ºç¼“å­˜ä¿¡æ¯
pcu -c --verbose

# å•æ¬¡è¿è¡Œç¦ç”¨ç¼“å­˜
pcu -c --no-cache

# è®¾ç½®è‡ªå®šä¹‰ç¼“å­˜ç›®å½•
export PCU_CACHE_DIR="/tmp/pcu-cache"
```

</CodeGroup>

### ç¼“å­˜è®¾ç½®

<Properties>
  <Property name="enabled" type="boolean" default="true">
    å¯ç”¨/ç¦ç”¨ç¼“å­˜ç³»ç»Ÿ
  </Property>
  <Property name="ttl" type="number" default="3600000">
    ç”Ÿå­˜æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼ˆé»˜è®¤1å°æ—¶ï¼‰
  </Property>
  <Property name="maxSize" type="number" default="52428800">
    æœ€å¤§ç¼“å­˜å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼ˆé»˜è®¤50MBï¼‰
  </Property>
  <Property name="maxEntries" type="number" default="10000">
    æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
  </Property>
  <Property name="persistToDisk" type="boolean" default="true">
    åœ¨è¿è¡Œä¹‹é—´å°†ç¼“å­˜ä¿å­˜åˆ°ç£ç›˜
  </Property>
  <Property name="cacheDir" type="string" default="~/.pcu/cache">
    æŒä¹…ç¼“å­˜å­˜å‚¨ç›®å½•
  </Property>
  <Property name="strategy" type="enum" default="lru">
    ç¼“å­˜é©±é€ç­–ç•¥ï¼šlruã€fifoã€lfu
  </Property>
</Properties>

---

## éªŒè¯é…ç½®

PCU åŒ…å«å¸¦æœ‰æœ‰ç”¨å»ºè®®çš„å…¨é¢éªŒè¯ï¼š

<CodeGroup>

```json {{ title: 'éªŒè¯é…ç½®' }}
{
  "validation": {
    "strict": true,
    "warnOnRiskyUpdates": true,
    "requireConfirmationFor": ["major"],
    "suggestions": {
      "enabled": true,
      "includePerformanceTips": true,
      "includeBestPractices": true
    }
  }
}
```

```bash {{ title: 'éªŒè¯ç¤ºä¾‹' }}
# å¯ç”¨ä¸¥æ ¼éªŒè¯æ¨¡å¼
pcu -u --force  # å°†æ˜¾ç¤ºç¼ºå°‘å¤‡ä»½çš„è­¦å‘Š

# æ˜¾ç¤ºéªŒè¯å»ºè®®
pcu -c --verbose  # æ˜¾ç¤ºé™„åŠ æç¤ºå’Œå»ºè®®

# éªŒè¯é…ç½®æ–‡ä»¶
node -e "console.log(JSON.parse(require('fs').readFileSync('.pcurc.json')))"
```

</CodeGroup>

### éªŒè¯é€‰é¡¹

<Properties>
  <Property name="strict" type="boolean" default="false">
    å¯ç”¨å¸¦æœ‰é™„åŠ æ£€æŸ¥çš„ä¸¥æ ¼éªŒè¯æ¨¡å¼
  </Property>
  <Property name="warnOnRiskyUpdates" type="boolean" default="true">
    å¯¹æ½œåœ¨é£é™©æ›´æ–°æ˜¾ç¤ºè­¦å‘Š
  </Property>
  <Property name="requireConfirmationFor" type="array" default="[]">
    éœ€è¦ç¡®è®¤çš„æ›´æ–°ç±»å‹ï¼šmajorã€minorã€patch
  </Property>
  <Property name="suggestions.enabled" type="boolean" default="true">
    å¯ç”¨æœ‰ç”¨çš„å»ºè®®å’Œæç¤º
  </Property>
  <Property name="suggestions.includePerformanceTips" type="boolean" default="true">
    åŒ…å«æ€§èƒ½ä¼˜åŒ–å»ºè®®
  </Property>
  <Property name="suggestions.includeBestPractices" type="boolean" default="true">
    åŒ…å«æœ€ä½³å®è·µå»ºè®®
  </Property>
</Properties>

---

## äº¤äº’æ¨¡å¼é…ç½®

é…ç½®äº¤äº’å¼æç¤ºå’Œç”¨æˆ·ä½“éªŒï¼š

<CodeGroup>

```json {{ title: 'äº¤äº’é…ç½®' }}
{
  "interactive": {
    "enabled": true,
    "pageSize": 15,
    "showPackageDescriptions": true,
    "showReleaseNotes": false,
    "autoComplete": {
      "enabled": true,
      "fuzzyMatching": true,
      "maxSuggestions": 10
    },
    "confirmations": {
      "majorUpdates": true,
      "forceUpdates": true,
      "multiplePackages": false
    }
  }
}
```

```bash {{ title: 'äº¤äº’æ¨¡å¼ç¤ºä¾‹' }}
# å¯åŠ¨äº¤äº’æ¨¡å¼
pcu -i

# å¸¦åŒ…æè¿°çš„äº¤äº’æ¨¡å¼
pcu -i --verbose  # åœ¨äº¤äº’é€‰æ‹©ä¸­æ˜¾ç¤ºæ›´å¤šè¯¦ç»†ä¿¡æ¯

# ä½¿ç”¨äº¤äº’ä¸»é¢˜é€‰æ‹©
pcu theme --interactive
```

</CodeGroup>

### äº¤äº’è®¾ç½®

<Properties>
  <Property name="enabled" type="boolean" default="true">
    å¯ç”¨äº¤äº’æ¨¡å¼åŠŸèƒ½
  </Property>
  <Property name="pageSize" type="number" default="15">
    åˆ—è¡¨ä¸­æ¯é¡µæ˜¾ç¤ºçš„é¡¹ç›®æ•°
  </Property>
  <Property name="showPackageDescriptions" type="boolean" default="false">
    åœ¨é€‰æ‹©åˆ—è¡¨ä¸­æ˜¾ç¤ºåŒ…æè¿°
  </Property>
  <Property name="showReleaseNotes" type="boolean" default="false">
    æ˜¾ç¤ºæ›´æ–°çš„å‘å¸ƒè¯´æ˜ï¼ˆéœ€è¦ç½‘ç»œï¼‰
  </Property>
  <Property name="autoComplete.enabled" type="boolean" default="true">
    å¯ç”¨åŒ…åç§°è‡ªåŠ¨å®Œæˆ
  </Property>
  <Property name="autoComplete.fuzzyMatching" type="boolean" default="true">
    å¯ç”¨è‡ªåŠ¨å®Œæˆçš„æ¨¡ç³ŠåŒ¹é…
  </Property>
  <Property name="confirmations.majorUpdates" type="boolean" default="true">
    ä¸»ç‰ˆæœ¬æ›´æ–°éœ€è¦ç¡®è®¤
  </Property>
</Properties>

---

## Monorepo é…ç½®

PCU ä¸ºå¤§å‹ monorepo å’Œå¤æ‚å·¥ä½œç©ºé—´ç®¡ç†æä¾›ä¸“é—¨è®¾è®¡çš„é«˜çº§åŠŸèƒ½ã€‚

### ç‰ˆæœ¬åŒæ­¥

åœ¨æ‚¨çš„ monorepo ä¸­ä¿æŒç›¸å…³åŒ…çš„åŒæ­¥ï¼š

<CodeGroup>

```json {{ title: 'ç‰ˆæœ¬åŒæ­¥é…ç½®' }}
{
  "monorepo": {
    "syncVersions": {
      "enabled": true,
      "groups": [
        {
          "name": "react-ecosystem",
          "packages": ["react", "react-dom", "@types/react", "@types/react-dom"],
          "strategy": "exact" // æˆ– "compatible", "latest"
        },
        {
          "name": "testing-libraries",
          "packages": ["jest", "@testing-library/*", "@types/jest"],
          "strategy": "compatible"
        }
      ]
    },
    "catalogPriority": ["default", "react17", "node18"],
    "crossWorkspaceDependencies": {
      "analyze": true,
      "enforce": "warn" // "error", "warn", "off"
    }
  }
}
```

```json {{ title: 'å¤§å‹å·¥ä½œç©ºé—´ä¼˜åŒ–' }}
{
  "monorepo": {
    "performance": {
      "batchSize": 50,
      "concurrency": 15,
      "cacheWorkspaceStructure": true,
      "parallelCatalogProcessing": true
    },
    "workspacePackages": {
      "autoDiscover": true,
      "includePrivate": false,
      "excludePatterns": ["**/node_modules", "**/dist", "**/coverage"]
    }
  }
}
```

</CodeGroup>

### é«˜çº§å·¥ä½œç©ºé—´ç®¡ç†

#### ç›®å½•ä¼˜å…ˆçº§ç³»ç»Ÿ

å®šä¹‰å†²çªå‡ºç°æ—¶å“ªäº›ç›®å½•ä¼˜å…ˆï¼š

```json
{
  "catalogPriority": ["production", "default", "experimental"],
  "catalogConflictResolution": "priority" // æˆ– "interactive", "error"
}
```

#### è·¨å·¥ä½œç©ºé—´ä¾èµ–

åˆ†æå’Œç®¡ç†å·¥ä½œç©ºé—´åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼š

<Properties>
  <Property name="analyze" type="boolean" default="false">
    åˆ†æè·¨å·¥ä½œç©ºé—´ä¾èµ–å…³ç³»
  </Property>
  <Property name="enforce" type="enum" default="warn">
    å¦‚ä½•å¤„ç†ç‰ˆæœ¬ä¸åŒ¹é…ï¼šerrorã€warnã€off
  </Property>
  <Property name="reportUnused" type="boolean" default="true">
    æŠ¥å‘Šç›®å½•ä¸­æœªè¢«ä»»ä½•å·¥ä½œç©ºé—´åŒ…ä½¿ç”¨çš„åŒ…
  </Property>
  <Property name="validateVersions" type="boolean" default="true">
    éªŒè¯æ‰€æœ‰å·¥ä½œç©ºé—´åŒ…éƒ½ä½¿ç”¨ç›®å½•ç‰ˆæœ¬
  </Property>
</Properties>

### Monorepo ç‰¹å®šåŒ…è§„åˆ™

ä¸ºæ‚¨çš„ monorepo çš„ä¸åŒåŒºåŸŸåˆ›å»ºå¤æ‚çš„è§„åˆ™ï¼š

<CodeGroup>

```json {{ title: 'Monorepo åŒ…è§„åˆ™' }}
{
  "packageRules": [
    {
      "name": "å‰ç«¯åŒ…",
      "patterns": ["react*", "@types/react*", "next*"],
      "workspacePackages": ["apps/web", "apps/admin"],
      "target": "minor",
      "groupUpdate": true,
      "requireConfirmation": true
    },
    {
      "name": "åç«¯ä¾èµ–",
      "patterns": ["express*", "@types/express*", "fastify*"],
      "workspacePackages": ["apps/api", "services/*"],
      "target": "patch",
      "autoUpdate": false
    },
    {
      "name": "å¼€å‘å·¥å…·",
      "patterns": ["eslint*", "prettier", "typescript"],
      "workspacePackages": ["*"], // æ‰€æœ‰åŒ…
      "target": "latest",
      "autoUpdate": true,
      "excludeFromProduction": true
    }
  ]
}
```

</CodeGroup>

### å·¥ä½œç©ºé—´ç‰¹å®šé…ç½®

ä¸ºæ‚¨çš„ monorepo çš„ä¸åŒéƒ¨åˆ†ä½¿ç”¨ä¸åŒçš„é…ç½®ï¼š

<CodeGroup>

```json {{ title: 'æ¯ä¸ªå·¥ä½œç©ºé—´è§„åˆ™' }}
{
  "workspaceRules": {
    "apps/web": {
      "defaults": {
        "target": "minor",
        "createBackup": true
      },
      "packageRules": [
        {
          "patterns": ["react*"],
          "target": "patch"
        }
      ]
    },
    "packages/*": {
      "defaults": {
        "target": "latest",
        "requireConfirmation": false
      }
    },
    "tools/*": {
      "defaults": {
        "target": "latest",
        "autoUpdate": true
      }
    }
  }
}
```

</CodeGroup>

### å¤§å‹ Monorepo çš„æ€§èƒ½ä¼˜åŒ–

#### æ‰¹å¤„ç†é…ç½®

<Properties>
  <Property name="batchSize" type="number" default="20">
    æ¯æ‰¹å¤„ç†çš„åŒ…æ•°é‡
  </Property>
  <Property name="concurrency" type="number" default="5">
    æœ€å¤§å¹¶å‘æ“ä½œæ•°
  </Property>
  <Property name="cacheWorkspaceStructure" type="boolean" default="true">
    åœ¨è¿è¡Œä¹‹é—´ç¼“å­˜å·¥ä½œç©ºé—´åŒ…å‘ç°
  </Property>
  <Property name="parallelCatalogProcessing" type="boolean" default="true">
    å¹¶è¡Œå¤„ç†å¤šä¸ªç›®å½•
  </Property>
</Properties>

#### å†…å­˜ç®¡ç†

```json
{
  "monorepo": {
    "memoryOptimization": {
      "streamingMode": true, // å¤„ç†åŒ…è€Œä¸å°†æ‰€æœ‰åŒ…åŠ è½½åˆ°å†…å­˜
      "maxMemoryUsage": "2GB", // å¤§å‹å·¥ä½œç©ºé—´çš„å†…å­˜é™åˆ¶
      "temporaryFileCleanup": "immediate" // "immediate", "session-end", "manual"
    }
  }
}
```

### Monorepo éªŒè¯

å¤æ‚å·¥ä½œç©ºé—´è®¾ç½®çš„å…¨é¢éªŒè¯ï¼š

#### éªŒè¯è§„åˆ™

<Properties>
  <Property name="enforceWorkspaceProtocol" type="boolean" default="true">
    ç¡®ä¿å†…éƒ¨ä¾èµ–ä½¿ç”¨ workspace: åè®®
  </Property>
  <Property name="validateCatalogCoverage" type="boolean" default="true">
    ç¡®ä¿æ‰€æœ‰ä¾èµ–éƒ½è¢«ç›®å½•è¦†ç›–
  </Property>
  <Property name="requireConsistentVersions" type="boolean" default="false">
    è¦æ±‚æ‰€æœ‰å·¥ä½œç©ºé—´åŒ…å¯¹å…±äº«ä¾èµ–ä½¿ç”¨ç›¸åŒç‰ˆæœ¬
  </Property>
  <Property name="detectCircularDependencies" type="boolean" default="true">
    æ£€æµ‹å·¥ä½œç©ºé—´åŒ…ä¹‹é—´çš„å¾ªç¯ä¾èµ–
  </Property>
</Properties>

### Monorepo ä½¿ç”¨ç¤ºä¾‹

#### å¤§å‹ä¼ä¸š Monorepo è®¾ç½®

```json
{
  "monorepo": {
    "syncVersions": {
      "enabled": true,
      "groups": [
        {
          "name": "core-frontend",
          "packages": ["react", "react-dom", "react-router", "@types/react*"],
          "strategy": "exact"
        },
        {
          "name": "ui-libraries",
          "packages": ["@company/design-system", "@company/components"],
          "strategy": "workspace"
        }
      ]
    },
    "performance": {
      "batchSize": 100,
      "concurrency": 20,
      "streamingMode": true
    },
    "workspaceRules": {
      "apps/*": { "target": "minor", "requireConfirmation": true },
      "packages/*": { "target": "latest", "autoUpdate": true },
      "tools/*": { "target": "latest", "autoUpdate": true }
    }
  }
}
```

#### CI/CD ä¼˜åŒ–é…ç½®

```json
{
  "monorepo": {
    "ci": {
      "parallelCatalogProcessing": true,
      "skipInteractivePrompts": true,
      "generateReport": true,
      "reportFormat": "json",
      "exitOnError": true
    },
    "validation": {
      "enforceWorkspaceProtocol": true,
      "validateCatalogCoverage": true,
      "failOnInconsistentVersions": true
    }
  }
}
```
