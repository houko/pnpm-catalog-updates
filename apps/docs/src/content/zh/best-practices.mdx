export const metadata = {
  title: 'æœ€ä½³å®è·µ',
  description: 'åœ¨å›¢é˜Ÿç¯å¢ƒå’Œä¼ä¸šå·¥ä½œæµä¸­æœ‰æ•ˆä½¿ç”¨ PCU çš„æœ€ä½³å®è·µã€‚',
};

# æœ€ä½³å®è·µ

å­¦ä¹ å¦‚ä½•åœ¨å›¢é˜Ÿç¯å¢ƒã€ä¼ä¸šå·¥ä½œæµå’Œç”Ÿäº§ç³»ç»Ÿä¸­æœ‰æ•ˆä½¿ç”¨ PCUã€‚ {{ className: 'lead' }}

## å›¢é˜Ÿåä½œ

### å…±äº«é…ç½®

é€šè¿‡å°† `.pcurc.json` æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶æ¥ä¿æŒå›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„ PCU é…ç½®ä¸€è‡´æ€§ï¼š

```json
{
  "target": "minor",
  "concurrency": 3,
  "timeout": 60000,
  "packageRules": [
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    },
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true
    }
  ],
  "exclude": ["legacy-*", "deprecated-*"]
}
```

### ä»£ç å®¡æŸ¥æŒ‡å—

**å®¡æŸ¥å‰æ£€æŸ¥æ¸…å•ï¼š**

1. è¿è¡Œ `pcu check --dry-run` é¢„è§ˆæ›´æ”¹
2. éªŒè¯ä¸»ç‰ˆæœ¬æ›´æ–°ä¸­æ²¡æœ‰ç ´åæ€§å˜æ›´
3. ä¾èµ–æ›´æ–°åæµ‹è¯•å…³é”®åŠŸèƒ½
4. å®¡æŸ¥æ›´æ–°åŒ…çš„ CHANGELOG æ–‡ä»¶

**å®¡æŸ¥æµç¨‹ï¼š**

1. **å®‰å…¨ä¼˜å…ˆ**ï¼šå§‹ç»ˆç«‹å³å®¡æŸ¥å®‰å…¨ç›¸å…³çš„ä¾èµ–æ›´æ–°
2. **æ‰¹é‡ç›¸å…³æ›´æ–°**ï¼šåœ¨å•ä¸ª PR ä¸­ç»„åˆç›¸å…³åŒ…ï¼ˆå¦‚ React ç”Ÿæ€ç³»ç»Ÿï¼‰
3. **è®°å½•åŸå› **ï¼šåŒ…å«ç‰ˆæœ¬é”å®šæˆ–æ’é™¤çš„ç†ç”±
4. **æµ‹è¯•è¦†ç›–**ï¼šåœ¨åˆå¹¶ä¾èµ–æ›´æ–°å‰ç¡®ä¿å……åˆ†æµ‹è¯•

### é€šä¿¡æ ‡å‡†

æ›´æ–°ä¾èµ–æ—¶ä½¿ç”¨æ¸…æ™°çš„æäº¤ä¿¡æ¯ï¼š

```bash
# è‰¯å¥½çš„æäº¤ä¿¡æ¯
feat(deps): æ›´æ–° React åˆ° v18.3.0 æå‡æ€§èƒ½
security(deps): ä¿®è¡¥ lodash æ¼æ´ CVE-2021-23337
chore(deps): æ›´æ–°å¼€å‘ä¾èµ–åˆ°æœ€æ–°ç‰ˆæœ¬

# ä¸å¥½çš„æäº¤ä¿¡æ¯
update packages
fix deps
bump versions
```

## ä¼ä¸šçº§ä½¿ç”¨

### æ²»ç†å’Œåˆè§„

**ä¾èµ–æ‰¹å‡†æµç¨‹ï¼š**

1. **å®‰å…¨æ‰«æ**ï¼šæ‰€æœ‰æ›´æ–°å¿…é¡»é€šè¿‡å®‰å…¨å®¡æ ¸
2. **è®¸å¯è¯åˆè§„**ï¼šéªŒè¯è®¸å¯è¯ä¸å†…éƒ¨æ”¿ç­–çš„å…¼å®¹æ€§
3. **ç¨³å®šæ€§è¦æ±‚**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¼˜å…ˆé€‰æ‹© LTS ç‰ˆæœ¬
4. **å˜æ›´ç®¡ç†**ï¼šéµå¾ªæ—¢å®šçš„å˜æ›´æ‰¹å‡†æµç¨‹

**ä¼ä¸šçº§é…ç½®ï¼š**

```json
{
  "target": "minor",
  "requireConfirmation": true,
  "security": {
    "autoFix": false,
    "severityThreshold": "moderate",
    "ignoredVulnerabilities": [],
    "customAuditConfig": {
      "low": "warn",
      "moderate": "error",
      "high": "error",
      "critical": "error"
    }
  },
  "packageRules": [
    {
      "patterns": ["*"],
      "exclude": false,
      "requireApproval": true,
      "maxMajorUpdates": 0
    }
  ]
}
```

### ç§æœ‰ä»“åº“é›†æˆ

ä¸ºä½¿ç”¨ç§æœ‰ä»“åº“çš„ä¼ä¸šç¯å¢ƒé…ç½® PCUï¼š

```ini
# .npmrc (å·¥ä½œåŒºæ ¹ç›®å½•)
@company:registry=https://npm.company.com/
//npm.company.com/:_authToken=${NPM_TOKEN}
registry=https://npm.company.com/

# å…¬å…±åŒ…å›é€€
@types:registry=https://registry.npmjs.org/
```

**ç¯å¢ƒå˜é‡ï¼š**

```bash
export NPM_TOKEN=your_company_token
export PCU_CACHE_ENABLED=true
export PCU_TIMEOUT=120000
export PCU_CONCURRENCY=2
```

### å®¡è®¡è·Ÿè¸ªå’ŒæŠ¥å‘Š

ç»´æŠ¤ä¾èµ–å˜æ›´çš„å…¨é¢è®°å½•ï¼š

```bash
# ç”Ÿæˆä¾èµ–æŠ¥å‘Š
pcu check --format json > dependency-report.json
pcu security --format json > security-report.json

# åŒ…å«åœ¨ CI/CD æµæ°´çº¿ä¸­
- name: ç”Ÿæˆä¾èµ–æŠ¥å‘Š
  run: |
    pcu check --format json > artifacts/deps-$(date +%Y%m%d).json
    pcu security --format json > artifacts/security-$(date +%Y%m%d).json
```

## å‘å¸ƒå·¥ä½œæµ

### è¯­ä¹‰ç‰ˆæœ¬é›†æˆ

ä½¿ä¾èµ–æ›´æ–°ä¸å‘å¸ƒå‘¨æœŸä¿æŒä¸€è‡´ï¼š

**é¢„å‘å¸ƒé˜¶æ®µï¼š**

```bash
# æ£€æŸ¥æ›´æ–°ä½†ä¸åº”ç”¨
pcu check --target patch --dry-run

# å†»ç»“æœŸé—´ä»…æ›´æ–°è¡¥ä¸ç‰ˆæœ¬
pcu update --target patch --exclude "major-framework-*"
```

**å‘å¸ƒå‡†å¤‡ï¼š**

```bash
# æ›´æ–°åˆ°æœ€æ–°ç¨³å®šç‰ˆæœ¬
pcu update --target minor --exclude "experimental-*"

# ç”ŸæˆåŒ…å«ä¾èµ–å˜æ›´çš„å‘å¸ƒè¯´æ˜
pcu analyze default react 18.3.0 >> RELEASE_NOTES.md
```

**å‘å¸ƒåï¼š**

```bash
# æ›´æ–°åˆ°åŒ…æ‹¬ä¸»ç‰ˆæœ¬çš„æœ€æ–°ç‰ˆæœ¬
pcu update --target latest --interactive
```

### é¢„å‘å¸ƒç¯å¢ƒæµ‹è¯•

**ç”Ÿäº§å‰éªŒè¯ï¼š**

<CodeGroup>

```bash {{ title: 'é¢„å‘å¸ƒæµæ°´çº¿' }}
# åœ¨é¢„å‘å¸ƒç¯å¢ƒæ›´æ–°ä¾èµ–
pcu update --target minor --create-backup

# è¿è¡Œå…¨é¢æµ‹è¯•
npm run test:integration
npm run test:e2e
npm run test:performance

# å¦‚æœå‘ç°é—®é¢˜åˆ™å›æ»š
pcu restore-backup
```

```yaml {{ title: 'GitHub Actions' }}
name: ä¾èµ–æµ‹è¯•
on:
  schedule:
    - cron: '0 2 * * 1' # æ¯å‘¨ä¸€å‡Œæ™¨2ç‚¹

jobs:
  dependency-updates:
    runs-on: ubuntu-latest
    steps:
      - name: æ›´æ–°ä¾èµ–
        run: pcu update --target minor --dry-run

      - name: æµ‹è¯•æ›´æ–°çš„ä¾èµ–
        run: |
          npm ci
          npm run test:all
          npm run build
```

</CodeGroup>

## å®‰å…¨æœ€ä½³å®è·µ

### æ¼æ´ç®¡ç†

**å³æ—¶å“åº”PCUï¼š**

1. **ä¸¥é‡/é«˜ä¸¥é‡æ€§**ï¼š24å°æ—¶å†…æ›´æ–°
2. **ä¸­ç­‰ä¸¥é‡æ€§**ï¼š1å‘¨å†…æ›´æ–°
3. **ä½ä¸¥é‡æ€§**ï¼šåŒ…å«åœ¨ä¸‹æ¬¡å®šæœŸæ›´æ–°å‘¨æœŸä¸­

```bash
# ä¼˜å…ˆå¤„ç†å®‰å…¨ä¿®å¤
pcu security --severity critical --auto-fix
pcu security --severity high --fix-vulns --require-confirmation

# å®šæœŸå®‰å…¨å®¡æ ¸
pcu security --format json --output security-audit.json
```

### ä¾èµ–éªŒè¯

**å®‰å…¨é…ç½®ï¼š**

```json
{
  "security": {
    "enableSnyk": true,
    "autoFix": false,
    "allowedLicenses": ["MIT", "Apache-2.0", "BSD-3-Clause"],
    "blockedPackages": ["colors", "faker"],
    "trustedSources": ["@company/*", "@types/*"],
    "customAuditConfig": {
      "skipLevels": [],
      "excludeDevDependencies": false
    }
  }
}
```

**æ‰‹åŠ¨å®‰å…¨å®¡æŸ¥ï¼š**

- é¦–æ¬¡ä½¿ç”¨å‰å®¡æŸ¥æ‰€æœ‰æ–°ä¾èµ–
- å®¡æ ¸åŒ…ç»´æŠ¤è€…å’Œä¸‹è½½é‡
- éªŒè¯åŒ…çš„çœŸå®æ€§å’Œç­¾å
- æ£€æŸ¥ä¾èµ–é“¾ä¸­çš„å·²çŸ¥å®‰å…¨é—®é¢˜

### è®¿é—®æ§åˆ¶

**ä»¤ç‰Œç®¡ç†ï¼š**

```bash
# ä½¿ç”¨å…·æœ‰æœ€å°æƒé™çš„èŒƒå›´ä»¤ç‰Œ
NPM_TOKEN=npm_[REDACTED]_readonly_access_only

# å®šæœŸè½®æ¢ä»¤ç‰Œï¼ˆå­£åº¦ï¼‰
# åœ¨å®‰å…¨å‡­è¯ç®¡ç†ç³»ç»Ÿä¸­å­˜å‚¨ä»¤ç‰Œ
# ç»ä¸å°†ä»¤ç‰Œæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
```

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

**æœ¬åœ°å¼€å‘ï¼š**

```bash
# å¯ç”¨æŒä¹…ç¼“å­˜
export PCU_CACHE_ENABLED=true
export PCU_CACHE_TTL=3600  # 1å°æ—¶
export PCU_CACHE_MAX_SIZE=100  # 100 MB
```

**CI/CD ä¼˜åŒ–ï¼š**

```yaml
- name: ç¼“å­˜ PCU æ•°æ®
  uses: actions/cache@v3
  with:
    path: ~/.pcu-cache
    key: pcu-cache-${{ runner.os }}-${{ hashFiles('pnpm-workspace.yaml') }}

- name: ä¼˜åŒ–çš„ PCU è¿è¡Œ
  run: |
    export PCU_CACHE_ENABLED=true
    pcu check --concurrency 5 --timeout 30000
```

### å¤§å‹å•ä½“ä»“åº“å¤„ç†

**100+ åŒ…çš„é…ç½®ï¼š**

```json
{
  "concurrency": 2,
  "timeout": 120000,
  "batchSize": 10,
  "advanced": {
    "memoryOptimization": true,
    "parallelCatalogs": false,
    "incrementalUpdates": true
  }
}
```

**é€‰æ‹©æ€§å¤„ç†ï¼š**

```bash
# æŒ‰ç±»åˆ«å¤„ç†
pcu check --include "@company/ui-*" --limit 20
pcu check --include "@company/api-*" --limit 20
pcu check --include "@types/*" --target latest

# å¤§å‹æ“ä½œä½¿ç”¨è¿‡æ»¤
pcu update --include "react*" --exclude "*-experimental"
```

### ç½‘ç»œä¼˜åŒ–

**ä»“åº“é…ç½®ï¼š**

```bash
# ä½¿ç”¨åœ°ç†ä½ç½®æ¥è¿‘çš„æ›´å¿«ä»“åº“
export PCU_REGISTRY=https://registry-asia.npmjs.org/
export PCU_TIMEOUT=60000
export PCU_MAX_RETRIES=3
```

## é”™è¯¯å¤„ç†å’Œæ¢å¤

### å¸¸è§é”™è¯¯è§£å†³

**ç½‘ç»œé—®é¢˜ï¼š**

```bash
# ä¸ºæ…¢è¿æ¥å¢åŠ è¶…æ—¶
PCU_TIMEOUT=120000 pcu check

# ä½¿ç”¨å¤‡ç”¨ä»“åº“
PCU_REGISTRY=https://registry.npmjs.org/ pcu check

# ä¸ºç½‘ç»œé—®é¢˜å¯ç”¨è°ƒè¯•
DEBUG=pcu:network pcu check
```

**å†…å­˜é—®é¢˜ï¼š**

```bash
# å¢åŠ  Node.js å†…å­˜é™åˆ¶
NODE_OPTIONS="--max-old-space-size=8192" pcu check

# ä¸ºå†…å­˜å—é™ç¯å¢ƒå‡å°‘å¹¶å‘
pcu check --concurrency 1
```

### å¤‡ä»½å’Œæ¢å¤

**ä¸»è¦æ›´æ–°å‰åˆ›å»ºå¤‡ä»½ï¼š**

```bash
# è‡ªåŠ¨å¤‡ä»½åˆ›å»º
pcu update --create-backup --target minor

# æ‰‹åŠ¨å¤‡ä»½
cp pnpm-workspace.yaml pnpm-workspace.yaml.backup
cp -r packages/*/package.json backups/

# ä»å¤‡ä»½æ¢å¤
pcu restore-backup --timestamp 2024-01-15T10:30:00Z
```

**ç‰ˆæœ¬å›æ»šç­–ç•¥ï¼š**

```bash
# å›æ»šç‰¹å®šåŒ…
pcu rollback react 18.2.0
pcu rollback @types/node 20.5.0

# å›æ»šæ•´ä¸ªç›®å½•
git checkout HEAD~1 pnpm-workspace.yaml
pnpm install
```

### ç›‘æ§å’Œå‘Šè­¦

**CI/CD é›†æˆï¼š**

```yaml
- name: ä¾èµ–å¥åº·æ£€æŸ¥
  run: |
    set -e
    pcu check --format json > check-results.json

    # è§£æç»“æœå¹¶è®¾ç½®å‘Šè­¦
    if grep -q "critical" check-results.json; then
      echo "::error::å‘ç°ä¸¥é‡ä¾èµ–é—®é¢˜"
      exit 1
    fi

- name: å®‰å…¨ç›‘æ§
  run: |
    pcu security --format json > security-results.json

    # é«˜/ä¸¥é‡æ¼æ´å‘Šè­¦
    CRITICAL_COUNT=$(jq '.vulnerabilities.critical // 0' security-results.json)
    if [ "$CRITICAL_COUNT" -gt 0 ]; then
      # å‘é€å‘Šè­¦åˆ°ç›‘æ§ç³»ç»Ÿ
      curl -X POST "$SLACK_WEBHOOK" -d '{"text":"ğŸš¨ å‘ç°ä¸¥é‡å®‰å…¨æ¼æ´"}'
    fi
```

## é›†æˆæ¨¡å¼

### IDE å’Œç¼–è¾‘å™¨é›†æˆ

**VS Code é…ç½®ï¼š**

```json
{
  "terminal.integrated.env.linux": {
    "PCU_CACHE_ENABLED": "true"
  },
  "tasks.json": {
    "version": "2.0.0",
    "tasks": [
      {
        "label": "PCU æ£€æŸ¥",
        "type": "shell",
        "command": "pcu check --interactive",
        "group": "build",
        "presentation": {
          "echo": true,
          "reveal": "always",
          "focus": false,
          "panel": "shared"
        }
      }
    ]
  }
}
```

### è‡ªåŠ¨åŒ–è„šæœ¬

**Package.json è„šæœ¬ï¼š**

```json
{
  "scripts": {
    "deps:check": "pcu check",
    "deps:update:patch": "pcu update --target patch",
    "deps:update:minor": "pcu update --target minor --interactive",
    "deps:security": "pcu security --fix-vulns",
    "deps:analyze": "pcu analyze default",
    "prerelease": "npm run deps:check && npm run deps:security"
  }
}
```

**Git é’©å­é›†æˆï¼š**

```bash
#!/bin/sh
# .git/hooks/pre-commit

# æäº¤å‰æ£€æŸ¥ä¾èµ–é—®é¢˜
if command -v pcu &> /dev/null; then
  pcu check --format json > /dev/null || {
    echo "âš ï¸  æ£€æµ‹åˆ°ä¾èµ–é—®é¢˜ã€‚è¿è¡Œ 'pcu check' æŸ¥çœ‹è¯¦æƒ…ã€‚"
    exit 1
  }
fi
```

---

## å¿«é€Ÿå‚è€ƒæ£€æŸ¥æ¸…å•

### æ—¥å¸¸å·¥ä½œæµ

1. æ£€æŸ¥å®‰å…¨æ›´æ–°ï¼š`pcu security`
2. å®¡æŸ¥è¿‡æ—¶ä¾èµ–ï¼š`pcu check --limit 10`
3. æ›´æ–°è¡¥ä¸ç‰ˆæœ¬ï¼š`pcu update --target patch`

### æ¯å‘¨å·¥ä½œæµ

1. å…¨é¢ä¾èµ–æ£€æŸ¥ï¼š`pcu check`
2. æ›´æ–°å°ç‰ˆæœ¬ï¼š`pcu update --target minor --interactive`
3. å®¡æŸ¥å’Œæ›´æ–°æ’é™¤è§„åˆ™
4. ä¸ºå›¢é˜Ÿå®¡æŸ¥ç”Ÿæˆä¾èµ–æŠ¥å‘Š

### æ¯æœˆå·¥ä½œæµ

1. å®¡æŸ¥ä¸»ç‰ˆæœ¬æ›´æ–°ï¼š`pcu check --target latest`
2. æ›´æ–°å¼€å‘ä¾èµ–ï¼š`pcu update --dev`
3. å®¡æ ¸ä¾èµ–è®¸å¯è¯å’Œåˆè§„æ€§
4. å®¡æŸ¥å’Œä¼˜åŒ– PCU é…ç½®
5. æ¸…ç†æœªä½¿ç”¨çš„ä¾èµ–

### å‘å¸ƒå‰

1. è¿è¡Œå®Œæ•´ä¾èµ–å®¡æ ¸ï¼š`pcu security --comprehensive`
2. åˆ›å»ºå¤‡ä»½ï¼š`pcu update --create-backup`
3. åœ¨é¢„å‘å¸ƒç¯å¢ƒæµ‹è¯•
4. ç”ŸæˆåŒ…å«ä¾èµ–å˜æ›´çš„å‘å¸ƒè¯´æ˜
