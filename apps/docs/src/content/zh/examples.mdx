export const metadata = {
  title: 'ç¤ºä¾‹',
  description: 'pnpm-catalog-updates çš„çœŸå®ä¸–ç•Œç¤ºä¾‹å’Œç”¨ä¾‹ã€‚ä»å®é™…åœºæ™¯å’Œå¸¸è§å·¥ä½œæµä¸­å­¦ä¹ ã€‚',
};

# ç¤ºä¾‹

çœŸå®ä¸–ç•Œçš„ç¤ºä¾‹å’Œç”¨ä¾‹ï¼Œå¸®åŠ©æ‚¨å……åˆ†åˆ©ç”¨ PCUã€‚ä»ç®€å•æ›´æ–°åˆ°å¤æ‚çš„ monorepo ç®¡ç†ã€‚{{ className: 'lead' }}

## åˆå­¦è€…å®Œå…¨æŒ‡å—

### ç¬¬ä¸€æ­¥ï¼šäº†è§£æ‚¨çš„é¡¹ç›®è®¾ç½®

åœ¨å¼€å§‹ä½¿ç”¨PCUä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç¡®è®¤æ‚¨çš„é¡¹ç›®ç»“æ„ï¼š

<CodeGroup>

```bash {{ title: 'æ£€æŸ¥é¡¹ç›®ç»“æ„' }}
# ç¡®è®¤æ‚¨æœ‰pnpmå·¥ä½œç©ºé—´
ls -la | grep -E "(pnpm-workspace|pnpm-lock)"

# åº”è¯¥çœ‹åˆ°ï¼š
# pnpm-workspace.yaml
# pnpm-lock.yaml
```

```bash {{ title: 'æŸ¥çœ‹å·¥ä½œç©ºé—´é…ç½®' }}
# æŸ¥çœ‹æ‚¨çš„å·¥ä½œç©ºé—´è®¾ç½®
cat pnpm-workspace.yaml

# å…¸å‹è¾“å‡ºï¼š
# packages:
#   - "apps/*"
#   - "packages/*"
```

</CodeGroup>

å¦‚æœæ‚¨è¿˜æ²¡æœ‰pnpmå·¥ä½œç©ºé—´ï¼ŒPCUå¯ä»¥å¸®æ‚¨åˆ›å»ºï¼š

```bash
# åˆå§‹åŒ–å®Œæ•´çš„pnpmå·¥ä½œç©ºé—´å’ŒPCUé…ç½®
pcu init

# PCUä¼šåˆ›å»ºï¼š
# âœ… pnpm-workspace.yamlï¼ˆå·¥ä½œç©ºé—´é…ç½®ï¼‰
# âœ… .pcurc.jsonï¼ˆPCUé…ç½®æ–‡ä»¶ï¼‰
# âœ… packages/ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
```

### ç¬¬äºŒæ­¥ï¼šæ‚¨çš„ç¬¬ä¸€æ¬¡ä¾èµ–æ£€æŸ¥

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æ‚¨çš„é¡¹ç›®æœ‰å“ªäº›å¯ä»¥æ›´æ–°çš„ä¾èµ–ï¼š

<CodeGroup>

```bash {{ title: 'ç®€å•æ£€æŸ¥' }}
# æœ€ç®€å•çš„æ£€æŸ¥å‘½ä»¤
pcu check

# æ‚¨ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¡¨æ ¼ï¼š
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Package         â”‚ Current â”‚ Available â”‚ Type       â”‚ Security â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ react           â”‚ 18.2.0  â”‚ 18.3.1  â”‚ minor     â”‚ âœ…       â”‚
# â”‚ typescript      â”‚ 5.0.4   â”‚ 5.2.2   â”‚ minor     â”‚ âœ…       â”‚
# â”‚ @types/node     â”‚ 18.15.13â”‚ 20.8.4  â”‚ major     â”‚ âœ…       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```bash {{ title: 'ç†è§£è¾“å‡º' }}
# è®©æˆ‘ä»¬ç†è§£è¡¨æ ¼ä¸­çš„ä¿¡æ¯ï¼š

# Packageï¼šåŒ…åç§°
# Currentï¼šå½“å‰å®‰è£…çš„ç‰ˆæœ¬
# Availableï¼šå¯ç”¨çš„æ–°ç‰ˆæœ¬
# Typeï¼šæ›´æ–°ç±»å‹
#   - patchï¼šé”™è¯¯ä¿®å¤ï¼ˆ1.0.1 â†’ 1.0.2ï¼‰
#   - minorï¼šæ–°åŠŸèƒ½ï¼Œæ— ç ´åæ€§å˜æ›´ï¼ˆ1.0.0 â†’ 1.1.0ï¼‰
#   - majorï¼šå¯èƒ½åŒ…å«ç ´åæ€§å˜æ›´ï¼ˆ1.0.0 â†’ 2.0.0ï¼‰
# Securityï¼šæ˜¯å¦æœ‰å®‰å…¨é—®é¢˜ âš ï¸ = æœ‰å®‰å…¨é—®é¢˜ï¼Œâœ… = å®‰å…¨
```

</CodeGroup>

### ç¬¬ä¸‰æ­¥ï¼šæ‚¨çš„ç¬¬ä¸€æ¬¡å®‰å…¨æ›´æ–°

å®‰å…¨æ°¸è¿œæ˜¯ç¬¬ä¸€ä½çš„ã€‚è®©æˆ‘ä»¬å…ˆå¤„ç†ä»»ä½•å®‰å…¨é—®é¢˜ï¼š

<CodeGroup>

```bash {{ title: 'æ£€æŸ¥å®‰å…¨é—®é¢˜' }}
# ä¸“é—¨æ£€æŸ¥å®‰å…¨æ¼æ´
pcu security

# å¦‚æœæœ‰æ¼æ´ï¼Œæ‚¨ä¼šçœ‹åˆ°ï¼š
# ğŸš¨ å‘ç° 3 ä¸ªå®‰å…¨æ¼æ´
#
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Package     â”‚ Severityâ”‚ Current  â”‚ Patched     â”‚ Vulnerabilityâ”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ lodash      â”‚ High    â”‚ 4.17.20  â”‚ 4.17.21     â”‚ CVE-2021-23337â”‚
# â”‚ node-fetch  â”‚ Moderateâ”‚ 2.6.1    â”‚ 2.6.7       â”‚ CVE-2022-0235â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```bash {{ title: 'è‡ªåŠ¨ä¿®å¤å®‰å…¨é—®é¢˜' }}
# è®©PCUè‡ªåŠ¨ä¿®å¤å®‰å…¨æ¼æ´
pcu security --fix-vulns

# PCUä¼šï¼š
# 1. æ‰«ææ‰€æœ‰ä¾èµ–çš„å®‰å…¨æ¼æ´
# 2. è‡ªåŠ¨æ›´æ–°åˆ°ä¿®å¤ç‰ˆæœ¬
# 3. è¿è¡Œå®‰å…¨éªŒè¯
# âœ… ä¿®å¤äº† 3 ä¸ªå®‰å…¨æ¼æ´
# âœ… æ— å…¶ä»–å®‰å…¨é—®é¢˜
```

</CodeGroup>

### ç¬¬å››æ­¥ï¼šæ‚¨çš„ç¬¬ä¸€æ¬¡ä¾èµ–æ›´æ–°

ç°åœ¨è®©æˆ‘ä»¬å®‰å…¨åœ°æ›´æ–°ä¸€äº›ä¾èµ–ã€‚æˆ‘ä»¬ä»ä¿å®ˆçš„æ–¹å¼å¼€å§‹ï¼š

<CodeGroup>

```bash {{ title: 'äº¤äº’å¼æ›´æ–°ï¼ˆæ¨èç»™æ–°æ‰‹ï¼‰' }}
# äº¤äº’å¼æ›´æ–° - æ‚¨å¯ä»¥é€‰æ‹©è¦æ›´æ–°å“ªäº›åŒ…
pcu update --interactive

# PCUä¼šæ˜¾ç¤ºä¸€ä¸ªé€‰æ‹©èœå•ï¼š
# ? é€‰æ‹©è¦æ›´æ–°çš„åŒ…ï¼š
# â—¯ react (18.2.0 â†’ 18.3.1) [minor]
# â—‰ typescript (5.0.4 â†’ 5.2.2) [minor]
# â—¯ @types/node (18.15.13 â†’ 20.8.4) [major] âš ï¸
# â—¯ eslint (8.42.0 â†’ 8.50.0) [minor]
#
# ä½¿ç”¨æ–¹å‘é”®ç§»åŠ¨ï¼Œç©ºæ ¼é€‰æ‹©ï¼Œå›è½¦ç¡®è®¤
```

```bash {{ title: 'è‡ªåŠ¨åˆ›å»ºå¤‡ä»½' }}
# è®©PCUåœ¨æ›´æ–°å‰åˆ›å»ºå¤‡ä»½
pcu update --interactive --create-backup

# PCUä¼šï¼š
# 1. åœ¨æ›´æ–°å‰åˆ›å»º pnpm-workspace.yaml.backup
# 2. è®©æ‚¨é€‰æ‹©è¦æ›´æ–°çš„åŒ…
# 3. åº”ç”¨æ›´æ–°
# 4. éªŒè¯æ›´æ–°æˆåŠŸ

# å¦‚æœå‡ºç°é—®é¢˜ï¼Œæ‚¨å¯ä»¥æ¢å¤ï¼š
# cp pnpm-workspace.yaml.backup pnpm-workspace.yaml
```

</CodeGroup>

### ç¬¬äº”æ­¥ï¼šéªŒè¯æ›´æ–°ç»“æœ

æ›´æ–°åï¼Œè®©æˆ‘ä»¬ç¡®è®¤ä¸€åˆ‡æ­£å¸¸ï¼š

<CodeGroup>

```bash {{ title: 'éªŒè¯å·¥ä½œç©ºé—´' }}
# æ£€æŸ¥å·¥ä½œç©ºé—´çŠ¶æ€
pcu workspace --validate

# è¾“å‡ºåº”è¯¥æ˜¾ç¤ºï¼š
# âœ… å·¥ä½œç©ºé—´é…ç½®æœ‰æ•ˆ
# âœ… æ‰€æœ‰åŒ…éƒ½å­˜åœ¨äºæ³¨å†Œè¡¨ä¸­
# âœ… ç‰ˆæœ¬çº¦æŸä¸€è‡´
# âœ… æ— å¾ªç¯ä¾èµ–
```

```bash {{ title: 'é‡æ–°æ£€æŸ¥ä¾èµ–' }}
# ç¡®è®¤æ›´æ–°å·²åº”ç”¨
pcu check

# æ‚¨åº”è¯¥çœ‹åˆ°æ›´å°‘çš„å¯æ›´æ–°åŒ…
# æˆ–è€…çœ‹åˆ° "âœ… æ‰€æœ‰ä¾èµ–éƒ½æ˜¯æœ€æ–°çš„"
```

</CodeGroup>

### å¸¸è§æ–°æ‰‹é”™è¯¯åŠé¿å…æ–¹æ³•

#### é”™è¯¯ 1ï¼šå¿˜è®°å¤‡ä»½å°±æ›´æ–°

**âŒ é”™è¯¯åšæ³•ï¼š**

```bash
pcu update --target latest  # å±é™©ï¼æ²¡æœ‰å¤‡ä»½
```

**âœ… æ­£ç¡®åšæ³•ï¼š**

```bash
pcu update --interactive --create-backup  # å®‰å…¨ï¼æœ‰å¤‡ä»½
```

#### é”™è¯¯ 2ï¼šç›´æ¥æ›´æ–°ä¸»ç‰ˆæœ¬

**âŒ é”™è¯¯åšæ³•ï¼š**

```bash
pcu update --target latest  # å¯èƒ½åŒ…å«ç ´åæ€§å˜æ›´
```

**âœ… æ­£ç¡®åšæ³•ï¼š**

```bash
# å…ˆæ£€æŸ¥ä¼šæ›´æ–°ä»€ä¹ˆ
pcu check

# ä»å®‰å…¨çš„å°ç‰ˆæœ¬å¼€å§‹
pcu update --target minor --create-backup

# å¯¹ä¸»ç‰ˆæœ¬æ›´æ–°è¦ç‰¹åˆ«å°å¿ƒ
pcu update --interactive  # æ‰‹åŠ¨é€‰æ‹©ä¸»ç‰ˆæœ¬æ›´æ–°
```

#### é”™è¯¯ 3ï¼šå¿½ç•¥å®‰å…¨æ‰«æ

**âŒ é”™è¯¯åšæ³•ï¼š**

```bash
pcu update  # å¯èƒ½ç•™ä¸‹å®‰å…¨æ¼æ´
```

**âœ… æ­£ç¡®åšæ³•ï¼š**

```bash
# å…ˆä¿®å¤å®‰å…¨é—®é¢˜
pcu security --fix-vulns

# å†è¿›è¡Œå¸¸è§„æ›´æ–°
pcu update --target minor
```

### æ–°æ‰‹å‹å¥½çš„å·¥ä½œæµ

å»ºç«‹è¿™ä¸ªç®€å•çš„æ—¥å¸¸ä¹ æƒ¯ï¼š

<CodeGroup>

```bash {{ title: 'æ¯æ—¥æ£€æŸ¥ï¼ˆ2åˆ†é’Ÿï¼‰' }}
# 1. å¿«é€ŸæŸ¥çœ‹å¯ç”¨æ›´æ–°
pcu check --format minimal

# 2. æ£€æŸ¥æ˜¯å¦æœ‰å®‰å…¨é—®é¢˜
pcu security

# å¦‚æœæœ‰å®‰å…¨é—®é¢˜ï¼Œç«‹å³ä¿®å¤ï¼š
pcu security --fix-vulns
```

```bash {{ title: 'æ¯å‘¨æ›´æ–°ï¼ˆ10åˆ†é’Ÿï¼‰' }}
# 1. æ£€æŸ¥æ‰€æœ‰å¯ç”¨æ›´æ–°
pcu check

# 2. äº¤äº’å¼æ›´æ–°ï¼ˆæœ‰å¤‡ä»½ï¼‰
pcu update --interactive --create-backup

# 3. éªŒè¯ä¸€åˆ‡æ­£å¸¸
pcu workspace --validate

# 4. è¿è¡Œæ‚¨çš„æµ‹è¯•
npm test  # æˆ– pnpm test
```

</CodeGroup>

### çœŸå®åœºæ™¯ï¼šç¬¬ä¸€ä¸ªé¡¹ç›®

è®©æˆ‘ä»¬è·Ÿéšæ–°æ‰‹ææ˜çš„ç¬¬ä¸€æ¬¡PCUä½“éªŒï¼š

<CodeGroup>

```bash {{ title: 'ææ˜çš„Reacté¡¹ç›®' }}
# ææ˜æœ‰ä¸€ä¸ªReacté¡¹ç›®ï¼Œè®©æˆ‘ä»¬å¸®ä»–æ£€æŸ¥ä¾èµ–

# ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹é¡¹ç›®ç»“æ„
ls -la
# ä»–çœ‹åˆ°æœ‰ pnpm-lock.yaml ä½†æ²¡æœ‰ pnpm-workspace.yaml

# ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–PCU
pcu init
# âœ… åˆ›å»ºäº† pnpm-workspace.yaml
# âœ… åˆ›å»ºäº† .pcurc.json
# âœ… é¡¹ç›®ç°åœ¨æ”¯æŒç›®å½•ä¾èµ–äº†ï¼
```

```bash {{ title: 'ç¬¬ä¸€æ¬¡æ£€æŸ¥' }}
# ç¬¬ä¸‰æ­¥ï¼šæ£€æŸ¥å¯æ›´æ–°çš„ä¾èµ–
pcu check

# ææ˜çœ‹åˆ°ï¼š
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Package         â”‚ Current â”‚ Available â”‚ Type       â”‚ Security â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ react           â”‚ 18.0.0  â”‚ 18.3.1  â”‚ minor     â”‚ âœ…       â”‚
# â”‚ lodash          â”‚ 4.17.20 â”‚ 4.17.21 â”‚ patch     â”‚ âš ï¸       â”‚
# â”‚ @types/react    â”‚ 18.0.0  â”‚ 18.2.25 â”‚ minor     â”‚ âœ…       â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ä»–æ³¨æ„åˆ°lodashæœ‰å®‰å…¨é—®é¢˜ï¼
```

```bash {{ title: 'ä¿®å¤å®‰å…¨é—®é¢˜' }}
# ç¬¬å››æ­¥ï¼šå…ˆä¿®å¤å®‰å…¨é—®é¢˜
pcu security --fix-vulns

# âœ… ä¿®å¤äº† lodash çš„å®‰å…¨æ¼æ´
# lodash 4.17.20 â†’ 4.17.21

# ç¬¬äº”æ­¥ï¼šæ›´æ–°å…¶ä»–ä¾èµ–
pcu update --interactive --create-backup

# ææ˜é€‰æ‹©æ›´æ–° React å’Œç±»å‹å®šä¹‰
# âœ… react 18.0.0 â†’ 18.3.1
# âœ… @types/react 18.0.0 â†’ 18.2.25
```

</CodeGroup>

ç°åœ¨ææ˜çš„é¡¹ç›®æ˜¯æœ€æ–°å’Œå®‰å…¨çš„ï¼ä»–å­¦ä¼šäº†ï¼š

1. âœ… å§‹ç»ˆå…ˆæ£€æŸ¥å’Œä¿®å¤å®‰å…¨é—®é¢˜
2. âœ… ä½¿ç”¨äº¤äº’æ¨¡å¼ä»”ç»†é€‰æ‹©æ›´æ–°
3. âœ… æ€»æ˜¯åˆ›å»ºå¤‡ä»½ä»¥é˜²å‡ºç°é—®é¢˜
4. âœ… éªŒè¯æ›´æ–°åçš„å·¥ä½œç©ºé—´çŠ¶æ€

## åŸºæœ¬å·¥ä½œæµ

### æ—¥å¸¸ä¾èµ–æ£€æŸ¥

ä½œä¸ºæ—¥å¸¸å¼€å‘ä¾‹ç¨‹çš„ä¸€éƒ¨åˆ†æ£€æŸ¥æ›´æ–°ï¼š

<CodeGroup>

```bash {{ title: 'å¿«é€Ÿæ£€æŸ¥' }}
# ä½¿ç”¨ç®€å•è¾“å‡ºæ£€æŸ¥æ›´æ–°
pcu -c --format minimal

# ç¤ºä¾‹è¾“å‡ºï¼š
# react           ^18.2.0  â†’  ^18.3.0
# typescript      ^5.0.0   â†’  ^5.2.0
# @types/node     ^18.0.0  â†’  ^20.0.0
```

```bash {{ title: 'è¯¦ç»†æ£€æŸ¥' }}
# ä½¿ç”¨å®Œæ•´è¡¨æ ¼æ ¼å¼æ£€æŸ¥
pcu -c

# æ˜¾ç¤ºå½©è‰²è¡¨æ ¼ï¼ŒåŒ…æ‹¬ï¼š
# - åŒ…åç§°
# - å½“å‰ç‰ˆæœ¬
# - å¯ç”¨ç‰ˆæœ¬
# - æ›´æ–°ç±»å‹ï¼ˆmajor/minor/patchï¼‰
# - å®‰å…¨æŒ‡ç¤ºå™¨
```

</CodeGroup>

### å¸¦å¤‡ä»½çš„å®‰å…¨æ›´æ–°

ä½¿ç”¨è‡ªåŠ¨å¤‡ä»½å®‰å…¨åœ°æ›´æ–°ä¾èµ–ï¼š

```bash
# å¸¦å¤‡ä»½çš„äº¤äº’å¼æ›´æ–°
pcu -i -b

# æˆ–å¸¦å¤‡ä»½çš„è‡ªåŠ¨åŒ–å°ç‰ˆæœ¬æ›´æ–°
pcu -u --target minor --create-backup
```

### ç›®æ ‡ç‰¹å®šæ›´æ–°

ä»…æ›´æ–°ç‰¹å®šç±»å‹çš„æ›´æ”¹ï¼š

<CodeGroup>

```bash {{ title: 'ä¿å®ˆæ›´æ–°' }}
# ä»…è¡¥ä¸æ›´æ–°ï¼ˆé”™è¯¯ä¿®å¤ï¼‰
pcu -u --target patch

# ä»…å°ç‰ˆæœ¬æ›´æ–°ï¼ˆæ–°åŠŸèƒ½ï¼Œæ— ç ´åæ€§å˜æ›´ï¼‰
pcu -u --target minor
```

```bash {{ title: 'æœ€æ–°ä¸€åˆ‡' }}
# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬ä¸»ç‰ˆæœ¬ï¼‰
pcu -u --target latest

# åŒ…å«é¢„å‘å¸ƒç‰ˆæœ¬
pcu -u --prerelease
```

</CodeGroup>

## å¤šç›®å½•å·¥ä½œç©ºé—´

### é—ç•™æ”¯æŒåœºæ™¯

åœ¨ä¸€ä¸ªå·¥ä½œç©ºé—´ä¸­ç®¡ç†å¤šä¸ª React ç‰ˆæœ¬ï¼š

<CodeGroup>

```yaml {{ title: 'pnpm-workspace.yaml' }}
packages:
  - "apps/*"
  - "packages/*"

catalog:
  # é»˜è®¤ç›®å½• - æœ€æ–°ç‰ˆæœ¬
  react: ^18.2.0
  react-dom: ^18.2.0
  @types/react: ^18.2.0

catalogs:
  # é—ç•™æ”¯æŒ
  react17:
    react: ^17.0.2
    react-dom: ^17.0.2
    @types/react: ^17.0.62

  # æµ‹è¯•ç‰ˆæµ‹è¯•
  react-next:
    react: ^19.0.0-beta
    react-dom: ^19.0.0-beta
```

```bash {{ title: 'ç›®å½•ç‰¹å®šæ›´æ–°' }}
# ä»…æ›´æ–°é»˜è®¤ç›®å½•
pcu -u --catalog default

# æ›´æ–°é—ç•™ React ç‰ˆæœ¬
pcu -u --catalog react17 --target minor

# æ£€æŸ¥æµ‹è¯•ç‰ˆæœ¬
pcu -c --catalog react-next --prerelease
```

</CodeGroup>

### åŒ…ä½¿ç”¨

```json {{ title: 'package.json' }}
{
  "name": "@myorg/modern-app",
  "dependencies": {
    "react": "catalog:",
    "react-dom": "catalog:"
  }
}
```

```json {{ title: 'é—ç•™ package.json' }}
{
  "name": "@myorg/legacy-app",
  "dependencies": {
    "react": "catalog:react17",
    "react-dom": "catalog:react17"
  }
}
```

## é…ç½®ç¤ºä¾‹

### React ç”Ÿæ€ç³»ç»Ÿç®¡ç†

React å’Œç›¸å…³åŒ…çš„åè°ƒæ›´æ–°ï¼š

```json {{ title: '.pcurc.json' }}
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": [
        "@types/react",
        "@types/react-dom",
        "react-router-dom",
        "@testing-library/react"
      ]
    }
  ],
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true
  }
}
```

### TypeScript é¡¹ç›®é…ç½®

ä¿å®ˆçš„ TypeScript æ›´æ–°ä¸è‡ªåŠ¨ç±»å‹å®šä¹‰ï¼š

```json {{ title: '.pcurc.json' }}
{
  "packageRules": [
    {
      "patterns": ["typescript"],
      "target": "minor",
      "requireConfirmation": true
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    },
    {
      "patterns": ["eslint*", "@typescript-eslint/*"],
      "target": "minor",
      "groupUpdate": true
    }
  ]
}
```

### ä¼ä¸šé…ç½®

ä¼ä¸šçº§é…ç½®ï¼Œå…·æœ‰ä¸¥æ ¼æ§åˆ¶ï¼š

```json {{ title: '.pcurc.json' }}
{
  "defaults": {
    "target": "minor",
    "createBackup": true
  },
  "exclude": ["typescript", "@types/node", "react", "react-dom"],
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true,
    "notifyOnSecurityUpdate": true
  },
  "advanced": {
    "concurrency": 3,
    "timeout": 60000,
    "retries": 5
  },
  "ui": {
    "theme": "minimal",
    "animations": false
  }
}
```

## CI/CD é›†æˆ

### GitHub Actions

åœ¨ CI æµæ°´çº¿ä¸­è‡ªåŠ¨åŒ–ä¾èµ–æ£€æŸ¥ï¼š

<CodeGroup>

```yaml {{ title: '.github/workflows/dependencies.yml' }}
name: Check Dependencies

on:
  schedule:
    - cron: '0 9 * * MON'  # æ¯å‘¨ä¸€ä¸Šåˆ 9 ç‚¹
  workflow_dispatch:

jobs:
  check-deps:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install PCU
        run: npm install -g pcu

      - name: Check for updates
        run: pcu -c --format json > updates.json

      - name: Create Issue if Updates Available
        if: success()
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const updates = JSON.parse(fs.readFileSync('updates.json', 'utf8'));
            if (updates.length > 0) {
              github.rest.issues.create({
                owner: context.repo.owner,
                repo: context.repo.repo,
                title: 'Dependencies Update Available',
                body: `Found ${updates.length} packages that can be updated:

` +
                      updates.map(u => `- ${u.package}: ${u.current} â†’ ${u.available}`).join('
')
              });
            }
```

```bash {{ title: 'Package.json è„šæœ¬' }}
# æ·»åŠ åˆ°æ‚¨çš„ package.json
{
  "scripts": {
    "deps:check": "pcu -c",
    "deps:update": "pcu -i -b",
    "deps:update-minor": "pcu -u --target minor --create-backup",
    "deps:analyze": "pcu -a default"
  }
}
```

</CodeGroup>

## é”™è¯¯å¤„ç†å’Œæ•…éšœæ’é™¤

### ç½‘ç»œé—®é¢˜

å¤„ç†ç½‘ç»œé—®é¢˜å’Œæ³¨å†Œè¡¨è®¿é—®ï¼š

```bash
# ä¸ºæ…¢è¿æ¥å¢åŠ è¶…æ—¶
pcu -c --timeout 60000

# ä¸ºä¸ç¨³å®šç½‘ç»œå‡å°‘å¹¶å‘
pcu -u --concurrency 2
```

### å·¥ä½œç©ºé—´éªŒè¯

éªŒè¯å·¥ä½œç©ºé—´è®¾ç½®ï¼š

```bash
# æ£€æŸ¥å·¥ä½œç©ºé—´é…ç½®
pcu -s --validate

# è·å–è¯¦ç»†å·¥ä½œç©ºé—´ä¿¡æ¯
pcu -s --stats --verbose
```

### ç§æœ‰æ³¨å†Œè¡¨

PCU è‡ªåŠ¨è¯»å– `.npmrc` å’Œ `.pnpmrc` é…ç½®ï¼š

<CodeGroup>

```ini {{ title: '.npmrc' }}
@myorg:registry=https://npm.private-registry.com/
//npm.private-registry.com/:_authToken=${NPM_TOKEN}

registry=https://registry.npmjs.org/
```

```bash {{ title: 'ä½¿ç”¨æ–¹æ³•' }}
# PCU å°†è‡ªåŠ¨ä½¿ç”¨æ‚¨çš„æ³¨å†Œè¡¨è®¾ç½®
pcu -c

# æ£€æŸ¥æ¥è‡ªç§æœ‰æ³¨å†Œè¡¨çš„åŒ…
pcu -c --include "@myorg/*"
```

</CodeGroup>

## é«˜çº§ç”¨ä¾‹

### å½±å“åˆ†æ

åˆ†ææ›´æ–°ç‰¹å®šåŒ…çš„å½±å“ï¼š

```bash
# åˆ†æ React æ›´æ–°å½±å“
pcu -a default react

# ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬åˆ†æ
pcu -a default react 18.3.0

# æ£€æŸ¥æ‰€æœ‰ç›®å½•ä¸­çš„å½±å“
pcu -a react17 react 17.0.3
```

### é€‰æ‹©æ€§æ›´æ–°

ä»…æ›´æ–°ç‰¹å®šåŒ…æˆ–æ¨¡å¼ï¼š

```bash
# ä»…æ›´æ–° React ç›¸å…³åŒ…
pcu -u --include "react*"

# æ›´æ–°é™¤æ ¸å¿ƒæ¡†æ¶å¤–çš„æ‰€æœ‰å†…å®¹
pcu -u --exclude "react*,vue*,angular*"

# ä»…æ›´æ–°ç±»å‹å®šä¹‰
pcu -u --include "@types/*" --target latest
```

### è¯•è¿è¡Œåˆ†æ

åœ¨åº”ç”¨ä¹‹å‰é¢„è§ˆæ›´æ”¹ï¼š

```bash
# æŸ¥çœ‹å°†è¢«æ›´æ–°çš„å†…å®¹
pcu -u --dry-run --verbose

# é¢„è§ˆç‰¹å®šç›®æ ‡
pcu -u --dry-run --target minor --include "@types/*"
```

## æœ€ä½³å®è·µ

### æ—¥å¸¸å·¥ä½œæµ

1. **æ™¨é—´æ£€æŸ¥**ï¼š`pcu -c` æŸ¥çœ‹å¯ç”¨æ›´æ–°
2. **å®¡æŸ¥å½±å“**ï¼šå¯¹é‡è¦æ›´æ–°ä½¿ç”¨ `pcu -a`
3. **å®‰å…¨æ›´æ–°**ï¼šä½¿ç”¨ `pcu -i -b` è¿›è¡Œå¸¦å¤‡ä»½çš„äº¤äº’å¼æ›´æ–°
4. **æµ‹è¯•**ï¼šæ›´æ–°åè¿è¡Œæµ‹è¯•å¥—ä»¶
5. **æäº¤**ï¼šå•ç‹¬æäº¤ä¾èµ–æ›´æ–°

### å›¢é˜Ÿå·¥ä½œæµ

1. **å…±äº«é…ç½®**ï¼šå°† `.pcurc.json` æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
2. **å®šæœŸå®¡æŸ¥**ï¼šå®‰æ’æ¯å‘¨ä¾èµ–å®¡æŸ¥ä¼šè®®
3. **å®‰å…¨ä¼˜å…ˆ**ï¼šå§‹ç»ˆä¼˜å…ˆå¤„ç†å®‰å…¨æ›´æ–°
4. **æ–‡æ¡£è®°å½•**ï¼šè®°å½•ä¸»è¦ä¾èµ–å†³ç­–
5. **å›æ»šè®¡åˆ’**ï¼šä¿ç•™å¤‡ä»½ä»¥ä¾¿è½»æ¾å›æ»š

### å‘å¸ƒå·¥ä½œæµ

1. **é¢„å‘å¸ƒæ£€æŸ¥**ï¼šå‘å¸ƒå‰ `pcu -c --target patch`
2. **å®‰å…¨æ‰«æ**ï¼šåœ¨ CI ä¸­å¯ç”¨ `autoFixVulnerabilities`
3. **ç‰ˆæœ¬å›ºå®š**ï¼šç”Ÿäº§å‘å¸ƒä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬
4. **æ›´æ–°è®¡åˆ’**ï¼šåœ¨å‘å¸ƒä¹‹é—´è§„åˆ’ä¾èµ–æ›´æ–°

## å®‰å…¨ç›‘æ§

### æŒç»­å®‰å…¨æ‰«æ

å°†å®‰å…¨æ‰«æé›†æˆåˆ°æ‚¨çš„å¼€å‘å·¥ä½œæµä¸­ï¼š

<CodeGroup>

```bash {{ title: 'æ—¥å¸¸å®‰å…¨æ£€æŸ¥' }}
# å¿«é€Ÿå®‰å…¨æ‰«æ
pcu security

# è‡ªåŠ¨ä¿®å¤æ¼æ´
pcu security --fix-vulns

# ä»…å…³æ³¨é«˜å±å’Œä¸¥é‡é—®é¢˜
pcu security --severity high --fix-vulns
```

```bash {{ title: 'å…¨é¢å®‰å…¨å®¡è®¡' }}
# ä½¿ç”¨ Snyk é›†æˆçš„å®Œæ•´å®‰å…¨æ‰«æ
pcu security --snyk --include-dev --verbose

# å¯¼å‡ºå®‰å…¨æŠ¥å‘Šä¾›å®¡æŸ¥
pcu security --format json --snyk > security-report.json
```

</CodeGroup>

### å®‰å…¨å¯¼å‘çš„ CI/CD

```yaml {{ title: '.github/workflows/security.yml' }}
name: Security Audit

on:
  schedule:
    - cron: '0 2 * * *' # æ¯å¤©å‡Œæ™¨2ç‚¹
  pull_request:
    branches: [main]

jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install PCU
        run: npm install -g pcu

      - name: Security Scan
        run: pcu security --fix-vulns --format json > security-results.json

      - name: Upload Security Report
        uses: actions/upload-artifact@v4
        with:
          name: security-report
          path: security-results.json
```

## ä¸»é¢˜å®šåˆ¶

### äº¤äº’å¼ä¸»é¢˜è®¾ç½®

ä¸ºæ‚¨çš„å›¢é˜Ÿé…ç½® PCU çš„å¤–è§‚ï¼š

```bash
# å¯åŠ¨äº¤äº’å¼ä¸»é¢˜å‘å¯¼
pcu theme --interactive

# è®¾ç½®ç‰¹å®šä¸»é¢˜
pcu theme --set modern

# åˆ—å‡ºæ‰€æœ‰å¯ç”¨ä¸»é¢˜å’Œé¢„è§ˆ
pcu theme --list
```

### å›¢é˜Ÿä¸»é¢˜é…ç½®

```json {{ title: '.pcurc.json' }}
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "animations": true,
    "colorScheme": "auto"
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  }
}
```

## æ€§èƒ½ä¼˜åŒ–

### å¤§å‹ Monorepo é…ç½®

é’ˆå¯¹åŒ…å«æ•°ç™¾ä¸ªåŒ…çš„å¤§å‹å·¥ä½œç©ºé—´çš„ä¼˜åŒ–é…ç½®ï¼š

```json {{ title: '.pcurc.json' }}
{
  "advanced": {
    "concurrency": 15,
    "timeout": 120000,
    "retries": 5,
    "batchSize": 100
  },
  "cache": {
    "enabled": true,
    "ttl": 7200000,
    "maxSize": 104857600,
    "persistToDisk": true
  },
  "monorepo": {
    "performance": {
      "cacheWorkspaceStructure": true,
      "parallelCatalogProcessing": true,
      "streamingMode": true
    }
  }
}
```

### å¹¶è¡Œå¤„ç†ç­–ç•¥

```bash
# é«˜å¹¶å‘æ›´æ–°ï¼ˆé€‚ç”¨äºå¤§å‹é¡¹ç›®ï¼‰
pcu -u --concurrency 20 --timeout 180000

# æ‰¹é‡å¤„ç†æ¨¡å¼
pcu -u --batch-size 50 --progress-style fancy
```

## è¿ç§»ç¤ºä¾‹

### ä» npm-check-updates è¿ç§»

ä» `ncu` è¿ç§»åˆ° PCUï¼š

<CodeGroup>

```bash {{ title: 'ncu ç­‰æ•ˆå‘½ä»¤' }}
# ncu å‘½ä»¤
ncu

# PCU ç­‰æ•ˆå‘½ä»¤
pcu -c
```

```bash {{ title: 'ncu æ›´æ–°å‘½ä»¤' }}
# ncu æ›´æ–°
ncu -u

# PCU ç­‰æ•ˆå‘½ä»¤
pcu -u --target latest
```

</CodeGroup>

### ä»ä¼ ç»Ÿä¾èµ–ç®¡ç†è¿ç§»

è¿ç§»ç°æœ‰é¡¹ç›®åˆ° pnpm ç›®å½•ç³»ç»Ÿï¼š

```bash
# ç¬¬1æ­¥ï¼šåˆ†æç°æœ‰ä¾èµ–
pcu migrate --analyze

# ç¬¬2æ­¥ï¼šåˆ›å»ºç›®å½•é…ç½®
pcu migrate --create-catalogs

# ç¬¬3æ­¥ï¼šè½¬æ¢ package.json
pcu migrate --convert-packages

# ç¬¬4æ­¥ï¼šéªŒè¯è¿ç§»
pcu analyze --validate-migration
```

## è¿ç§»æŒ‡å—

### ä» npm/yarn å·¥ä½œç©ºé—´è¿ç§»

å®Œæ•´çš„è¿ç§»è¿‡ç¨‹ï¼š

<CodeGroup>

```bash {{ title: 'è¿ç§»å‡†å¤‡' }}
# å¤‡ä»½ç°æœ‰é…ç½®
cp package.json package.json.backup
cp package-lock.json package-lock.json.backup 2>/dev/null || true
cp yarn.lock yarn.lock.backup 2>/dev/null || true

# åˆ†æé¡¹ç›®ç»“æ„
pcu migrate --dry-run --verbose
```

```bash {{ title: 'æ‰§è¡Œè¿ç§»' }}
# è½¬æ¢åˆ° pnpm å·¥ä½œç©ºé—´
pcu migrate --to-pnpm-workspace

# ç”Ÿæˆç›®å½•é…ç½®
pcu migrate --generate-catalogs --strategy conservative

# éªŒè¯è¿ç§»ç»“æœ
pcu analyze --migration-report
```

</CodeGroup>

### æ¸è¿›å¼é‡‡ç”¨ç­–ç•¥

```json {{ title: 'é˜¶æ®µ1ï¼šåŸºæœ¬è®¾ç½®' }}
{
  "defaults": {
    "target": "patch"
  },
  "exclude": ["react", "react-dom", "typescript"]
}
```

```json {{ title: 'é˜¶æ®µ2ï¼šæ‰©å±•è¦†ç›–' }}
{
  "defaults": {
    "target": "minor"
  },
  "packageRules": [
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    }
  ]
}
```

## CI/CD å·¥ä½œæµé›†æˆ

### å¤šç¯å¢ƒéƒ¨ç½²

é’ˆå¯¹ä¸åŒç¯å¢ƒçš„å®Œæ•´ CI/CD å·¥ä½œæµï¼š

```yaml {{ title: '.github/workflows/deploy.yml' }}
name: Multi-Environment Deployment

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

env:
  PCU_WORKSPACE: ./

jobs:
  dependency-check:
    runs-on: ubuntu-latest
    outputs:
      has-updates: ${{ steps.check.outputs.has-updates }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install PCU
        run: npm install -g pcu

      - name: Check Dependencies
        id: check
        run: |
          pcu -c --format json > updates.json
          if [ -s updates.json ]; then
            echo "has-updates=true" >> $GITHUB_OUTPUT
          else
            echo "has-updates=false" >> $GITHUB_OUTPUT
          fi

  update-dependencies:
    needs: dependency-check
    if: needs.dependency-check.outputs.has-updates == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Create Update PR
        run: |
          pcu -u --target minor --create-backup
          # åˆ›å»º PR çš„é€»è¾‘...

  deploy-staging:
    if: github.ref == 'refs/heads/develop'
    runs-on: ubuntu-latest
    environment: staging
    steps:
      - uses: actions/checkout@v4
      - name: Deploy to Staging
        run: |
          pcu security --fix-vulns
          # éƒ¨ç½²é€»è¾‘...

  deploy-production:
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    environment: production
    needs: [dependency-check]
    steps:
      - uses: actions/checkout@v4
      - name: Production Security Check
        run: |
          pcu security --severity critical --format json
          # éƒ¨ç½²é€»è¾‘...
```

## ä¼ä¸šå·¥ä½œæµ

### åˆè§„æ€§å’Œå®¡è®¡

ä¼ä¸šçº§åˆè§„æ€§å·¥ä½œæµï¼š

```json {{ title: '.pcurc.json - ä¼ä¸šé…ç½®' }}
{
  "enterprise": {
    "compliance": {
      "requireApproval": ["major"],
      "auditTrail": true,
      "licenseCheck": true,
      "securityScan": "mandatory"
    },
    "approval": {
      "majorUpdates": {
        "approvers": ["security-team", "tech-lead"],
        "timeout": "7d"
      }
    }
  },
  "logging": {
    "level": "info",
    "file": "./logs/pcu-audit.log",
    "includeUserInfo": true
  }
}
```

### å¤šå›¢é˜Ÿåä½œ

```bash
# å›¢é˜ŸAï¼šå‰ç«¯å›¢é˜Ÿ
pcu -u --workspace-filter "@frontend/*" --target minor

# å›¢é˜ŸBï¼šåç«¯å›¢é˜Ÿ
pcu -u --workspace-filter "@backend/*" --target patch

# å›¢é˜ŸCï¼šå…±äº«åº“å›¢é˜Ÿ
pcu -u --workspace-filter "@shared/*" --target latest
```

### ä¼ä¸šå®‰å…¨ç­–ç•¥

```json {{ title: 'å®‰å…¨ç­–ç•¥é…ç½®' }}
{
  "security": {
    "policy": {
      "allowedLicenses": ["MIT", "Apache-2.0", "BSD-3-Clause"],
      "blockedPackages": ["unsafe-package"],
      "maxAge": "90d",
      "severityThreshold": "moderate"
    },
    "scanning": {
      "schedule": "daily",
      "integrations": ["snyk", "whitesource"],
      "notifications": {
        "slack": "#security-alerts",
        "email": ["security@company.com"]
      }
    }
  }
}
```

### å‘å¸ƒç®¡ç†

ä¼ä¸šçº§å‘å¸ƒç®¡é“é›†æˆï¼š

```bash
# é¢„å‘å¸ƒä¾èµ–æ£€æŸ¥
pcu enterprise --pre-release-check

# ä¾èµ–å†»ç»“
pcu enterprise --freeze-deps --release v2.1.0

# å‘å¸ƒåä¾èµ–è§£å†»
pcu enterprise --unfreeze-deps --post-release

# åˆè§„æ€§æŠ¥å‘Šç”Ÿæˆ
pcu enterprise --compliance-report --format pdf
```
