export const metadata = {
  title: 'Development',
  description:
    'Set up pnpm-catalog-updates for development. Learn about the project structure, development workflow, and how to contribute.',
};

# Development

Set up PCU for development and learn how to contribute to the project. This guide covers project setup, architecture, and development workflows. {{ className: 'lead' }}

## Prerequisites

Before you start developing PCU, make sure you have the required tools:

<Note>Node.js >= 22.0.0 and pnpm >= 10.0.0 are required for development.</Note>

<CodeGroup>

```bash {{ title: 'Check Versions' }}
node --version  # Should be >= 22.0.0
pnpm --version  # Should be >= 10.0.0
```

```bash {{ title: 'Install Tools' }}
# Install Node.js via nvm (recommended)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 22
nvm use 22

# Install pnpm
npm install -g pnpm@latest
```

</CodeGroup>

## Project Setup

Clone and set up the development environment:

<CodeGroup>

```bash {{ title: 'Clone and Setup' }}
# Clone the repository
git clone https://github.com/houko/pnpm-catalog-updates.git
cd pnpm-catalog-updates

# Install dependencies
pnpm install

# Build the project
pnpm build

# Run tests to verify setup
pnpm test
```

```bash {{ title: 'Development Mode' }}
# Run in development mode
pnpm dev --help

# Build in watch mode
pnpm build:watch

# Run tests in watch mode
pnpm test:watch
```

</CodeGroup>

## Project Architecture

PCU follows clean architecture principles with clear separation of concerns:

```text
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ cli/                    # CLI application layer
â”‚   â”‚   â”œâ”€â”€ src/cli/           # CLI interface
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/      # Command handlers
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters/    # Output formatters
â”‚   â”‚   â”‚   â”œâ”€â”€ interactive/   # Interactive prompts
â”‚   â”‚   â”‚   â”œâ”€â”€ themes/        # Color themes
â”‚   â”‚   â”‚   â””â”€â”€ validators/    # Input validation
â”‚   â”‚   â””â”€â”€ bin/               # Executable binaries
â”‚   â””â”€â”€ docs/                  # Documentation site
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                  # Core business logic
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ application/   # Application services
â”‚   â”‚       â”œâ”€â”€ domain/        # Domain model (DDD)
â”‚   â”‚       â””â”€â”€ infrastructure/# Infrastructure layer
â”‚   â””â”€â”€ utils/                 # Shared utilities
â””â”€â”€ scripts/                   # Build and deployment
```

### Architecture Layers

<Properties>
  <Property name="CLI Layer" type="apps/cli">
    User interface, command parsing, output formatting
  </Property>
  <Property name="Application Layer" type="packages/core/application">
    Business logic orchestration, use cases
  </Property>
  <Property name="Domain Layer" type="packages/core/domain">
    Core business entities, value objects, repository interfaces
  </Property>
  <Property name="Infrastructure Layer" type="packages/core/infrastructure">
    External API clients, file system access, repository implementations
  </Property>
  <Property name="Utils Layer" type="packages/utils">
    Shared utilities, configuration, logging, error handling
  </Property>
</Properties>

## Development Workflow

### Making Changes

1. **Create a feature branch**:

   ```bash
   git checkout -b feature/amazing-feature
   ```

2. **Make your changes** following the coding standards

3. **Add tests** for your changes:

   ```bash
   pnpm test:watch  # Run tests in watch mode
   ```

4. **Ensure quality checks pass**:

   ```bash
   pnpm lint        # Check code style
   pnpm typecheck   # Type checking
   pnpm test        # Run all tests
   ```

5. **Commit your changes**:
   ```bash
   git commit -m 'feat: add amazing feature'
   ```

### Testing Strategy

PCU uses a comprehensive testing approach:

<CodeGroup>

```bash {{ title: 'Unit Tests' }}
# Run unit tests
pnpm test

# Run with coverage
pnpm test:coverage

# Test specific package
pnpm --filter @pcu/core test
```

```bash {{ title: 'E2E Tests' }}
# Run end-to-end tests
pnpm test:e2e

# Test against real projects
pnpm test:e2e --project example-workspace
```

```bash {{ title: 'Integration Tests' }}
# Test CLI commands
pnpm test:cli

# Test with different Node versions
nvm use 18 && pnpm test
nvm use 20 && pnpm test
nvm use 22 && pnpm test
```

</CodeGroup>

### Code Quality

PCU maintains high code quality standards:

<CodeGroup>

```bash {{ title: 'Linting and Formatting' }}
# Check code style
pnpm lint

# Fix linting issues
pnpm lint:fix

# Format code
pnpm format

# Check TypeScript types
pnpm typecheck
```

```json {{ title: 'Quality Standards' }}
{
  "coverage": {
    "statements": 85,
    "branches": 80,
    "functions": 85,
    "lines": 85
  },
  "lint": "ESLint with TypeScript rules",
  "format": "Prettier with custom config",
  "types": "Strict TypeScript configuration"
}
```

</CodeGroup>

## Adding Features

### Creating New Commands

1. **Create command handler** in `apps/cli/src/cli/commands/`:

<CodeGroup>

```typescript {{ title: 'newCommand.ts' }}
import { Command } from 'commander';
import { GlobalOptions } from '../options';

export function createNewCommand(): Command {
  return new Command('new')
    .description('Description of new command')
    .option('-f, --format <type>', 'Output format', 'table')
    .action(async (options: NewCommandOptions) => {
      // Command implementation
    });
}

interface NewCommandOptions extends GlobalOptions {
  format: string;
}
```

```typescript {{ title: 'Register Command' }}
// In apps/cli/src/cli/index.ts
import { createNewCommand } from './commands/newCommand';

program.addCommand(createNewCommand());
```

</CodeGroup>

2. **Add business logic** in `packages/core/src/application/services/`

3. **Create tests** for both CLI and core logic

4. **Update documentation**

### Adding New Output Formats

1. **Create formatter** in `apps/cli/src/cli/formatters/`:

```typescript {{ title: 'xmlFormatter.ts' }}
import { OutputFormatter, FormattedOutput } from './outputFormatter';

export class XmlFormatter implements OutputFormatter {
  format(data: any): FormattedOutput {
    // XML formatting logic
    return {
      content: xmlContent,
      type: 'xml',
    };
  }
}
```

2. **Register formatter** in the main formatter registry

3. **Add tests** and **update documentation**

## Contributing Guidelines

### Commit Message Convention

PCU uses [Conventional Commits](https://conventionalcommits.org/):

<CodeGroup>

```bash {{ title: 'Commit Types' }}
feat: A new feature
fix: A bug fix
docs: Documentation only changes
style: Code style changes (formatting, etc)
refactor: Code change that neither fixes a bug nor adds a feature
test: Adding missing tests or correcting existing tests
chore: Changes to build process or auxiliary tools
```

```bash {{ title: 'Examples' }}
feat: add support for custom registries
fix: handle network timeouts gracefully
docs: update configuration examples
test: add tests for package filtering
```

</CodeGroup>

### Pull Request Process

1. **Fork the repository** and create a feature branch
2. **Make your changes** following the development workflow
3. **Ensure all tests pass** and code quality checks succeed
4. **Update documentation** if needed
5. **Submit a pull request** with:
   - Clear description of changes
   - Link to related issues
   - Screenshots for UI changes
   - Breaking change notes if applicable

### Code Review Checklist

- [ ] All tests pass
- [ ] Code coverage maintained (>85%)
- [ ] TypeScript types are correct
- [ ] Code style follows project standards
- [ ] Documentation updated
- [ ] Breaking changes documented
- [ ] Performance impact considered

## Debugging

### Development Debugging

<CodeGroup>

```bash {{ title: 'Debug CLI Commands' }}
# Debug with Node.js inspector
node --inspect-brk ./apps/cli/bin/pcu.js --help

# Debug with VS Code
# Use the launch configuration in .vscode/launch.json
```

```bash {{ title: 'Verbose Logging' }}
# Enable debug logging
DEBUG=pcu:* pnpm dev --verbose

# Debug specific modules
DEBUG=pcu:core,pcu:cli pcu -c
```

</CodeGroup>

### Testing Debugging

```bash
# Debug specific test
npm test -- --grep "specific test name"

# Debug with Node inspector
node --inspect-brk node_modules/.bin/vitest run
```

## Building and Publishing

### Local Testing

<CodeGroup>

```bash {{ title: 'Test Local Build' }}
# Build and test locally
pnpm build
pnpm --filter @pcu/cli start --help

# Test installation
npm pack apps/cli
npm install -g pcu-*.tgz
```

```bash {{ title: 'Test in Example Project' }}
# Use the example workspace
cd apps/example
pcu -c
pcu -u --dry-run
```

</CodeGroup>

### Release Process

1. **Update version** using changesets:

   ```bash
   pnpm changeset
   pnpm changeset version
   ```

2. **Build and test**:

   ```bash
   pnpm build
   pnpm test
   pnpm test:e2e
   ```

3. **Publish** (maintainers only):
   ```bash
   pnpm publish -r
   ```

## Getting Help

- ğŸ“– **Documentation**: Check this documentation for detailed guides
- ğŸ› **Issues**: Report bugs via [GitHub Issues](https://github.com/houko/pnpm-catalog-updates/issues)
- ğŸ’¬ **Discussions**: Ask questions in [GitHub Discussions](https://github.com/houko/pnpm-catalog-updates/discussions)
- ğŸ”§ **Development**: Join development discussions in issues and PRsexport const metadata = {
  title: 'Development',
  description:
  'Set up pnpm-catalog-updates for development. Learn about the project structure, development workflow, and how to contribute.',
  };

# Development

Set up PCU for development and learn how to contribute to the project. This guide covers project setup, architecture, and development workflows. {{ className: 'lead' }}

## Prerequisites

Before you start developing PCU, make sure you have the required tools:

<Note>Node.js >= 22.0.0 and pnpm >= 10.0.0 are required for development.</Note>

<CodeGroup>

```bash {{ title: 'Check Versions' }}
node --version  # Should be >= 22.0.0
pnpm --version  # Should be >= 10.0.0
```

```bash {{ title: 'Install Tools' }}
# Install Node.js via nvm (recommended)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 22
nvm use 22

# Install pnpm
npm install -g pnpm@latest
```

</CodeGroup>

## Project Setup

Clone and set up the development environment:

<CodeGroup>

```bash {{ title: 'Clone and Setup' }}
# Clone the repository
git clone https://github.com/houko/pnpm-catalog-updates.git
cd pnpm-catalog-updates

# Install dependencies
pnpm install

# Build the project
pnpm build

# Run tests to verify setup
pnpm test
```

```bash {{ title: 'Development Mode' }}
# Run in development mode
pnpm dev --help

# Build in watch mode
pnpm build:watch

# Run tests in watch mode
pnpm test:watch
```

</CodeGroup>

## Project Architecture

PCU follows clean architecture principles with clear separation of concerns:

```text
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ cli/                    # CLI application layer
â”‚   â”‚   â”œâ”€â”€ src/cli/           # CLI interface
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/      # Command handlers
â”‚   â”‚   â”‚   â”œâ”€â”€ formatters/    # Output formatters
â”‚   â”‚   â”‚   â”œâ”€â”€ interactive/   # Interactive prompts
â”‚   â”‚   â”‚   â”œâ”€â”€ themes/        # Color themes
â”‚   â”‚   â”‚   â””â”€â”€ validators/    # Input validation
â”‚   â”‚   â””â”€â”€ bin/               # Executable binaries
â”‚   â””â”€â”€ docs/                  # Documentation site
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                  # Core business logic
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ application/   # Application services
â”‚   â”‚       â”œâ”€â”€ domain/        # Domain model (DDD)
â”‚   â”‚       â””â”€â”€ infrastructure/# Infrastructure layer
â”‚   â””â”€â”€ utils/                 # Shared utilities
â””â”€â”€ scripts/                   # Build and deployment
```

### Architecture Layers

<Properties>
  <Property name="CLI Layer" type="apps/cli">
    User interface, command parsing, output formatting
  </Property>
  <Property name="Application Layer" type="packages/core/application">
    Business logic orchestration, use cases
  </Property>
  <Property name="Domain Layer" type="packages/core/domain">
    Core business entities, value objects, repository interfaces
  </Property>
  <Property name="Infrastructure Layer" type="packages/core/infrastructure">
    External API clients, file system access, repository implementations
  </Property>
  <Property name="Utils Layer" type="packages/utils">
    Shared utilities, configuration, logging, error handling
  </Property>
</Properties>

## Development Workflow

### Making Changes

1. **Create a feature branch**:

   ```bash
   git checkout -b feature/amazing-feature
   ```

2. **Make your changes** following the coding standards

3. **Add tests** for your changes:

   ```bash
   pnpm test:watch  # Run tests in watch mode
   ```

4. **Ensure quality checks pass**:

   ```bash
   pnpm lint        # Check code style
   pnpm typecheck   # Type checking
   pnpm test        # Run all tests
   ```

5. **Commit your changes**:
   ```bash
   git commit -m 'feat: add amazing feature'
   ```

### Testing Strategy

PCU uses a comprehensive testing approach:

<CodeGroup>

```bash {{ title: 'Unit Tests' }}
# Run unit tests
pnpm test

# Run with coverage
pnpm test:coverage

# Test specific package
pnpm --filter @pcu/core test
```

```bash {{ title: 'E2E Tests' }}
# Run end-to-end tests
pnpm test:e2e

# Test against real projects
pnpm test:e2e --project example-workspace
```

```bash {{ title: 'Integration Tests' }}
# Test CLI commands
pnpm test:cli

# Test with different Node versions
nvm use 18 && pnpm test
nvm use 20 && pnpm test
nvm use 22 && pnpm test
```

</CodeGroup>

### Code Quality

PCU maintains high code quality standards:

<CodeGroup>

```bash {{ title: 'Linting and Formatting' }}
# Check code style
pnpm lint

# Fix linting issues
pnpm lint:fix

# Format code
pnpm format

# Check TypeScript types
pnpm typecheck
```

```json {{ title: 'Quality Standards' }}
{
  "coverage": {
    "statements": 85,
    "branches": 80,
    "functions": 85,
    "lines": 85
  },
  "lint": "ESLint with TypeScript rules",
  "format": "Prettier with custom config",
  "types": "Strict TypeScript configuration"
}
```

</CodeGroup>

## Adding Features

### Creating New Commands

1. **Create command handler** in `apps/cli/src/cli/commands/`:

<CodeGroup>

```typescript {{ title: 'newCommand.ts' }}
import { Command } from 'commander';
import { GlobalOptions } from '../options';

export function createNewCommand(): Command {
  return new Command('new')
    .description('Description of new command')
    .option('-f, --format <type>', 'Output format', 'table')
    .action(async (options: NewCommandOptions) => {
      // Command implementation
    });
}

interface NewCommandOptions extends GlobalOptions {
  format: string;
}
```

```typescript {{ title: 'Register Command' }}
// In apps/cli/src/cli/index.ts
import { createNewCommand } from './commands/newCommand';

program.addCommand(createNewCommand());
```

</CodeGroup>

2. **Add business logic** in `packages/core/src/application/services/`

3. **Create tests** for both CLI and core logic

4. **Update documentation**

### Adding New Output Formats

1. **Create formatter** in `apps/cli/src/cli/formatters/`:

```typescript {{ title: 'xmlFormatter.ts' }}
import { OutputFormatter, FormattedOutput } from './outputFormatter';

export class XmlFormatter implements OutputFormatter {
  format(data: any): FormattedOutput {
    // XML formatting logic
    return {
      content: xmlContent,
      type: 'xml',
    };
  }
}
```

2. **Register formatter** in the main formatter registry

3. **Add tests** and **update documentation**

## Contributing Guidelines

### Commit Message Convention

PCU uses [Conventional Commits](https://conventionalcommits.org/):

<CodeGroup>

```bash {{ title: 'Commit Types' }}
feat: A new feature
fix: A bug fix
docs: Documentation only changes
style: Code style changes (formatting, etc)
refactor: Code change that neither fixes a bug nor adds a feature
test: Adding missing tests or correcting existing tests
chore: Changes to build process or auxiliary tools
```

```bash {{ title: 'Examples' }}
feat: add support for custom registries
fix: handle network timeouts gracefully
docs: update configuration examples
test: add tests for package filtering
```

</CodeGroup>

### Pull Request Process

1. **Fork the repository** and create a feature branch
2. **Make your changes** following the development workflow
3. **Ensure all tests pass** and code quality checks succeed
4. **Update documentation** if needed
5. **Submit a pull request** with:
   - Clear description of changes
   - Link to related issues
   - Screenshots for UI changes
   - Breaking change notes if applicable

### Code Review Checklist

- [ ] All tests pass
- [ ] Code coverage maintained (>85%)
- [ ] TypeScript types are correct
- [ ] Code style follows project standards
- [ ] Documentation updated
- [ ] Breaking changes documented
- [ ] Performance impact considered

## Debugging

### Development Debugging

<CodeGroup>

```bash {{ title: 'Debug CLI Commands' }}
# Debug with Node.js inspector
node --inspect-brk ./apps/cli/bin/pcu.js --help

# Debug with VS Code
# Use the launch configuration in .vscode/launch.json
```

```bash {{ title: 'Verbose Logging' }}
# Enable debug logging
DEBUG=pcu:* pnpm dev --verbose

# Debug specific modules
DEBUG=pcu:core,pcu:cli pcu -c
```

</CodeGroup>

### Testing Debugging

```bash
# Debug specific test
npm test -- --grep "specific test name"

# Debug with Node inspector
node --inspect-brk node_modules/.bin/vitest run
```

## Building and Publishing

### Local Testing

<CodeGroup>

```bash {{ title: 'Test Local Build' }}
# Build and test locally
pnpm build
pnpm --filter @pcu/cli start --help

# Test installation
npm pack apps/cli
npm install -g pcu-*.tgz
```

```bash {{ title: 'Test in Example Project' }}
# Use the example workspace
cd apps/example
pcu -c
pcu -u --dry-run
```

</CodeGroup>

### Release Process

1. **Update version** using changesets:

   ```bash
   pnpm changeset
   pnpm changeset version
   ```

2. **Build and test**:

   ```bash
   pnpm build
   pnpm test
   pnpm test:e2e
   ```

3. **Publish** (maintainers only):
   ```bash
   pnpm publish -r
   ```

## Getting Help

- ğŸ“– **Documentation**: Check this documentation for detailed guides
- ğŸ› **Issues**: Report bugs via [GitHub Issues](https://github.com/houko/pnpm-catalog-updates/issues)
- ğŸ’¬ **Discussions**: Ask questions in [GitHub Discussions](https://github.com/houko/pnpm-catalog-updates/discussions)
- ğŸ”§ **Development**: Join development discussions in issues and PRs
