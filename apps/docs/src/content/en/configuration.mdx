export const metadata = {
  title: 'Configuration',
  description:
    'Learn how to configure pnpm-catalog-updates for your workflow with .pcurc.json settings, package rules, and advanced options.',
};

# Configuration

Configure PCU to match your workflow and project needs. Learn about configuration files, package-specific rules, and advanced settings. {{ className: 'lead' }}

## Configuration File Types

PCU supports multiple configuration file formats and locations to accommodate different development workflows.

### Supported Configuration Files

PCU searches for configuration files in the following order (first found wins):

<Properties>
  <Property name=".pcurc.json" type="JSON">
    Primary JSON configuration file in project root
  </Property>
  <Property name=".pcurc.js" type="JavaScript">
    JavaScript configuration file with dynamic configuration support
  </Property>
  <Property name="pcu.config.js" type="JavaScript">
    Alternative JavaScript configuration filename
  </Property>
  <Property name="~/.pcurc.json" type="JSON">
    Global user configuration in home directory
  </Property>
  <Property name="package.json" type="JSON">
    Configuration within package.json under "pcu" key
  </Property>
</Properties>

### JavaScript Configuration Support

JavaScript configuration files enable dynamic configuration based on environment, workspace structure, or other runtime conditions:

<CodeGroup>

```javascript {{ title: '.pcurc.js' }}
module.exports = {
  defaults: {
    target: process.env.NODE_ENV === 'production' ? 'minor' : 'latest',
    createBackup: true,
  },
  workspace: {
    autoDiscover: true,
    catalogMode: 'strict',
  },
  // Dynamic package rules based on workspace structure
  packageRules: [
    {
      patterns: ['react*'],
      target: 'minor',
      requireConfirmation: process.env.CI !== 'true',
    },
  ],
  // Environment-specific configuration
  ...(process.env.NODE_ENV === 'development' && {
    ui: {
      theme: 'modern',
      progressBarStyle: 'fancy',
    },
  }),
};
```

```javascript {{ title: 'pcu.config.js with Functions' }}
const fs = require('fs');
const path = require('path');

function getWorkspacePackages() {
  const workspaceFile = path.join(__dirname, 'pnpm-workspace.yaml');
  if (fs.existsSync(workspaceFile)) {
    // Parse workspace packages dynamically
    return ['packages/*', 'apps/*', 'tools/*'];
  }
  return ['packages/*'];
}

module.exports = {
  workspace: {
    packages: getWorkspacePackages(),
    catalogMode: 'flexible',
  },
  packageRules: [
    // Generate rules based on existing packages
    ...fs.readdirSync('./packages').map((pkg) => ({
      patterns: [`@myorg/${pkg}`],
      target: 'minor',
    })),
  ],
};
```

</CodeGroup>

### Package.json Configuration

For simpler projects, configuration can be embedded within package.json:

```json
{
  "name": "my-project",
  "pcu": {
    "defaults": {
      "target": "minor",
      "createBackup": true
    },
    "packageRules": [
      {
        "patterns": ["@types/*"],
        "target": "latest",
        "autoUpdate": true
      }
    ]
  }
}
```

### Configuration Validation

PCU automatically validates configuration files and provides detailed error messages for common issues:

#### Validation Features

- **JSON Schema Validation**: Ensures all configuration properties are valid
- **Pattern Validation**: Validates glob patterns and package name formats
- **Type Checking**: Verifies correct data types for all configuration values
- **Conflict Detection**: Identifies conflicting rules and configuration options
- **Suggestion System**: Provides helpful suggestions for fixing configuration errors

#### Validation Examples

```bash
# Validate current configuration
pcu workspace --validate

# Common validation errors with suggestions:
# âŒ Invalid target "lastest" in packageRules[0]
#    ğŸ’¡ Did you mean "latest"?
#
# âŒ Pattern "react+" is invalid glob syntax
#    ğŸ’¡ Use "react*" for matching packages starting with "react"
#
# âš ï¸  Conflicting rules for package "react"
#    ğŸ“ Rule at index 0 and 2 both match this package
```

## .pcurc.json é…ç½®æ–‡ä»¶å®Œæ•´å‚è€ƒ

PCU ä½¿ç”¨å¤šç§é…ç½®æ–‡ä»¶æ ¼å¼ï¼Œä¸»è¦ä½¿ç”¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `.pcurc.json` æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚å¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œæˆ–ä½¿ç”¨ `pcu init` ç”Ÿæˆé»˜è®¤é…ç½®ã€‚

### å®Œæ•´é…ç½®æ–‡ä»¶ç»“æ„

<CodeGroup>

```json {{ title: 'å®Œæ•´é…ç½®ç¤ºä¾‹' }}
{
  "defaults": {
    "target": "latest",
    "timeout": 30000,
    "createBackup": false,
    "interactive": false,
    "dryRun": false,
    "force": false,
    "prerelease": false
  },
  "workspace": {
    "autoDiscover": true,
    "catalogMode": "strict",
    "path": "./",
    "packages": ["packages/*", "apps/*"]
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  },
  "ui": {
    "theme": "default",
    "progressBars": true,
    "progressBarStyle": "default",
    "animations": true,
    "colorScheme": "auto"
  },
  "update": {
    "interactive": false,
    "dryRunFirst": false,
    "skipPrereleases": true,
    "confirmMajorUpdates": true,
    "batchSize": 10
  },
  "security": {
    "autoFixVulnerabilities": false,
    "allowMajorForSecurity": false,
    "notifyOnSecurityUpdate": true,
    "severityThreshold": "moderate"
  },
  "advanced": {
    "concurrency": 5,
    "timeout": 30000,
    "retries": 3,
    "cacheValidityMinutes": 60,
    "checkForUpdates": true,
    "batchSize": 50
  },
  "cache": {
    "enabled": true,
    "ttl": 3600000,
    "maxSize": 52428800,
    "maxEntries": 10000,
    "persistToDisk": true,
    "cacheDir": "~/.pcu/cache"
  },
  "registry": {
    "default": "https://registry.npmjs.org/",
    "timeout": 30000,
    "retries": 3
  },
  "include": ["*"],
  "exclude": [],
  "packageRules": [
    {
      "patterns": ["react*"],
      "target": "minor",
      "requireConfirmation": true
    }
  ],
  "notification": {
    "enabled": true,
    "updateAvailable": true,
    "securityAlerts": true
  },
  "logging": {
    "level": "info",
    "file": "./pcu.log",
    "maxFiles": 5,
    "maxSize": "10MB"
  }
}
```

```json {{ title: 'æœ€å°é…ç½®ç¤ºä¾‹' }}
{
  "defaults": {
    "target": "minor"
  },
  "exclude": ["typescript", "@types/node"]
}
```

</CodeGroup>

### é…ç½®é€‰é¡¹è¯¦ç»†è¯´æ˜

#### defaults é»˜è®¤è®¾ç½®

<Properties>
  <Property name="target" type="enum" default="latest">
    é»˜è®¤æ›´æ–°ç›®æ ‡: `latest` | `greatest` | `minor` | `patch` | `newest`
  </Property>
  <Property name="timeout" type="number" default="30000">
    ç½‘ç»œè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  </Property>
  <Property name="createBackup" type="boolean" default="false">
    æ›´æ–°å‰æ˜¯å¦åˆ›å»ºå¤‡ä»½æ–‡ä»¶
  </Property>
  <Property name="interactive" type="boolean" default="false">
    æ˜¯å¦é»˜è®¤å¯ç”¨äº¤äº’æ¨¡å¼
  </Property>
  <Property name="dryRun" type="boolean" default="false">
    æ˜¯å¦é»˜è®¤å¯ç”¨é¢„è§ˆæ¨¡å¼ï¼ˆä¸å®é™…æ›´æ–°ï¼‰
  </Property>
  <Property name="force" type="boolean" default="false">
    æ˜¯å¦å¼ºåˆ¶æ›´æ–°ï¼ˆè·³è¿‡è­¦å‘Šï¼‰
  </Property>
  <Property name="prerelease" type="boolean" default="false">
    æ˜¯å¦åŒ…å«é¢„å‘å¸ƒç‰ˆæœ¬
  </Property>
</Properties>

#### workspace å·¥ä½œç©ºé—´è®¾ç½®

<Properties>
  <Property name="autoDiscover" type="boolean" default="true">
    æ˜¯å¦è‡ªåŠ¨å‘ç°å·¥ä½œç©ºé—´ç»“æ„
  </Property>
  <Property name="catalogMode" type="enum" default="strict">
    ç›®å½•æ¨¡å¼: `strict` | `loose` | `mixed`
  </Property>
  <Property name="path" type="string" default="./">
    å·¥ä½œç©ºé—´æ ¹ç›®å½•è·¯å¾„
  </Property>
  <Property name="packages" type="string[]">
    åŒ…ç›®å½•åŒ¹é…æ¨¡å¼æ•°ç»„ï¼ˆä¼šè¦†ç›– pnpm-workspace.yamlï¼‰
  </Property>
</Properties>

#### output è¾“å‡ºè®¾ç½®

<Properties>
  <Property name="format" type="enum" default="table">
    è¾“å‡ºæ ¼å¼: `table` | `json` | `yaml` | `minimal`
  </Property>
  <Property name="color" type="boolean" default="true">
    æ˜¯å¦å¯ç”¨å½©è‰²è¾“å‡º
  </Property>
  <Property name="verbose" type="boolean" default="false">
    æ˜¯å¦å¯ç”¨è¯¦ç»†è¾“å‡ºæ¨¡å¼
  </Property>
</Properties>

#### ui ç”¨æˆ·ç•Œé¢è®¾ç½®

<Properties>
  <Property name="theme" type="enum" default="default">
    é¢œè‰²ä¸»é¢˜: `default` | `modern` | `minimal` | `neon`
  </Property>
  <Property name="progressBars" type="boolean" default="true">
    æ˜¯å¦æ˜¾ç¤ºè¿›åº¦æ¡
  </Property>
  <Property name="progressBarStyle" type="enum" default="default">
    è¿›åº¦æ¡æ ·å¼: `default` | `gradient` | `fancy` | `minimal` | `rainbow` | `neon`
  </Property>
  <Property name="animations" type="boolean" default="true">
    æ˜¯å¦å¯ç”¨åŠ¨ç”»æ•ˆæœ
  </Property>
  <Property name="colorScheme" type="enum" default="auto">
    é¢œè‰²æ–¹æ¡ˆ: `auto` | `light` | `dark`
  </Property>
</Properties>

#### update æ›´æ–°è¡Œä¸ºè®¾ç½®

<Properties>
  <Property name="interactive" type="boolean" default="false">
    æ›´æ–°æ—¶æ˜¯å¦é»˜è®¤å¯ç”¨äº¤äº’æ¨¡å¼
  </Property>
  <Property name="dryRunFirst" type="boolean" default="false">
    æ˜¯å¦å…ˆæ‰§è¡Œé¢„è§ˆï¼Œç„¶åè¯¢é—®æ˜¯å¦åº”ç”¨
  </Property>
  <Property name="skipPrereleases" type="boolean" default="true">
    æ˜¯å¦è·³è¿‡é¢„å‘å¸ƒç‰ˆæœ¬
  </Property>
  <Property name="confirmMajorUpdates" type="boolean" default="true">
    ä¸»ç‰ˆæœ¬æ›´æ–°æ˜¯å¦éœ€è¦ç¡®è®¤
  </Property>
  <Property name="batchSize" type="number" default="10">
    æ‰¹é‡å¤„ç†çš„åŒ…æ•°é‡
  </Property>
</Properties>

#### security å®‰å…¨è®¾ç½®

<Properties>
  <Property name="autoFixVulnerabilities" type="boolean" default="false">
    æ˜¯å¦è‡ªåŠ¨ä¿®å¤å®‰å…¨æ¼æ´
  </Property>
  <Property name="allowMajorForSecurity" type="boolean" default="false">
    ä¸ºäº†å®‰å…¨ä¿®å¤æ˜¯å¦å…è®¸ä¸»ç‰ˆæœ¬æ›´æ–°
  </Property>
  <Property name="notifyOnSecurityUpdate" type="boolean" default="true">
    æœ‰å®‰å…¨æ›´æ–°æ—¶æ˜¯å¦é€šçŸ¥
  </Property>
  <Property name="severityThreshold" type="enum" default="moderate">
    å®‰å…¨è­¦å‘Šçº§åˆ«é˜ˆå€¼: `low` | `moderate` | `high` | `critical`
  </Property>
</Properties>

#### advanced é«˜çº§è®¾ç½®

<Properties>
  <Property name="concurrency" type="number" default="5">
    å¹¶å‘ç½‘ç»œè¯·æ±‚æ•°é‡
  </Property>
  <Property name="timeout" type="number" default="30000">
    ç½‘ç»œè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  </Property>
  <Property name="retries" type="number" default="3">
    å¤±è´¥é‡è¯•æ¬¡æ•°
  </Property>
  <Property name="cacheValidityMinutes" type="number" default="60">
    ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆåˆ†é’Ÿï¼Œ0 è¡¨ç¤ºç¦ç”¨ç¼“å­˜ï¼‰
  </Property>
  <Property name="checkForUpdates" type="boolean" default="true">
    å¯åŠ¨æ—¶æ˜¯å¦æ£€æŸ¥ PCU å·¥å…·æ›´æ–°
  </Property>
  <Property name="batchSize" type="number" default="50">
    æ‰¹é‡å¤„ç†çš„æœ€å¤§åŒ…æ•°é‡
  </Property>
</Properties>

#### cache ç¼“å­˜è®¾ç½®

<Properties>
  <Property name="enabled" type="boolean" default="true">
    æ˜¯å¦å¯ç”¨ç¼“å­˜ç³»ç»Ÿ
  </Property>
  <Property name="ttl" type="number" default="3600000">
    ç¼“å­˜ç”Ÿå­˜æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  </Property>
  <Property name="maxSize" type="number" default="52428800">
    æœ€å¤§ç¼“å­˜å¤§å°ï¼ˆå­—èŠ‚ï¼Œé»˜è®¤ 50MBï¼‰
  </Property>
  <Property name="maxEntries" type="number" default="10000">
    æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
  </Property>
  <Property name="persistToDisk" type="boolean" default="true">
    æ˜¯å¦æŒä¹…åŒ–ç¼“å­˜åˆ°ç£ç›˜
  </Property>
  <Property name="cacheDir" type="string" default="~/.pcu/cache">
    ç¼“å­˜ç›®å½•è·¯å¾„
  </Property>
</Properties>

#### registry æ³¨å†Œè¡¨è®¾ç½®

<Properties>
  <Property name="default" type="string" default="https://registry.npmjs.org/">
    é»˜è®¤ NPM æ³¨å†Œè¡¨ URL
  </Property>
  <Property name="timeout" type="number" default="30000">
    æ³¨å†Œè¡¨è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  </Property>
  <Property name="retries" type="number" default="3">
    æ³¨å†Œè¡¨è¯·æ±‚é‡è¯•æ¬¡æ•°
  </Property>
</Properties>

#### åŒ…è¿‡æ»¤è®¾ç½®

<Properties>
  <Property name="include" type="string[]" default="['*']">
    åŒ…å«çš„åŒ…ååŒ¹é…æ¨¡å¼æ•°ç»„
  </Property>
  <Property name="exclude" type="string[]" default="[]">
    æ’é™¤çš„åŒ…ååŒ¹é…æ¨¡å¼æ•°ç»„
  </Property>
</Properties>

#### notification é€šçŸ¥è®¾ç½®

<Properties>
  <Property name="enabled" type="boolean" default="true">
    æ˜¯å¦å¯ç”¨é€šçŸ¥åŠŸèƒ½
  </Property>
  <Property name="updateAvailable" type="boolean" default="true">
    æœ‰æ›´æ–°å¯ç”¨æ—¶æ˜¯å¦é€šçŸ¥
  </Property>
  <Property name="securityAlerts" type="boolean" default="true">
    æœ‰å®‰å…¨è­¦å‘Šæ—¶æ˜¯å¦é€šçŸ¥
  </Property>
</Properties>

#### logging æ—¥å¿—è®¾ç½®

<Properties>
  <Property name="level" type="enum" default="info">
    æ—¥å¿—çº§åˆ«: `error` | `warn` | `info` | `debug` | `trace`
  </Property>
  <Property name="file" type="string">
    æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
  </Property>
  <Property name="maxFiles" type="number" default="5">
    æœ€å¤§æ—¥å¿—æ–‡ä»¶æ•°é‡
  </Property>
  <Property name="maxSize" type="string" default="10MB">
    å•ä¸ªæ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°
  </Property>
</Properties>

## Package Filtering

Control which packages to update with include/exclude patterns and package-specific rules.

<CodeGroup>

```json {{ title: 'Simple Filtering' }}
{
  "exclude": ["typescript", "@types/node", "react", "react-dom"],
  "include": ["lodash*", "chalk", "commander"]
}
```

```json {{ title: 'Package Rules' }}
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": ["@types/react", "@types/react-dom"]
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    },
    {
      "patterns": ["eslint*", "prettier"],
      "target": "minor",
      "groupUpdate": true
    }
  ]
}
```

</CodeGroup>

### Package Rule Properties

<Properties>
  <Property name="patterns" type="string[]" required>
    Glob patterns to match package names
  </Property>
  <Property name="target" type="enum">
    Update target: latest, greatest, minor, patch, newest
  </Property>
  <Property name="requireConfirmation" type="boolean">
    Always ask before updating these packages
  </Property>
  <Property name="autoUpdate" type="boolean">
    Update automatically without confirmation
  </Property>
  <Property name="relatedPackages" type="string[]">
    Packages that follow the same update strategy
  </Property>
  <Property name="groupUpdate" type="boolean">
    Update related packages together
  </Property>
</Properties>

## Security Configuration

Configure security vulnerability scanning and automatic fixes.

```json
{
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true,
    "notifyOnSecurityUpdate": true
  }
}
```

<Properties>
  <Property name="autoFixVulnerabilities" type="boolean">
    Automatically check and fix security vulnerabilities
  </Property>
  <Property name="allowMajorForSecurity" type="boolean">
    Allow major version upgrades for security fixes
  </Property>
  <Property name="notifyOnSecurityUpdate" type="boolean">
    Show notifications on security updates
  </Property>
</Properties>

## Monorepo Configuration

Special settings for complex monorepo setups with multiple catalogs.

```json
{
  "monorepo": {
    "syncVersions": ["react", "react-dom"],
    "catalogPriority": ["default", "latest", "react17"]
  }
}
```

<Properties>
  <Property name="syncVersions" type="string[]">
    Packages that need version sync across multiple catalogs
  </Property>
  <Property name="catalogPriority" type="string[]">
    Catalog priority order for conflict resolution
  </Property>
</Properties>

## Advanced Settings

Fine-tune performance and behavior with advanced configuration options.

```json
{
  "advanced": {
    "concurrency": 5,
    "timeout": 30000,
    "retries": 3,
    "cacheValidityMinutes": 60,
    "checkForUpdates": true
  }
}
```

<Properties>
  <Property name="concurrency" type="number" default="5">
    Number of concurrent network requests
  </Property>
  <Property name="timeout" type="number" default="30000">
    Network request timeout in milliseconds
  </Property>
  <Property name="retries" type="number" default="3">
    Number of retries on failure
  </Property>
  <Property name="cacheValidityMinutes" type="number" default="60">
    Cache validity period (0 to disable caching)
  </Property>
  <Property name="checkForUpdates" type="boolean" default="true">
    Automatically check for PCU tool updates on startup. Skipped in CI environments. Shows update
    notifications and installation instructions when newer versions are available.
  </Property>
</Properties>

## UI Configuration

Customize the visual appearance and user interface settings.

```json
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "progressBarStyle": "gradient",
    "animations": true
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  }
}
```

### Available Themes

- `default` - Balanced colors for general use
- `modern` - Vibrant colors for development environments
- `minimal` - Clean and simple for production environments
- `neon` - High contrast colors for presentations

### Progress Bar Styles

PCU supports 6 different progress bar styles for enhanced visual feedback during operations:

- `default` - Standard progress bar with basic styling
- `gradient` - Gradient-colored progress bar for modern appearance
- `fancy` - Enhanced progress bar with decorative elements
- `minimal` - Clean and simple progress indicator
- `rainbow` - Multi-colored progress bar for vibrant displays
- `neon` - High-contrast progress bar matching neon theme

**Configuration Example:**

```json
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "progressBarStyle": "gradient"
  }
}
```

**Command Line Usage:**

```bash
pcu check --progress-style fancy
pcu update --progress-style rainbow
pcu security --progress-style neon
```

## Configuration Priority

Configuration settings are applied in this priority order:

1. **Command line flags** (highest priority)
2. **Package-specific rules** in `.pcurc.json`
3. **General settings** in `.pcurc.json`
4. **Default values** (lowest priority)

<Note>
  Related packages automatically inherit settings from their parent package rules, ensuring version
  consistency across ecosystem packages.
</Note>

## Examples

### React Ecosystem

```json
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": ["@types/react", "@types/react-dom", "react-router-dom"]
    }
  ]
}
```

### TypeScript Project

```json
{
  "packageRules": [
    {
      "patterns": ["typescript"],
      "target": "minor",
      "requireConfirmation": true
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    }
  ]
}
```

### Enterprise Setup

```json
{
  "defaults": {
    "target": "minor",
    "createBackup": true
  },
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true
  },
  "ui": {
    "theme": "minimal",
    "progressBars": true,
    "progressBarStyle": "minimal"
  },
  "advanced": {
    "concurrency": 3,
    "timeout": 60000
  },
  "exclude": ["typescript", "@types/node", "react", "react-dom"]
}
```

---

## Environment Variables

All CLI options can be configured via environment variables for automation and CI/CD environments:

<CodeGroup>

```bash {{ title: 'Global Environment Variables' }}
# Workspace settings
export PCU_WORKSPACE="/path/to/workspace"
export PCU_VERBOSE=true
export PCU_NO_COLOR=true

# Registry configuration
export PCU_REGISTRY="https://npm.company.com/"
export PCU_TIMEOUT=30000

# Configuration file
export PCU_CONFIG="/path/to/.pcurc.json"
```

```bash {{ title: 'Command-Specific Variables' }}
# Check/Update behavior
export PCU_OUTPUT_FORMAT=json
export PCU_UPDATE_TARGET=minor
export PCU_CATALOG=default

# Update options
export PCU_INTERACTIVE=true
export PCU_DRY_RUN=true
export PCU_CREATE_BACKUP=true
export PCU_FORCE=false

# Filtering
export PCU_INCLUDE="react*,@types/*"
export PCU_EXCLUDE="eslint*"
export PCU_PRERELEASE=false
```

</CodeGroup>

### Environment Variable Priority

Configuration sources are loaded in this order (later overrides earlier):

1. **Built-in defaults** (lowest priority)
2. **Global configuration** (`~/.pcurc.json`)
3. **Project configuration** (`.pcurc.json`)
4. **Environment variables** (`PCU_*`)
5. **Command-line flags** (highest priority)

---

## Registry Configuration

PCU automatically reads NPM and PNPM configuration files for registry settings:

<CodeGroup>

```ini {{ title: '.npmrc / .pnpmrc' }}
# Default registry
registry=https://registry.npmjs.org/

# Scoped registries
@mycompany:registry=https://npm.mycompany.com/
@types:registry=https://registry.npmjs.org/

# Authentication tokens
//npm.mycompany.com/:_authToken=${NPM_TOKEN}
//registry.npmjs.org/:_authToken=${NPM_PUBLIC_TOKEN}

# Legacy authentication (if needed)
//npm.mycompany.com/:username=myuser
//npm.mycompany.com/:_password=base64encodedpassword
//npm.mycompany.com/:email=user@company.com

# SSL and proxy settings
strict-ssl=true
ca=/path/to/ca.pem
proxy=http://proxy.company.com:8080
https-proxy=http://proxy.company.com:8080
```

```json {{ title: 'PCU Registry Override' }}
{
  "registry": {
    "default": "https://registry.npmjs.org/",
    "scoped": {
      "@mycompany": "https://npm.mycompany.com/",
      "@types": "https://registry.npmjs.org/"
    },
    "auth": {
      "npm.mycompany.com": {
        "token": "${NPM_TOKEN}",
        "type": "Bearer"
      }
    },
    "timeout": 30000,
    "retries": 3,
    "userAgent": "pcu-custom/1.0.0"
  }
}
```

</CodeGroup>

### Registry Priority

1. **CLI `--registry` flag** (highest priority)
2. **PCU configuration** (`.pcurc.json` registry section)
3. **Project `.npmrc/.pnpmrc`**
4. **Global `.npmrc/.pnpmrc`**
5. **Default NPM registry** (lowest priority)

---

## Enhanced Caching Configuration

PCU includes an advanced caching system to improve performance:

<CodeGroup>

```json {{ title: 'Cache Configuration' }}
{
  "cache": {
    "enabled": true,
    "ttl": 3600000,
    "maxSize": 52428800,
    "maxEntries": 10000,
    "persistToDisk": true,
    "cacheDir": "~/.pcu/cache",
    "strategy": "lru"
  }
}
```

```bash {{ title: 'Cache Management' }}
# Clear all caches
rm -rf ~/.pcu/cache

# Show cache info in verbose mode
pcu -c --verbose

# Disable caching for single run
pcu -c --no-cache

# Set custom cache directory
export PCU_CACHE_DIR="/tmp/pcu-cache"
```

</CodeGroup>

### Cache Settings

<Properties>
  <Property name="enabled" type="boolean" default="true">
    Enable/disable caching system
  </Property>
  <Property name="ttl" type="number" default="3600000">
    Time to live in milliseconds (1 hour default)
  </Property>
  <Property name="maxSize" type="number" default="52428800">
    Maximum cache size in bytes (50MB default)
  </Property>
  <Property name="maxEntries" type="number" default="10000">
    Maximum number of cache entries
  </Property>
  <Property name="persistToDisk" type="boolean" default="true">
    Save cache to disk between runs
  </Property>
  <Property name="cacheDir" type="string" default="~/.pcu/cache">
    Directory for persistent cache storage
  </Property>
  <Property name="strategy" type="enum" default="lru">
    Cache eviction strategy: lru, fifo, lfu
  </Property>
</Properties>

---

## Validation Configuration

PCU includes comprehensive validation with helpful suggestions:

<CodeGroup>

```json {{ title: 'Validation Configuration' }}
{
  "validation": {
    "strict": true,
    "warnOnRiskyUpdates": true,
    "requireConfirmationFor": ["major"],
    "suggestions": {
      "enabled": true,
      "includePerformanceTips": true,
      "includeBestPractices": true
    }
  }
}
```

```bash {{ title: 'Validation Examples' }}
# Enable strict validation mode
pcu -u --force  # Will show warnings about lack of backup

# Show validation suggestions
pcu -c --verbose  # Shows additional tips and suggestions

# Validate configuration file
node -e "console.log(JSON.parse(require('fs').readFileSync('.pcurc.json')))"
```

</CodeGroup>

### Validation Options

<Properties>
  <Property name="strict" type="boolean" default="false">
    Enable strict validation mode with additional checks
  </Property>
  <Property name="warnOnRiskyUpdates" type="boolean" default="true">
    Show warnings for potentially risky updates
  </Property>
  <Property name="requireConfirmationFor" type="array" default="[]">
    Update types requiring confirmation: major, minor, patch
  </Property>
  <Property name="suggestions.enabled" type="boolean" default="true">
    Enable helpful suggestions and tips
  </Property>
  <Property name="suggestions.includePerformanceTips" type="boolean" default="true">
    Include performance optimization suggestions
  </Property>
  <Property name="suggestions.includeBestPractices" type="boolean" default="true">
    Include best practice recommendations
  </Property>
</Properties>

---

## Interactive Mode Configuration

Configure interactive prompts and user experience:

<CodeGroup>

```json {{ title: 'Interactive Configuration' }}
{
  "interactive": {
    "enabled": true,
    "pageSize": 15,
    "showPackageDescriptions": true,
    "showReleaseNotes": false,
    "autoComplete": {
      "enabled": true,
      "fuzzyMatching": true,
      "maxSuggestions": 10
    },
    "confirmations": {
      "majorUpdates": true,
      "forceUpdates": true,
      "multiplePackages": false
    }
  }
}
```

```bash {{ title: 'Interactive Mode Examples' }}
# Launch interactive mode
pcu -i

# Interactive with package descriptions
pcu -i --verbose  # Shows more details in interactive selection

# Use interactive theme selection
pcu theme --interactive
```

</CodeGroup>

### Interactive Settings

<Properties>
  <Property name="enabled" type="boolean" default="true">
    Enable interactive mode capabilities
  </Property>
  <Property name="pageSize" type="number" default="15">
    Number of items shown per page in lists
  </Property>
  <Property name="showPackageDescriptions" type="boolean" default="false">
    Show package descriptions in selection lists
  </Property>
  <Property name="showReleaseNotes" type="boolean" default="false">
    Show release notes for updates (requires network)
  </Property>
  <Property name="autoComplete.enabled" type="boolean" default="true">
    Enable auto-completion for package names
  </Property>
  <Property name="autoComplete.fuzzyMatching" type="boolean" default="true">
    Enable fuzzy matching for auto-completion
  </Property>
  <Property name="confirmations.majorUpdates" type="boolean" default="true">
    Require confirmation for major version updates
  </Property>
</Properties>

---

## Monorepo Configuration

PCU provides advanced features specifically designed for large monorepos and complex workspace management.

### Version Synchronization

Keep related packages synchronized across your monorepo:

<CodeGroup>

```json {{ title: 'Version Sync Configuration' }}
{
  "monorepo": {
    "syncVersions": {
      "enabled": true,
      "groups": [
        {
          "name": "react-ecosystem",
          "packages": ["react", "react-dom", "@types/react", "@types/react-dom"],
          "strategy": "exact" // or "compatible", "latest"
        },
        {
          "name": "testing-libraries",
          "packages": ["jest", "@testing-library/*", "@types/jest"],
          "strategy": "compatible"
        }
      ]
    },
    "catalogPriority": ["default", "react17", "node18"],
    "crossWorkspaceDependencies": {
      "analyze": true,
      "enforce": "warn" // "error", "warn", "off"
    }
  }
}
```

```json {{ title: 'Large Workspace Optimization' }}
{
  "monorepo": {
    "performance": {
      "batchSize": 50,
      "concurrency": 15,
      "cacheWorkspaceStructure": true,
      "parallelCatalogProcessing": true
    },
    "workspacePackages": {
      "autoDiscover": true,
      "includePrivate": false,
      "excludePatterns": ["**/node_modules", "**/dist", "**/coverage"]
    }
  }
}
```

</CodeGroup>

### Advanced Workspace Management

#### Catalog Priority System

Define which catalogs take precedence when conflicts arise:

```json
{
  "catalogPriority": ["production", "default", "experimental"],
  "catalogConflictResolution": "priority" // or "interactive", "error"
}
```

#### Cross-Workspace Dependencies

Analyze and manage dependencies between workspace packages:

<Properties>
  <Property name="analyze" type="boolean" default="false">
    Analyze cross-workspace dependencies
  </Property>
  <Property name="enforce" type="enum" default="warn">
    How to handle version mismatches: error, warn, off
  </Property>
  <Property name="reportUnused" type="boolean" default="true">
    Report packages in catalogs not used by any workspace package
  </Property>
  <Property name="validateVersions" type="boolean" default="true">
    Validate that all workspace packages use catalog versions
  </Property>
</Properties>

### Monorepo-Specific Package Rules

Create sophisticated rules for different areas of your monorepo:

<CodeGroup>

```json {{ title: 'Monorepo Package Rules' }}
{
  "packageRules": [
    {
      "name": "Frontend packages",
      "patterns": ["react*", "@types/react*", "next*"],
      "workspacePackages": ["apps/web", "apps/admin"],
      "target": "minor",
      "groupUpdate": true,
      "requireConfirmation": true
    },
    {
      "name": "Backend dependencies",
      "patterns": ["express*", "@types/express*", "fastify*"],
      "workspacePackages": ["apps/api", "services/*"],
      "target": "patch",
      "autoUpdate": false
    },
    {
      "name": "Development tools",
      "patterns": ["eslint*", "prettier", "typescript"],
      "workspacePackages": ["*"], // All packages
      "target": "latest",
      "autoUpdate": true,
      "excludeFromProduction": true
    }
  ]
}
```

</CodeGroup>

### Workspace-Specific Configuration

Different configuration for different parts of your monorepo:

<CodeGroup>

```json {{ title: 'Per-Workspace Rules' }}
{
  "workspaceRules": {
    "apps/web": {
      "defaults": {
        "target": "minor",
        "createBackup": true
      },
      "packageRules": [
        {
          "patterns": ["react*"],
          "target": "patch"
        }
      ]
    },
    "packages/*": {
      "defaults": {
        "target": "latest",
        "requireConfirmation": false
      }
    },
    "tools/*": {
      "defaults": {
        "target": "latest",
        "autoUpdate": true
      }
    }
  }
}
```

</CodeGroup>

### Performance Optimization for Large Monorepos

#### Batch Processing Configuration

<Properties>
  <Property name="batchSize" type="number" default="20">
    Number of packages to process in each batch
  </Property>
  <Property name="concurrency" type="number" default="5">
    Maximum number of concurrent operations
  </Property>
  <Property name="cacheWorkspaceStructure" type="boolean" default="true">
    Cache workspace package discovery between runs
  </Property>
  <Property name="parallelCatalogProcessing" type="boolean" default="true">
    Process multiple catalogs in parallel
  </Property>
</Properties>

#### Memory Management

```json
{
  "monorepo": {
    "memoryOptimization": {
      "streamingMode": true, // Process packages without loading all into memory
      "maxMemoryUsage": "2GB", // Memory limit for large workspaces
      "temporaryFileCleanup": "immediate" // "immediate", "session-end", "manual"
    }
  }
}
```

### Monorepo Validation

Comprehensive validation for complex workspace setups:

#### Validation Rules

<Properties>
  <Property name="enforceWorkspaceProtocol" type="boolean" default="true">
    Ensure workspace: protocol is used for internal dependencies
  </Property>
  <Property name="validateCatalogCoverage" type="boolean" default="true">
    Ensure all dependencies are covered by catalogs
  </Property>
  <Property name="requireConsistentVersions" type="boolean" default="false">
    Require all workspace packages to use the same version of shared dependencies
  </Property>
  <Property name="detectCircularDependencies" type="boolean" default="true">
    Detect circular dependencies between workspace packages
  </Property>
</Properties>

### Usage Examples for Monorepos

#### Large Enterprise Monorepo Setup

```json
{
  "monorepo": {
    "syncVersions": {
      "enabled": true,
      "groups": [
        {
          "name": "core-frontend",
          "packages": ["react", "react-dom", "react-router", "@types/react*"],
          "strategy": "exact"
        },
        {
          "name": "ui-libraries",
          "packages": ["@company/design-system", "@company/components"],
          "strategy": "workspace"
        }
      ]
    },
    "performance": {
      "batchSize": 100,
      "concurrency": 20,
      "streamingMode": true
    },
    "workspaceRules": {
      "apps/*": { "target": "minor", "requireConfirmation": true },
      "packages/*": { "target": "latest", "autoUpdate": true },
      "tools/*": { "target": "latest", "autoUpdate": true }
    }
  }
}
```

#### CI/CD Optimized Configuration

```json
{
  "monorepo": {
    "ci": {
      "parallelCatalogProcessing": true,
      "skipInteractivePrompts": true,
      "generateReport": true,
      "reportFormat": "json",
      "exitOnError": true
    },
    "validation": {
      "enforceWorkspaceProtocol": true,
      "validateCatalogCoverage": true,
      "failOnInconsistentVersions": true
    }
  }
}
```
