export const metadata = {
  title: 'Fehlerbehebung',
  description:
    'H√§ufige Probleme und L√∂sungen bei der Verwendung von pnpm-catalog-updates. Fehlermeldungen, Debugging-Tipps und Fehlerbehebungsleitf√§den.',
};

# Fehlerbehebung

H√§ufige Probleme und L√∂sungen, um Ihnen bei der L√∂sung von Problemen mit PCU zu helfen. Finden Sie Antworten auf h√§ufig auftretende Fehler und Debugging-Tipps. {{ className: 'lead' }}

## H√§ufige Fehler

### Workspace nicht gefunden

**Fehlermeldung:**

```
Error: No pnpm workspace found in the current directory
```

**Ursache:** PCU konnte keine `pnpm-workspace.yaml`-Datei finden oder keine g√ºltige pnpm-Workspace-Struktur erkennen.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Workspace initialisieren' }}
# Neuen pnpm-Workspace erstellen
pcu init

# Oder manuell pnpm-workspace.yaml erstellen
echo "packages:
  - 'packages/*'" > pnpm-workspace.yaml
```

```bash {{ title: 'Workspace-Pfad angeben' }}
# PCU aus Workspace-Root ausf√ºhren
cd /pfad/zum/workspace/root
pcu -c

# Oder Workspace-Verzeichnis angeben
pcu -c --workspace /pfad/zum/workspace
```

</CodeGroup>

---

### Keine Katalog-Dependencies

**Fehlermeldung:**

```
No catalog dependencies found in workspace
```

**Ursache:** Ihr Workspace verwendet keine pnpm-Katalog-Dependencies.

**L√∂sungen:**

<CodeGroup>

```yaml {{ title: 'Katalog zu pnpm-workspace.yaml hinzuf√ºgen' }}
packages:
  - 'packages/*'

catalog:
  react: ^18.2.0
  typescript: ^5.0.0
  lodash: ^4.17.21
```

```json {{ title: 'Katalog in package.json verwenden' }}
{
  "name": "my-package",
  "dependencies": {
    "react": "catalog:",
    "typescript": "catalog:",
    "lodash": "catalog:"
  }
}
```

</CodeGroup>

---

### Registry-Zugriffsprobleme

**Fehlermeldung:**

```
Error: getaddrinfo ENOTFOUND registry.npmjs.org
```

**Ursache:** Netzwerk-Konnektivit√§tsprobleme oder Registry-Zugriffsprobleme.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Netzwerk-Fehlerbehebung' }}
# Netzwerk-Konnektivit√§t pr√ºfen
ping registry.npmjs.org

# Mit erh√∂htem Timeout testen
pcu -c --timeout 60000

# Gleichzeitige Requests reduzieren
pcu -c --concurrency 2
```

```ini {{ title: 'Registry konfigurieren (.npmrc)' }}
# Andere Registry verwenden
registry=https://registry.npmjs.org/

# F√ºr Unternehmensnetze
registry=https://your-corporate-registry.com/
strict-ssl=false
```

</CodeGroup>

---

### Authentifizierungsfehler

**Fehlermeldung:**

```
Error: 401 Unauthorized - authentication required
```

**Ursache:** Fehlende oder ung√ºltige Authentifizierungs-Token f√ºr private Registries.

**L√∂sungen:**

<CodeGroup>

```ini {{ title: 'Auth konfigurieren (.npmrc)' }}
@myorg:registry=https://npm.private-registry.com/
//npm.private-registry.com/:_authToken=${NPM_TOKEN}

# Oder Legacy-Auth verwenden
//npm.private-registry.com/:username=myuser
//npm.private-registry.com/:_password=base64password
//npm.private-registry.com/:email=my.email@example.com
```

```bash {{ title: 'Umgebungsvariable setzen' }}
export NPM_TOKEN=your_token_here
pcu -c
```

</CodeGroup>

---

### Konfigurationsdatei-Fehler

**Fehlermeldung:**

```
Error: Invalid configuration in .pcurc.json
```

**Ursache:** Fehlerhaftes JSON oder ung√ºltige Konfigurationsoptionen.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Konfiguration validieren' }}
# JSON-Syntax pr√ºfen
node -e "console.log(JSON.parse(require('fs').readFileSync('.pcurc.json', 'utf8')))"

# Konfiguration neu generieren
mv .pcurc.json .pcurc.json.backup
pcu init --force
```

```json {{ title: 'Minimale g√ºltige Konfiguration' }}
{
  "defaults": {
    "target": "latest"
  },
  "output": {
    "format": "table"
  }
}
```

</CodeGroup>

## Debugging

### Ausf√ºhrliche Protokollierung aktivieren

<CodeGroup>

```bash {{ title: 'Ausf√ºhrliche Ausgabe' }}
# Ausf√ºhrliche Protokollierung aktivieren
pcu -c --verbose

# Debug-Modus mit Umgebungsvariable
DEBUG=pcu:* pcu -c

# Spezifische Debug-Module
DEBUG=pcu:core,pcu:registry pcu -c
```

```bash {{ title: 'Ausgabe in Datei' }}
# Debug-Ausgabe speichern
pcu -c --verbose > debug.log 2>&1

# Log-Datei pr√ºfen
cat debug.log | grep -i error
```

</CodeGroup>

### Workspace-Validierung

<CodeGroup>

```bash {{ title: 'Workspace validieren' }}
# Workspace-Konfiguration pr√ºfen
pcu -s --validate

# Detaillierte Workspace-Infos
pcu -s --stats --verbose
```

```bash {{ title: 'Manuelle Validierung' }}
# Pr√ºfen ob pnpm-workspace.yaml existiert
ls -la pnpm-workspace.yaml

# Katalog-Syntax verifizieren
pnpm exec -- pnpm list --depth=0
```

</CodeGroup>

## Performance-Probleme

### Langsame Netzwerk-Requests

**Symptome:** PCU ben√∂tigt lange Zeit zum Pr√ºfen auf Updates

**L√∂sungen:**

<CodeGroup>

```json {{ title: 'Konfiguration optimieren' }}
{
  "advanced": {
    "concurrency": 3,
    "timeout": 30000,
    "retries": 2,
    "cacheValidityMinutes": 120
  }
}
```

```bash {{ title: 'Cache-Management' }}
# Cache l√∂schen wenn veraltet
rm -rf ~/.pcu/cache

# Cache f√ºr Debugging deaktivieren
pcu -c --no-cache
```

</CodeGroup>

### Hoher Speicherverbrauch

**Symptome:** PCU verbraucht √ºberm√§√üigen Speicher bei gro√üen Workspaces

**L√∂sungen:**

<CodeGroup>

```json {{ title: 'Speicher-Optimierung' }}
{
  "advanced": {
    "concurrency": 2,
    "batchSize": 10
  }
}
```

```bash {{ title: 'Prozess-Management' }}
# Speicherverbrauch √ºberwachen
top -p $(pgrep node)

# Node.js Speicher-Flags verwenden
node --max-old-space-size=4096 $(which pcu) -c
```

</CodeGroup>

## Umgebungsprobleme

### Node.js-Versionskompatibilit√§t

**Fehlermeldung:**

```
Error: Unsupported Node.js version
```

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Version pr√ºfen' }}
node --version  # Sollte >= 18.0.0 sein

# Kompatible Version installieren
nvm install 20
nvm use 20
```

```bash {{ title: 'Node.js aktualisieren' }}
# Mit nvm
nvm install --lts
nvm use --lts

# Installation verifizieren
node --version
npm --version
```

</CodeGroup>

### pnpm-Versionsprobleme

**Fehlermeldung:**

```
Error: pnpm command not found
```

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'pnpm installieren' }}
# Neueste pnpm installieren
npm install -g pnpm@latest

# Installation verifizieren
pnpm --version  # Sollte >= 8.0.0 sein
```

```bash {{ title: 'Alternative Installation' }}
# Mit Corepack (empfohlen)
corepack enable
corepack prepare pnpm@latest --activate

# Direkter Download
curl -fsSL https://get.pnpm.io/install.sh | sh -
```

</CodeGroup>

## Windows-spezifische Probleme

### Pfad-Trennzeichen-Probleme

**Fehlermeldung:**

```
Error: Cannot resolve workspace path
```

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Vorw√§rts-Schr√§gstriche verwenden' }}
# Vorw√§rts-Schr√§gstriche in Pfaden verwenden
pcu -c --workspace ./my/workspace

# Oder PowerShell verwenden
pwsh -c "pcu -c"
```

```json {{ title: 'Windows-Konfiguration' }}
{
  "workspace": {
    "pathSeparator": "/"
  }
}
```

</CodeGroup>

### Berechtigungsfehler

**Fehlermeldung:**

```
Error: EPERM: operation not permitted
```

**L√∂sungen:**

<CodeGroup>

```cmd {{ title: 'Als Administrator ausf√ºhren' }}
# Eingabeaufforderung als Administrator ausf√ºhren
runas /user:Administrator cmd

# Oder PowerShell als Administrator verwenden
Start-Process powershell -Verb RunAs
```

```bash {{ title: 'Berechtigungen reparieren' }}
# npm-Berechtigungen reparieren
npm config set cache ~/.npm-cache
npm config set prefix ~/npm-global
```

</CodeGroup>

## Hilfe erhalten

### Diagnoseinformationen

Beim Melden von Problemen diese Diagnoseinformationen einbeziehen:

<CodeGroup>

```bash {{ title: 'Systeminfo' }}
# PCU-Version
pcu --version

# Node.js- und pnpm-Versionen
node --version
pnpm --version

# Betriebssystem
uname -a  # Linux/macOS
systeminfo  # Windows
```

```bash {{ title: 'Konfigurationsinfo' }}
# Aktuelle Konfiguration anzeigen
cat .pcurc.json

# Workspace-Validierung
pcu -s --validate --verbose

# Debug-Ausgabe
DEBUG=pcu:* pcu -c --verbose
```

</CodeGroup>

### Support-Kan√§le

- üêõ **Bug-Reports**: [GitHub Issues](https://github.com/houko/pnpm-catalog-updates/issues)
- üí¨ **Fragen**: [GitHub Discussions](https://github.com/houko/pnpm-catalog-updates/discussions)
- üìñ **Dokumentation**: √úberpr√ºfen Sie diese Dokumentation f√ºr detaillierte Anleitungen
- üîß **Feature-Requests**: Verwenden Sie GitHub Issues mit dem Enhancement-Label

### Issue-Template

Beim Melden von Bugs bitte einbeziehen:

1. **PCU-Version** und **verwendeter Befehl**
2. **Fehlermeldung** (vollst√§ndige Ausgabe mit `--verbose`)
3. **Umgebung** (OS, Node.js, pnpm-Versionen)
4. **Workspace-Struktur** (pnpm-workspace.yaml, package.json)
5. **Konfiguration** (.pcurc.json, .npmrc falls relevant)
6. **Schritte zur Reproduktion** des Problems
7. **Erwartetes vs. tats√§chliches Verhalten**

## Security Command-Probleme

### Snyk-Integrationsprobleme

**Fehlermeldung:**

```
Error: Snyk CLI not found
```

**Ursache:** Snyk CLI ist nicht installiert, aber `--snyk`-Flag wird verwendet.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Snyk CLI installieren' }}
# Snyk global installieren
npm install -g snyk

# Mit Snyk authentifizieren
snyk auth

# Snyk-Installation testen
snyk --version
```

```bash {{ title: 'Ohne Snyk ausf√ºhren' }}
# Nur npm audit verwenden (Standard)
pcu security

# Snyk explizit deaktivieren
pcu security --no-snyk
```

</CodeGroup>

### Security-Fix-Fehler

**Fehlermeldung:**

```
Error: Unable to automatically fix vulnerabilities
```

**Ursache:** Manche Schwachstellen erfordern manuelle Eingriffe oder Major-Version-Updates.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Manuelle Security-Fixes' }}
# Schwachstellen zuerst √ºberpr√ºfen
pcu security --format json > security.json

# Automatisierte Reparatur versuchen
pcu security --fix-vulns

# Manuelle Paket-Updates bei Bedarf
pcu -u --include "vulnerable-package"
```

```bash {{ title: 'Major-Updates f√ºr Sicherheit erzwingen' }}
# Major-Updates f√ºr Security-Fixes erlauben
pcu security --fix-vulns --allow-major-security

# Auswirkungen vor Anwendung pr√ºfen
pcu -a default vulnerable-package
```

</CodeGroup>

---

### Theme Command-Probleme

**Fehlermeldung:**

```
Error: Theme 'custom-theme' not found
```

**Ursache:** Versuch, ein Theme zu setzen, das nicht existiert.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Verf√ºgbare Themes auflisten' }}
# Alle verf√ºgbaren Themes anzeigen
pcu theme --list

# Interaktive Theme-Auswahl verwenden
pcu theme --interactive
```

```bash {{ title: 'Auf Standard-Theme zur√ºcksetzen' }}
# Auf Standard-Theme zur√ºcksetzen
pcu theme --set default

# Oder Theme-Konfiguration l√∂schen
rm ~/.pcu/theme.json
```

</CodeGroup>

---

### Interaktiver Modus-Probleme

**Fehlermeldung:**

```
Error: Interactive mode not supported in this environment
```

**Ursache:** PCU in einer nicht-interaktiven Umgebung ausf√ºhren (CI, Pipe, etc.).

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Nicht-interaktive Alternativen' }}
# Dry-run verwenden, um √Ñnderungen vorab zu betrachten
pcu -u --dry-run

# Spezifische Ziele anstatt interaktiv verwenden
pcu -u --target minor

# Konfigurationsdatei f√ºr Automatisierung verwenden
pcu -u --config .pcurc.json
```

```bash {{ title: 'Interaktiven Modus erzwingen' }}
# TTY f√ºr interaktiven Modus erzwingen
script -c "pcu -i" /dev/null

# Spezifisches Terminal verwenden
TERM=xterm pcu -i
```

</CodeGroup>

## Befehlsspezifische Probleme

### Analyze Command-Probleme

**Fehlermeldung:**

```
Error: Package 'react' not found in catalog 'nonexistent'
```

**Ursache:** Analyse eines Pakets, das im angegebenen Katalog nicht existiert.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Verf√ºgbare Kataloge pr√ºfen' }}
# Workspace-Kataloge auflisten
pcu workspace --stats

# Pr√ºfen ob Paket im Standard-Katalog existiert
pcu -a default react

# Alle Pakete im Katalog auflisten
pcu -c --catalog specific-catalog
```

```bash {{ title: 'Paketnamen verifizieren' }}
# Nach √§hnlichen Paketnamen suchen
pcu -c --include "*react*"

# Pr√ºfen ob Paket in Registry existiert
npm view react versions --json
```

</CodeGroup>

### Update Command-Fehler

**Fehlermeldung:**

```
Error: Failed to update package.json files
```

**Ursache:** Dateiberechtigungsprobleme oder Workspace-Strukturprobleme.

**L√∂sungen:**

<CodeGroup>

```bash {{ title: 'Berechtigungen pr√ºfen' }}
# Dateiberechtigungen pr√ºfen
ls -la pnpm-workspace.yaml
find packages -name "package.json" -exec ls -la {} \;

# Berechtigungen bei Bedarf reparieren
chmod u+w pnpm-workspace.yaml
chmod u+w packages/*/package.json
```

```bash {{ title: 'Workspace-Validierung' }}
# Workspace zuerst validieren
pcu workspace --validate

# Backup-Flag f√ºr Sicherheit verwenden
pcu -u --create-backup

# Mit Dry-run testen
pcu -u --dry-run
```

</CodeGroup>

## Erweiterte Fehlerbehebung

### Memory Leak-Untersuchung

**Symptome:** PCU-Prozess-Speicher w√§chst kontinuierlich w√§hrend des Betriebs

**Debug-Schritte:**

<CodeGroup>

```bash {{ title: 'Speicher-√úberwachung' }}
# Speicherverbrauch √ºberwachen
watch -n 1 'ps aux | grep pcu'

# Node.js Speicher-Profiling verwenden
node --inspect $(which pcu) -c

# Garbage Collection-Protokollierung aktivieren
node --trace-gc $(which pcu) -c
```

```bash {{ title: 'Gro√üe Workspace-Fehlerbehebung' }}
# In kleineren Batches verarbeiten
pcu -c --batch-size 10

# Concurrency reduzieren
pcu -c --concurrency 1

# Speicher-Optimierung aktivieren
node --optimize-for-size $(which pcu) -c
```

</CodeGroup>

### Registry-Antwort-Probleme

**Symptome:** Inkonsistente Ergebnisse oder Timeout-Fehler

**Debug-Schritte:**

<CodeGroup>

```bash {{ title: 'Registry-Fehlerbehebung' }}
# Registry-Konnektivit√§t testen
curl -I https://registry.npmjs.org/

# Registry-Antwortzeit pr√ºfen
time npm view react versions

# Alternative Registries verwenden
npm config set registry https://registry.npmmirror.com/
```

```bash {{ title: 'Netzwerk-Diagnose' }}
# Netzwerk-Requests verfolgen
DEBUG=pcu:registry pcu -c

# Netzwerk-Aktivit√§t √ºberwachen
netstat -an | grep :443

# Mit verschiedenen Timeouts testen
pcu -c --timeout 5000
pcu -c --timeout 30000
```

</CodeGroup>

### Konfigurationsvererbungs-Probleme

**Symptome:** Konfiguration wird nicht wie erwartet angewendet

**Debug-Schritte:**

<CodeGroup>

```bash {{ title: 'Config-Resolution' }}
# Config-Dateipositionen pr√ºfen
ls -la .pcurc.json
ls -la ~/.pcurc.json
ls -la ~/.config/pcu/config.json

# Config-Laden debuggen
DEBUG=pcu:config pcu -c --verbose

# Effektive Konfiguration anzeigen
pcu config --show-effective
```

```bash {{ title: 'Config-Validierung' }}
# Config-Syntax validieren
node -pe "JSON.parse(require('fs').readFileSync('.pcurc.json'))"

# Mit minimaler Config testen
echo '{"defaults":{"target":"latest"}}' > test.pcurc.json
pcu -c --config test.pcurc.json
```

</CodeGroup>
