export const metadata = {
  title: '例',
  description:
    'pnpm-catalog-updates の実際の例とユースケース。実際のシナリオと一般的なワークフローから学習します。',
};

# 例

PCUを最大限に活用するための実際の例とユースケース。シンプルな更新から複雑なmonorepo管理まで。{{ className: 'lead' }}

## 初心者完全ガイド

### 第一歩：プロジェクト設定の確認

PCUを使い始める前に、プロジェクト構造を確認しましょう：

<CodeGroup>

```bash {{ title: 'プロジェクト構造の確認' }}
# pnpmワークスペースがあることを確認
ls -la | grep -E "(pnpm-workspace|pnpm-lock)"

# 以下が表示されるはずです：
# pnpm-workspace.yaml
# pnpm-lock.yaml
```

```bash {{ title: 'ワークスペース設定の確認' }}
# ワークスペース設定を確認
cat pnpm-workspace.yaml

# 典型的な出力：
# packages:
#   - "apps/*"
#   - "packages/*"
```

</CodeGroup>

まだpnpmワークスペースがない場合、PCUが作成をお手伝いします：

```bash
# 完全なpnpmワークスペースとPCU設定を初期化
pcu init

# PCUが作成するもの：
# ✅ pnpm-workspace.yaml（ワークスペース設定）
# ✅ .pcurc.json（PCU設定ファイル）
# ✅ packages/ディレクトリ（存在しない場合）
```

### 第二歩：初回の依存関係チェック

プロジェクトでどの依存関係が更新可能かを確認しましょう：

<CodeGroup>

```bash {{ title: 'シンプルチェック' }}
# 最もシンプルなチェックコマンド
pcu check

# 以下のようなテーブルが表示されます：
# ┌─────────────────┬─────────┬─────────┬────────────┬──────────┐
# │ Package         │ Current │ Available │ Type       │ Security │
# ├─────────────────┼─────────┼─────────┼────────────┼──────────┤
# │ react           │ 18.2.0  │ 18.3.1  │ minor     │ ✅       │
# │ typescript      │ 5.0.4   │ 5.2.2   │ minor     │ ✅       │
# │ @types/node     │ 18.15.13│ 20.8.4  │ major     │ ✅       │
# └─────────────────┴─────────┴─────────┴────────────┴──────────┘
```

```bash {{ title: '出力の理解' }}
# テーブルの情報を理解しましょう：

# Package：パッケージ名
# Current：現在インストールされているバージョン
# Available：利用可能な新しいバージョン
# Type：更新タイプ
#   - patch：バグ修正（1.0.1 → 1.0.2）
#   - minor：新機能、破壊的変更なし（1.0.0 → 1.1.0）
#   - major：破壊的変更を含む可能性（1.0.0 → 2.0.0）
# Security：セキュリティ問題の有無 ⚠️ = セキュリティ問題あり、✅ = 安全
```

</CodeGroup>

### 第三歩：初回のセキュリティ更新

セキュリティは常に最優先です。まずセキュリティ問題を処理しましょう：

<CodeGroup>

```bash {{ title: 'セキュリティ問題のチェック' }}
# セキュリティ脆弱性を専門的にチェック
pcu security

# 脆弱性がある場合、以下が表示されます：
# 🚨 3個のセキュリティ脆弱性を発見
#
# ┌─────────────┬─────────┬──────────┬─────────────┬────────────┐
# │ Package     │ Severity│ Current  │ Patched     │ Vulnerability│
# ├─────────────┼─────────┼──────────┼─────────────┼────────────┤
# │ lodash      │ High    │ 4.17.20  │ 4.17.21     │ CVE-2021-23337│
# │ node-fetch  │ Moderate│ 2.6.1    │ 2.6.7       │ CVE-2022-0235│
# └─────────────┴─────────┴──────────┴─────────────┴────────────┘
```

```bash {{ title: 'セキュリティ問題の自動修正' }}
# PCUがセキュリティ脆弱性を自動修正
pcu security --fix-vulns

# PCUが行うこと：
# 1. すべての依存関係のセキュリティ脆弱性をスキャン
# 2. 修正バージョンに自動更新
# 3. セキュリティ検証を実行
# ✅ 3個のセキュリティ脆弱性を修正
# ✅ 他にセキュリティ問題なし
```

</CodeGroup>

### 第四歩：初回の依存関係更新

では、いくつかの依存関係を安全に更新しましょう。保守的な方法から始めます：

<CodeGroup>

```bash {{ title: 'インタラクティブ更新（初心者推奨）' }}
# インタラクティブ更新 - どのパッケージを更新するか選択できます
pcu update --interactive

# PCUが選択メニューを表示：
# ? 更新するパッケージを選択：
# ◯ react (18.2.0 → 18.3.1) [minor]
# ◉ typescript (5.0.4 → 5.2.2) [minor]
# ◯ @types/node (18.15.13 → 20.8.4) [major] ⚠️
# ◯ eslint (8.42.0 → 8.50.0) [minor]
#
# 矢印キーで移動、スペースで選択、エンターで確定
```

```bash {{ title: '自動バックアップ作成' }}
# 更新前にPCUがバックアップを作成
pcu update --interactive --create-backup

# PCUが行うこと：
# 1. 更新前に pnpm-workspace.yaml.backup を作成
# 2. 更新するパッケージを選択させる
# 3. 更新を適用
# 4. 更新成功を検証

# 問題が発生した場合、復元できます：
# cp pnpm-workspace.yaml.backup pnpm-workspace.yaml
```

</CodeGroup>

### 第五歩：更新結果の検証

更新後、すべてが正常であることを確認しましょう：

<CodeGroup>

```bash {{ title: 'ワークスペースの検証' }}
# ワークスペース状態をチェック
pcu workspace --validate

# 出力では以下が表示されるはずです：
# ✅ ワークスペース設定が有効
# ✅ すべてのパッケージがレジストリに存在
# ✅ バージョン制約が一致
# ✅ 循環依存なし
```

```bash {{ title: '依存関係の再チェック' }}
# 更新が適用されたことを確認
pcu check

# 更新可能なパッケージが少なくなっているか
# "✅ すべての依存関係が最新" と表示されるはずです
```

</CodeGroup>

### よくある初心者のミスと回避方法

#### ミス1：バックアップなしで更新

**❌ 間違った方法：**

```bash
pcu update --target latest  # 危険！バックアップなし
```

**✅ 正しい方法：**

```bash
pcu update --interactive --create-backup  # 安全！バックアップあり
```

#### ミス2：直接メジャーバージョン更新

**❌ 間違った方法：**

```bash
pcu update --target latest  # 破壊的変更を含む可能性
```

**✅ 正しい方法：**

```bash
# 最初に何が更新されるかチェック
pcu check

# 安全なマイナーバージョンから開始
pcu update --target minor --create-backup

# メジャーバージョン更新は特に注意
pcu update --interactive  # メジャーバージョン更新を手動選択
```

#### ミス3：セキュリティスキャンの無視

**❌ 間違った方法：**

```bash
pcu update  # セキュリティ脆弱性を残すかもしれない
```

**✅ 正しい方法：**

```bash
# 最初にセキュリティ問題を修正
pcu security --fix-vulns

# その後通常の更新を実行
pcu update --target minor
```

### 初心者フレンドリーなワークフロー

このシンプルな日常習慣を身につけましょう：

<CodeGroup>

```bash {{ title: '毎日のチェック（2分）' }}
# 1. 利用可能な更新を素早く確認
pcu check --format minimal

# 2. セキュリティ問題があるかチェック
pcu security

# セキュリティ問題がある場合、すぐに修正：
pcu security --fix-vulns
```

```bash {{ title: '週次更新（10分）' }}
# 1. すべての利用可能な更新をチェック
pcu check

# 2. インタラクティブ更新（バックアップ付き）
pcu update --interactive --create-backup

# 3. すべてが正常であることを検証
pcu workspace --validate

# 4. テストを実行
npm test  # または pnpm test
```

</CodeGroup>

### 実際のシナリオ：初回プロジェクト

初心者の田中さんの初回PCU体験を追ってみましょう：

<CodeGroup>

```bash {{ title: '田中さんのReactプロジェクト' }}
# 田中さんがReactプロジェクトを持っており、依存関係をチェックしてもらいましょう

# 第一歩：プロジェクト構造を確認
ls -la
# pnpm-lock.yaml はあるが pnpm-workspace.yaml がない

# 第二歩：PCUを初期化
pcu init
# ✅ pnpm-workspace.yaml を作成
# ✅ .pcurc.json を作成
# ✅ プロジェクトがカタログ依存関係をサポートしました！
```

```bash {{ title: '初回チェック' }}
# 第三歩：更新可能な依存関係をチェック
pcu check

# 田中さんが見たもの：
# ┌─────────────────┬─────────┬─────────┬────────────┬──────────┐
# │ Package         │ Current │ Available │ Type       │ Security │
# ├─────────────────┼─────────┼─────────┼────────────┼──────────┤
# │ react           │ 18.0.0  │ 18.3.1  │ minor     │ ✅       │
# │ lodash          │ 4.17.20 │ 4.17.21 │ patch     │ ⚠️       │
# │ @types/react    │ 18.0.0  │ 18.2.25 │ minor     │ ✅       │
# └─────────────────┴─────────┴─────────┴────────────┴──────────┘

# lodashにセキュリティ問題があることに注意！
```

```bash {{ title: 'セキュリティ問題の修正' }}
# 第四歩：最初にセキュリティ問題を修正
pcu security --fix-vulns

# ✅ lodashのセキュリティ脆弱性を修正
# lodash 4.17.20 → 4.17.21

# 第五歩：他の依存関係を更新
pcu update --interactive --create-backup

# 田中さんがReactと型定義の更新を選択
# ✅ react 18.0.0 → 18.3.1
# ✅ @types/react 18.0.0 → 18.2.25
```

</CodeGroup>

これで田中さんのプロジェクトは最新で安全になりました！彼が学んだこと：

1. ✅ 常に最初にセキュリティ問題をチェックして修正
2. ✅ インタラクティブモードを使って更新を慎重に選択
3. ✅ 問題に備えてバックアップを常に作成
4. ✅ 更新後のワークスペース状態を検証

## 基本ワークフロー

### 日常的な依存関係チェック

日常的な開発ルーチンの一部として更新をチェック：

<CodeGroup>

```bash {{ title: 'クイックチェック' }}
# シンプルな出力で更新をチェック
pcu -c --format minimal

# 例の出力：
# react           ^18.2.0  →  ^18.3.0
# typescript      ^5.0.0   →  ^5.2.0
# @types/node     ^18.0.0  →  ^20.0.0
```

```bash {{ title: '詳細チェック' }}
# 完全なテーブル形式でチェック
pcu -c

# カラーテーブルを表示、含むもの：
# - パッケージ名
# - 現在のバージョン
# - 利用可能なバージョン
# - 更新タイプ（major/minor/patch）
# - セキュリティインジケーター
```

</CodeGroup>

### バックアップ付きの安全な更新

自動バックアップで依存関係を安全に更新：

```bash
# バックアップ付きインタラクティブ更新
pcu -i -b

# またはバックアップ付き自動マイナー更新
pcu -u --target minor --create-backup
```

### ターゲット指定更新

特定タイプの変更のみを更新：

<CodeGroup>

```bash {{ title: '保守的な更新' }}
# パッチ更新のみ（バグ修正）
pcu -u --target patch

# マイナー更新のみ（新機能、破壊的変更なし）
pcu -u --target minor
```

```bash {{ title: '最新すべて' }}
# 最新バージョンに更新（メジャーバージョン含む）
pcu -u --target latest

# プレリリースバージョンを含む
pcu -u --prerelease
```

</CodeGroup>

## マルチカタログワークスペース

### レガシーサポートシナリオ

一つのワークスペースで複数のReactバージョンを管理：

<CodeGroup>

```yaml {{ title: 'pnpm-workspace.yaml' }}
packages:
  - "apps/*"
  - "packages/*"

catalog:
  # デフォルトカタログ - 最新バージョン
  react: ^18.2.0
  react-dom: ^18.2.0
  @types/react: ^18.2.0

catalogs:
  # レガシーサポート
  react17:
    react: ^17.0.2
    react-dom: ^17.0.2
    @types/react: ^17.0.62

  # ベータテスト
  react-next:
    react: ^19.0.0-beta
    react-dom: ^19.0.0-beta
```

```bash {{ title: 'カタログ固有の更新' }}
# デフォルトカタログのみ更新
pcu -u --catalog default

# レガシーReactバージョンを更新
pcu -u --catalog react17 --target minor

# ベータバージョンをチェック
pcu -c --catalog react-next --prerelease
```

</CodeGroup>

### パッケージ使用

```json {{ title: 'package.json' }}
{
  "name": "@myorg/modern-app",
  "dependencies": {
    "react": "catalog:",
    "react-dom": "catalog:"
  }
}
```

```json {{ title: 'レガシー package.json' }}
{
  "name": "@myorg/legacy-app",
  "dependencies": {
    "react": "catalog:react17",
    "react-dom": "catalog:react17"
  }
}
```

## 設定例

### React エコシステム管理

Reactと関連パッケージの協調更新：

```json {{ title: '.pcurc.json' }}
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": [
        "@types/react",
        "@types/react-dom",
        "react-router-dom",
        "@testing-library/react"
      ]
    }
  ],
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true
  }
}
```

### TypeScript プロジェクト設定

保守的なTypeScript更新と自動型定義：

```json {{ title: '.pcurc.json' }}
{
  "packageRules": [
    {
      "patterns": ["typescript"],
      "target": "minor",
      "requireConfirmation": true
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    },
    {
      "patterns": ["eslint*", "@typescript-eslint/*"],
      "target": "minor",
      "groupUpdate": true
    }
  ]
}
```

### 企業設定

厳格な管理を持つ企業レベル設定：

```json {{ title: '.pcurc.json' }}
{
  "defaults": {
    "target": "minor",
    "createBackup": true
  },
  "exclude": ["typescript", "@types/node", "react", "react-dom"],
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true,
    "notifyOnSecurityUpdate": true
  },
  "advanced": {
    "concurrency": 3,
    "timeout": 60000,
    "retries": 5
  },
  "ui": {
    "theme": "minimal",
    "animations": false
  }
}
```

## CI/CD 統合

### GitHub Actions

CI パイプラインで依存関係チェックを自動化：

<CodeGroup>

```yaml {{ title: '.github/workflows/dependencies.yml' }}
name: Check Dependencies

on:
  schedule:
    - cron: '0 9 * * MON'  # 毎週月曜日午前9時
  workflow_dispatch:

jobs:
  check-deps:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install PCU
        run: npm install -g pcu

      - name: Check for updates
        run: pcu -c --format json > updates.json

      - name: Create Issue if Updates Available
        if: success()
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const updates = JSON.parse(fs.readFileSync('updates.json', 'utf8'));
            if (updates.length > 0) {
              github.rest.issues.create({
                owner: context.repo.owner,
                repo: context.repo.repo,
                title: 'Dependencies Update Available',
                body: `Found ${updates.length} packages that can be updated:

` +
                      updates.map(u => `- ${u.package}: ${u.current} → ${u.available}`).join('
')
              });
            }
```

```bash {{ title: 'Package.json スクリプト' }}
# package.json に追加
{
  "scripts": {
    "deps:check": "pcu -c",
    "deps:update": "pcu -i -b",
    "deps:update-minor": "pcu -u --target minor --create-backup",
    "deps:analyze": "pcu -a default"
  }
}
```

</CodeGroup>

## エラーハンドリングとトラブルシューティング

### ネットワーク問題

ネットワーク問題とレジストリアクセスの処理：

```bash
# 遅い接続でタイムアウトを増加
pcu -c --timeout 60000

# 不安定なネットワークで並行性を減少
pcu -u --concurrency 2
```

### ワークスペース検証

ワークスペース設定を検証：

```bash
# ワークスペース設定をチェック
pcu -s --validate

# 詳細なワークスペース情報を取得
pcu -s --stats --verbose
```

### プライベートレジストリ

PCU は `.npmrc` と `.pnpmrc` 設定を自動的に読み取ります：

<CodeGroup>

```ini {{ title: '.npmrc' }}
@myorg:registry=https://npm.private-registry.com/
//npm.private-registry.com/:_authToken=${NPM_TOKEN}

registry=https://registry.npmjs.org/
```

```bash {{ title: '使用方法' }}
# PCU はレジストリ設定を自動的に使用
pcu -c

# プライベートレジストリからのパッケージをチェック
pcu -c --include "@myorg/*"
```

</CodeGroup>

## 高度なユースケース

### 影響分析

特定パッケージ更新の影響を分析：

```bash
# React 更新の影響を分析
pcu -a default react

# 特定バージョンで分析
pcu -a default react 18.3.0

# すべてのカタログでの影響をチェック
pcu -a react17 react 17.0.3
```

### 選択的更新

特定のパッケージやパターンのみを更新：

```bash
# React 関連パッケージのみ更新
pcu -u --include "react*"

# コアフレームワーク以外すべてを更新
pcu -u --exclude "react*,vue*,angular*"

# 型定義のみ更新
pcu -u --include "@types/*" --target latest
```

### ドライラン分析

適用前に変更をプレビュー：

```bash
# 何が更新されるかを確認
pcu -u --dry-run --verbose

# 特定ターゲットをプレビュー
pcu -u --dry-run --target minor --include "@types/*"
```

## ベストプラクティス

### 日常ワークフロー

1. **朝のチェック**：`pcu -c` で利用可能な更新を確認
2. **影響レビュー**：重要な更新には `pcu -a` を使用
3. **安全な更新**：バックアップ付きインタラクティブ更新 `pcu -i -b` を使用
4. **テスト**：更新後にテストスイートを実行
5. **コミット**：依存関係更新を個別にコミット

### チームワークフロー

1. **設定共有**：`.pcurc.json` をバージョン管理にコミット
2. **定期レビュー**：週次依存関係レビューミーティングをスケジュール
3. **セキュリティ優先**：セキュリティ更新を常に優先
4. **文書化**：主要な依存関係決定を文書化
5. **ロールバック計画**：簡単なロールバックのためにバックアップを保持

### リリースワークフロー

1. **プレリリースチェック**：リリース前に `pcu -c --target patch`
2. **セキュリティスキャン**：CI で `autoFixVulnerabilities` を有効化
3. **バージョン固定**：本番リリースでは正確なバージョンを使用
4. **更新計画**：リリース間で依存関係更新を計画

## セキュリティモニタリング

### 継続的セキュリティスキャン

開発ワークフローにセキュリティスキャンを統合：

<CodeGroup>

```bash {{ title: '日常セキュリティチェック' }}
# クイックセキュリティスキャン
pcu security

# 脆弱性を自動修正
pcu security --fix-vulns

# 高および重要な問題のみに焦点
pcu security --severity high --fix-vulns
```

```bash {{ title: '包括的セキュリティ監査' }}
# Snyk統合による完全なセキュリティスキャン
pcu security --snyk --include-dev --verbose

# レビュー用セキュリティレポートを出力
pcu security --format json --snyk > security-report.json
```

</CodeGroup>

### セキュリティ指向の CI/CD

```yaml {{ title: '.github/workflows/security.yml' }}
name: Security Audit

on:
  schedule:
    - cron: '0 2 * * *' # 毎日午前2時
  pull_request:
    branches: [main]

jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install PCU
        run: npm install -g pcu

      - name: Security Scan
        run: pcu security --fix-vulns --format json > security-results.json

      - name: Upload Security Report
        uses: actions/upload-artifact@v4
        with:
          name: security-report
          path: security-results.json
```

## テーマカスタマイズ

### インタラクティブテーマ設定

チーム用PCUの外観を設定：

```bash
# インタラクティブテーマウィザードを開始
pcu theme --interactive

# 特定テーマを設定
pcu theme --set modern

# すべての利用可能テーマとプレビューをリスト
pcu theme --list
```

### チームテーマ設定

```json {{ title: '.pcurc.json' }}
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "animations": true,
    "colorScheme": "auto"
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  }
}
```

## パフォーマンス最適化

### 大規模 Monorepo 設定

数百のパッケージを含む大規模ワークスペース用の最適化設定：

```json {{ title: '.pcurc.json' }}
{
  "advanced": {
    "concurrency": 15,
    "timeout": 120000,
    "retries": 5,
    "batchSize": 100
  },
  "cache": {
    "enabled": true,
    "ttl": 7200000,
    "maxSize": 104857600,
    "persistToDisk": true
  },
  "monorepo": {
    "performance": {
      "cacheWorkspaceStructure": true,
      "parallelCatalogProcessing": true,
      "streamingMode": true
    }
  }
}
```

### 並列処理戦略

```bash
# 高並行性更新（大規模プロジェクト向け）
pcu -u --concurrency 20 --timeout 180000

# バッチ処理モード
pcu -u --batch-size 50 --progress-style fancy
```

## 移行例

### npm-check-updates からの移行

`ncu` から PCU への移行：

<CodeGroup>

```bash {{ title: 'ncu 等価コマンド' }}
# ncu コマンド
ncu

# PCU 等価コマンド
pcu -c
```

```bash {{ title: 'ncu 更新コマンド' }}
# ncu 更新
ncu -u

# PCU 等価コマンド
pcu -u --target latest
```

</CodeGroup>

### レガシー依存関係管理からの移行

既存プロジェクトを pnpm カタログシステムに移行：

```bash
# ステップ1：既存依存関係を分析
pcu migrate --analyze

# ステップ2：カタログ設定を作成
pcu migrate --create-catalogs

# ステップ3：package.json を変換
pcu migrate --convert-packages

# ステップ4：移行を検証
pcu analyze --validate-migration
```

## 移行ガイド

### npm/yarn ワークスペースからの移行

完全な移行プロセス：

<CodeGroup>

```bash {{ title: '移行準備' }}
# 既存設定をバックアップ
cp package.json package.json.backup
cp package-lock.json package-lock.json.backup 2>/dev/null || true
cp yarn.lock yarn.lock.backup 2>/dev/null || true

# プロジェクト構造を分析
pcu migrate --dry-run --verbose
```

```bash {{ title: '移行実行' }}
# pnpm ワークスペースに変換
pcu migrate --to-pnpm-workspace

# カタログ設定を生成
pcu migrate --generate-catalogs --strategy conservative

# 移行結果を検証
pcu analyze --migration-report
```

</CodeGroup>

### 段階的採用戦略

```json {{ title: 'フェーズ1：基本設定' }}
{
  "defaults": {
    "target": "patch"
  },
  "exclude": ["react", "react-dom", "typescript"]
}
```

```json {{ title: 'フェーズ2：カバレッジ拡張' }}
{
  "defaults": {
    "target": "minor"
  },
  "packageRules": [
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    }
  ]
}
```

## CI/CD ワークフロー統合

### マルチ環境デプロイメント

異なる環境向けの完全な CI/CD ワークフロー：

```yaml {{ title: '.github/workflows/deploy.yml' }}
name: Multi-Environment Deployment

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

env:
  PCU_WORKSPACE: ./

jobs:
  dependency-check:
    runs-on: ubuntu-latest
    outputs:
      has-updates: ${{ steps.check.outputs.has-updates }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install PCU
        run: npm install -g pcu

      - name: Check Dependencies
        id: check
        run: |
          pcu -c --format json > updates.json
          if [ -s updates.json ]; then
            echo "has-updates=true" >> $GITHUB_OUTPUT
          else
            echo "has-updates=false" >> $GITHUB_OUTPUT
          fi

  update-dependencies:
    needs: dependency-check
    if: needs.dependency-check.outputs.has-updates == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Create Update PR
        run: |
          pcu -u --target minor --create-backup
          # PR作成ロジック...

  deploy-staging:
    if: github.ref == 'refs/heads/develop'
    runs-on: ubuntu-latest
    environment: staging
    steps:
      - uses: actions/checkout@v4
      - name: Deploy to Staging
        run: |
          pcu security --fix-vulns
          # デプロイロジック...

  deploy-production:
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    environment: production
    needs: [dependency-check]
    steps:
      - uses: actions/checkout@v4
      - name: Production Security Check
        run: |
          pcu security --severity critical --format json
          # デプロイロジック...
```

## 企業ワークフロー

### コンプライアンスと監査

企業レベルのコンプライアンスワークフロー：

```json {{ title: '.pcurc.json - 企業設定' }}
{
  "enterprise": {
    "compliance": {
      "requireApproval": ["major"],
      "auditTrail": true,
      "licenseCheck": true,
      "securityScan": "mandatory"
    },
    "approval": {
      "majorUpdates": {
        "approvers": ["security-team", "tech-lead"],
        "timeout": "7d"
      }
    }
  },
  "logging": {
    "level": "info",
    "file": "./logs/pcu-audit.log",
    "includeUserInfo": true
  }
}
```

### マルチチーム協力

```bash
# チームA：フロントエンドチーム
pcu -u --workspace-filter "@frontend/*" --target minor

# チームB：バックエンドチーム
pcu -u --workspace-filter "@backend/*" --target patch

# チームC：共有ライブラリチーム
pcu -u --workspace-filter "@shared/*" --target latest
```

### 企業セキュリティポリシー

```json {{ title: 'セキュリティポリシー設定' }}
{
  "security": {
    "policy": {
      "allowedLicenses": ["MIT", "Apache-2.0", "BSD-3-Clause"],
      "blockedPackages": ["unsafe-package"],
      "maxAge": "90d",
      "severityThreshold": "moderate"
    },
    "scanning": {
      "schedule": "daily",
      "integrations": ["snyk", "whitesource"],
      "notifications": {
        "slack": "#security-alerts",
        "email": ["security@company.com"]
      }
    }
  }
}
```

### リリース管理

企業レベルのリリースパイプライン統合：

```bash
# プレリリース依存関係チェック
pcu enterprise --pre-release-check

# 依存関係凍結
pcu enterprise --freeze-deps --release v2.1.0

# ポストリリース依存関係解凍
pcu enterprise --unfreeze-deps --post-release

# コンプライアンスレポート生成
pcu enterprise --compliance-report --format pdf
```
