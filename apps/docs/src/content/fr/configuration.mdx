export const metadata = {
  title: 'Configuration',
  description:
    'Apprenez comment configurer pnpm-catalog-updates pour votre flux de travail avec les param√®tres .pcurc.json, les r√®gles de packages et les options avanc√©es.',
};

# Configuration

Configurez PCU pour correspondre √† votre flux de travail et aux besoins de votre projet. Apprenez les fichiers de configuration, les r√®gles sp√©cifiques aux packages et les param√®tres avanc√©s. {{ className: 'lead' }}

## Types de fichiers de configuration

PCU prend en charge plusieurs formats et emplacements de fichiers de configuration pour s'adapter aux diff√©rents flux de travail de d√©veloppement.

### Fichiers de configuration pris en charge

PCU recherche les fichiers de configuration dans l'ordre suivant (le premier trouv√© l'emporte) :

<Properties>
  <Property name=".pcurc.json" type="JSON">
    Fichier de configuration JSON principal dans la racine du projet
  </Property>
  <Property name=".pcurc.js" type="JavaScript">
    Fichier de configuration JavaScript avec support de configuration dynamique
  </Property>
  <Property name="pcu.config.js" type="JavaScript">
    Nom de fichier de configuration JavaScript alternatif
  </Property>
  <Property name="~/.pcurc.json" type="JSON">
    Configuration utilisateur globale dans le r√©pertoire home
  </Property>
  <Property name="package.json" type="JSON">
    Configuration dans package.json sous la cl√© "pcu"
  </Property>
</Properties>

### Support de configuration JavaScript

Les fichiers de configuration JavaScript permettent une configuration dynamique bas√©e sur l'environnement, la structure de l'espace de travail ou d'autres conditions d'ex√©cution :

<CodeGroup>

```javascript {{ title: '.pcurc.js' }}
module.exports = {
  defaults: {
    target: process.env.NODE_ENV === 'production' ? 'minor' : 'latest',
    createBackup: true,
  },
  workspace: {
    autoDiscover: true,
    catalogMode: 'strict',
  },
  // R√®gles de package dynamiques bas√©es sur la structure de l'espace de travail
  packageRules: [
    {
      patterns: ['react*'],
      target: 'minor',
      requireConfirmation: process.env.CI !== 'true',
    },
  ],
  // Configuration sp√©cifique √† l'environnement
  ...(process.env.NODE_ENV === 'development' && {
    ui: {
      theme: 'modern',
      progressBarStyle: 'fancy',
    },
  }),
};
```

```javascript {{ title: 'pcu.config.js avec Fonctions' }}
const fs = require('fs');
const path = require('path');

function getWorkspacePackages() {
  const workspaceFile = path.join(__dirname, 'pnpm-workspace.yaml');
  if (fs.existsSync(workspaceFile)) {
    // Analyser les packages de l'espace de travail de mani√®re dynamique
    return ['packages/*', 'apps/*', 'tools/*'];
  }
  return ['packages/*'];
}

module.exports = {
  workspace: {
    packages: getWorkspacePackages(),
    catalogMode: 'flexible',
  },
  packageRules: [
    // G√©n√©rer des r√®gles bas√©es sur les packages existants
    ...fs.readdirSync('./packages').map((pkg) => ({
      patterns: [`@myorg/${pkg}`],
      target: 'minor',
    })),
  ],
};
```

</CodeGroup>

### Configuration package.json

Pour des projets plus simples, la configuration peut √™tre int√©gr√©e dans package.json :

```json
{
  "name": "my-project",
  "pcu": {
    "defaults": {
      "target": "minor",
      "createBackup": true
    },
    "packageRules": [
      {
        "patterns": ["@types/*"],
        "target": "latest",
        "autoUpdate": true
      }
    ]
  }
}
```

### Validation de configuration

PCU valide automatiquement les fichiers de configuration et fournit des messages d'erreur d√©taill√©s pour les probl√®mes courants :

#### Fonctionnalit√©s de validation

- **Validation de sch√©ma JSON** : Assure que toutes les propri√©t√©s de configuration sont valides
- **Validation de motifs** : Valide les motifs glob et les formats de noms de packages
- **V√©rification de type** : V√©rifie les types de donn√©es corrects pour toutes les valeurs de configuration
- **D√©tection de conflits** : Identifie les r√®gles conflictuelles et les options de configuration
- **Syst√®me de suggestions** : Fournit des suggestions utiles pour corriger les erreurs de configuration

#### Exemples de validation

```bash
# Valider la configuration actuelle
pcu workspace --validate

# Erreurs de validation courantes avec suggestions :
# ‚ùå Cible invalide "lastest" dans packageRules[0]
#    üí° Vouliez-vous dire "latest" ?
#
# ‚ùå Le motif "react+" est une syntaxe glob invalide
#    üí° Utilisez "react*" pour faire correspondre les packages commen√ßant par "react"
#
# ‚ö†Ô∏è  R√®gles conflictuelles pour le package "react"
#    üìù Les r√®gles aux indices 0 et 2 correspondent toutes les deux √† ce package
```

## R√©f√©rence compl√®te du fichier de configuration .pcurc.json

PCU utilise principalement le fichier `.pcurc.json` dans la racine du projet pour la configuration. Il peut √™tre cr√©√© manuellement ou g√©n√©r√© avec la configuration par d√©faut en utilisant `pcu init`.

### Structure compl√®te du fichier de configuration

<CodeGroup>

```json {{ title: 'Exemple de configuration compl√®te' }}
{
  "defaults": {
    "target": "latest",
    "timeout": 30000,
    "createBackup": false,
    "interactive": false,
    "dryRun": false,
    "force": false,
    "prerelease": false
  },
  "workspace": {
    "autoDiscover": true,
    "catalogMode": "strict",
    "path": "./",
    "packages": ["packages/*", "apps/*"]
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  },
  "ui": {
    "theme": "default",
    "progressBars": true,
    "progressBarStyle": "default",
    "animations": true,
    "colorScheme": "auto"
  },
  "update": {
    "interactive": false,
    "dryRunFirst": false,
    "skipPrereleases": true,
    "confirmMajorUpdates": true,
    "batchSize": 10
  },
  "security": {
    "autoFixVulnerabilities": false,
    "allowMajorForSecurity": false,
    "notifyOnSecurityUpdate": true,
    "severityThreshold": "moderate"
  },
  "advanced": {
    "concurrency": 5,
    "timeout": 30000,
    "retries": 3,
    "cacheValidityMinutes": 60,
    "checkForUpdates": true,
    "batchSize": 50
  },
  "cache": {
    "enabled": true,
    "ttl": 3600000,
    "maxSize": 52428800,
    "maxEntries": 10000,
    "persistToDisk": true,
    "cacheDir": "~/.pcu/cache"
  },
  "registry": {
    "default": "https://registry.npmjs.org/",
    "timeout": 30000,
    "retries": 3
  },
  "include": ["*"],
  "exclude": [],
  "packageRules": [
    {
      "patterns": ["react*"],
      "target": "minor",
      "requireConfirmation": true
    }
  ],
  "notification": {
    "enabled": true,
    "updateAvailable": true,
    "securityAlerts": true
  },
  "logging": {
    "level": "info",
    "file": "./pcu.log",
    "maxFiles": 5,
    "maxSize": "10MB"
  }
}
```

```json {{ title: 'Exemple de configuration minimale' }}
{
  "defaults": {
    "target": "minor"
  },
  "exclude": ["typescript", "@types/node"]
}
```

</CodeGroup>

### Description d√©taill√©e des options de configuration

#### defaults - Param√®tres par d√©faut

<Properties>
  <Property name="target" type="enum" default="latest">
    Cible de mise √† jour par d√©faut : `latest` | `greatest` | `minor` | `patch` | `newest`
  </Property>
  <Property name="timeout" type="number" default="30000">
    D√©lai d'expiration des requ√™tes r√©seau (millisecondes)
  </Property>
  <Property name="createBackup" type="boolean" default="false">
    Cr√©er des fichiers de sauvegarde avant la mise √† jour
  </Property>
  <Property name="interactive" type="boolean" default="false">
    Activer le mode interactif par d√©faut
  </Property>
  <Property name="dryRun" type="boolean" default="false">
    Activer le mode aper√ßu par d√©faut (pas de mise √† jour r√©elle)
  </Property>
  <Property name="force" type="boolean" default="false">
    Forcer les mises √† jour (ignorer les avertissements)
  </Property>
  <Property name="prerelease" type="boolean" default="false">
    Inclure les versions pr√©liminaires
  </Property>
</Properties>

#### workspace - Param√®tres de l'espace de travail

<Properties>
  <Property name="autoDiscover" type="boolean" default="true">
    D√©couvrir automatiquement la structure de l'espace de travail
  </Property>
  <Property name="catalogMode" type="enum" default="strict">
    Mode de catalogue : `strict` | `loose` | `mixed`
  </Property>
  <Property name="path" type="string" default="./">
    Chemin du r√©pertoire racine de l'espace de travail
  </Property>
  <Property name="packages" type="string[]">
    Tableau de motifs de correspondance des r√©pertoires de packages (remplace pnpm-workspace.yaml)
  </Property>
</Properties>

#### output - Param√®tres de sortie

<Properties>
  <Property name="format" type="enum" default="table">
    Format de sortie : `table` | `json` | `yaml` | `minimal`
  </Property>
  <Property name="color" type="boolean" default="true">
    Activer la sortie color√©e
  </Property>
  <Property name="verbose" type="boolean" default="false">
    Activer le mode de sortie d√©taill√©e
  </Property>
</Properties>

#### ui - Param√®tres de l'interface utilisateur

<Properties>
  <Property name="theme" type="enum" default="default">
    Th√®me de couleur : `default` | `modern` | `minimal` | `neon`
  </Property>
  <Property name="progressBars" type="boolean" default="true">
    Afficher les barres de progression
  </Property>
  <Property name="progressBarStyle" type="enum" default="default">
    Style de barre de progression : `default` | `gradient` | `fancy` | `minimal` | `rainbow` |
    `neon`
  </Property>
  <Property name="animations" type="boolean" default="true">
    Activer les effets d'animation
  </Property>
  <Property name="colorScheme" type="enum" default="auto">
    Sch√©ma de couleurs : `auto` | `light` | `dark`
  </Property>
</Properties>

#### update - Param√®tres de comportement de mise √† jour

<Properties>
  <Property name="interactive" type="boolean" default="false">
    Activer le mode interactif par d√©faut lors de la mise √† jour
  </Property>
  <Property name="dryRunFirst" type="boolean" default="false">
    Ex√©cuter d'abord un aper√ßu, puis demander si appliquer
  </Property>
  <Property name="skipPrereleases" type="boolean" default="true">
    Ignorer les versions pr√©liminaires
  </Property>
  <Property name="confirmMajorUpdates" type="boolean" default="true">
    Les mises √† jour de version majeure n√©cessitent une confirmation
  </Property>
  <Property name="batchSize" type="number" default="10">
    Nombre de packages trait√©s par lot
  </Property>
</Properties>

#### security - Param√®tres de s√©curit√©

<Properties>
  <Property name="autoFixVulnerabilities" type="boolean" default="false">
    Corriger automatiquement les vuln√©rabilit√©s de s√©curit√©
  </Property>
  <Property name="allowMajorForSecurity" type="boolean" default="false">
    Autoriser les mises √† jour de version majeure pour les corrections de s√©curit√©
  </Property>
  <Property name="notifyOnSecurityUpdate" type="boolean" default="true">
    Notifier lors des mises √† jour de s√©curit√©
  </Property>
  <Property name="severityThreshold" type="enum" default="moderate">
    Seuil de niveau d'alerte de s√©curit√© : `low` | `moderate` | `high` | `critical`
  </Property>
</Properties>

#### advanced - Param√®tres avanc√©s

<Properties>
  <Property name="concurrency" type="number" default="5">
    Nombre de requ√™tes r√©seau simultan√©es
  </Property>
  <Property name="timeout" type="number" default="30000">
    D√©lai d'expiration des requ√™tes r√©seau (millisecondes)
  </Property>
  <Property name="retries" type="number" default="3">
    Nombre de tentatives en cas d'√©chec
  </Property>
  <Property name="cacheValidityMinutes" type="number" default="60">
    P√©riode de validit√© du cache (minutes, 0 pour d√©sactiver le cache)
  </Property>
  <Property name="checkForUpdates" type="boolean" default="true">
    V√©rifier les mises √† jour de l'outil PCU au d√©marrage
  </Property>
  <Property name="batchSize" type="number" default="50">
    Nombre maximum de packages trait√©s par lot
  </Property>
</Properties>

#### cache - Param√®tres de cache

<Properties>
  <Property name="enabled" type="boolean" default="true">
    Activer le syst√®me de cache
  </Property>
  <Property name="ttl" type="number" default="3600000">
    Dur√©e de vie du cache (millisecondes)
  </Property>
  <Property name="maxSize" type="number" default="52428800">
    Taille maximale du cache (octets, 50MB par d√©faut)
  </Property>
  <Property name="maxEntries" type="number" default="10000">
    Nombre maximum d'entr√©es de cache
  </Property>
  <Property name="persistToDisk" type="boolean" default="true">
    Persister le cache sur le disque
  </Property>
  <Property name="cacheDir" type="string" default="~/.pcu/cache">
    Chemin du r√©pertoire de cache
  </Property>
</Properties>

#### registry - Param√®tres de registre

<Properties>
  <Property name="default" type="string" default="https://registry.npmjs.org/">
    URL du registre NPM par d√©faut
  </Property>
  <Property name="timeout" type="number" default="30000">
    D√©lai d'expiration des requ√™tes de registre (millisecondes)
  </Property>
  <Property name="retries" type="number" default="3">
    Nombre de tentatives de requ√™te de registre
  </Property>
</Properties>

#### Param√®tres de filtrage de packages

<Properties>
  <Property name="include" type="string[]" default="['*']">
    Tableau de motifs de correspondance de noms de packages √† inclure
  </Property>
  <Property name="exclude" type="string[]" default="[]">
    Tableau de motifs de correspondance de noms de packages √† exclure
  </Property>
</Properties>

#### notification - Param√®tres de notification

<Properties>
  <Property name="enabled" type="boolean" default="true">
    Activer la fonction de notification
  </Property>
  <Property name="updateAvailable" type="boolean" default="true">
    Notifier lorsque des mises √† jour sont disponibles
  </Property>
  <Property name="securityAlerts" type="boolean" default="true">
    Notifier lors d'alertes de s√©curit√©
  </Property>
</Properties>

#### logging - Param√®tres de journalisation

<Properties>
  <Property name="level" type="enum" default="info">
    Niveau de journalisation : `error` | `warn` | `info` | `debug` | `trace`
  </Property>
  <Property name="file" type="string">
    Chemin du fichier de journal (optionnel)
  </Property>
  <Property name="maxFiles" type="number" default="5">
    Nombre maximum de fichiers de journal
  </Property>
  <Property name="maxSize" type="string" default="10MB">
    Taille maximale d'un seul fichier de journal
  </Property>
</Properties>

## Filtrage de packages

Contr√¥lez quels packages mettre √† jour avec des motifs d'inclusion/exclusion et des r√®gles sp√©cifiques aux packages.

<CodeGroup>

```json {{ title: 'Filtrage simple' }}
{
  "exclude": ["typescript", "@types/node", "react", "react-dom"],
  "include": ["lodash*", "chalk", "commander"]
}
```

```json {{ title: 'R√®gles de packages' }}
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": ["@types/react", "@types/react-dom"]
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    },
    {
      "patterns": ["eslint*", "prettier"],
      "target": "minor",
      "groupUpdate": true
    }
  ]
}
```

</CodeGroup>

### Propri√©t√©s des r√®gles de packages

<Properties>
  <Property name="patterns" type="string[]" required>
    Motifs glob pour faire correspondre les noms de packages
  </Property>
  <Property name="target" type="enum">
    Cible de mise √† jour : latest, greatest, minor, patch, newest
  </Property>
  <Property name="requireConfirmation" type="boolean">
    Toujours demander avant de mettre √† jour ces packages
  </Property>
  <Property name="autoUpdate" type="boolean">
    Mettre √† jour automatiquement sans confirmation
  </Property>
  <Property name="relatedPackages" type="string[]">
    Packages qui suivent la m√™me strat√©gie de mise √† jour
  </Property>
  <Property name="groupUpdate" type="boolean">
    Mettre √† jour les packages li√©s ensemble
  </Property>
</Properties>

## Configuration de s√©curit√©

Configurez l'analyse des vuln√©rabilit√©s de s√©curit√© et les corrections automatiques.

```json
{
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true,
    "notifyOnSecurityUpdate": true
  }
}
```

<Properties>
  <Property name="autoFixVulnerabilities" type="boolean">
    V√©rifier et corriger automatiquement les vuln√©rabilit√©s de s√©curit√©
  </Property>
  <Property name="allowMajorForSecurity" type="boolean">
    Autoriser les mises √† jour de version majeure pour les corrections de s√©curit√©
  </Property>
  <Property name="notifyOnSecurityUpdate" type="boolean">
    Afficher les notifications lors des mises √† jour de s√©curit√©
  </Property>
</Properties>

## Configuration Monorepo

Param√®tres sp√©ciaux pour les configurations monorepo complexes avec plusieurs catalogues.

```json
{
  "monorepo": {
    "syncVersions": ["react", "react-dom"],
    "catalogPriority": ["default", "latest", "react17"]
  }
}
```

<Properties>
  <Property name="syncVersions" type="string[]">
    Packages qui n√©cessitent une synchronisation de version entre plusieurs catalogues
  </Property>
  <Property name="catalogPriority" type="string[]">
    Ordre de priorit√© des catalogues pour la r√©solution de conflits
  </Property>
</Properties>

## Param√®tres avanc√©s

Affinez les performances et le comportement avec des options de configuration avanc√©es.

```json
{
  "advanced": {
    "concurrency": 5,
    "timeout": 30000,
    "retries": 3,
    "cacheValidityMinutes": 60,
    "checkForUpdates": true
  }
}
```

<Properties>
  <Property name="concurrency" type="number" default="5">
    Nombre de requ√™tes r√©seau simultan√©es
  </Property>
  <Property name="timeout" type="number" default="30000">
    D√©lai d'expiration des requ√™tes r√©seau en millisecondes
  </Property>
  <Property name="retries" type="number" default="3">
    Nombre de tentatives en cas d'√©chec
  </Property>
  <Property name="cacheValidityMinutes" type="number" default="60">
    P√©riode de validit√© du cache (0 pour d√©sactiver le cache)
  </Property>
  <Property name="checkForUpdates" type="boolean" default="true">
    V√©rifier automatiquement les mises √† jour de l'outil PCU au d√©marrage. Ignor√© dans les
    environnements CI. Affiche les notifications de mise √† jour et les instructions d'installation
    lorsque de nouvelles versions sont disponibles.
  </Property>
</Properties>

## Configuration de l'interface utilisateur

Personnalisez l'apparence visuelle et les param√®tres de l'interface utilisateur.

```json
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "progressBarStyle": "gradient",
    "animations": true
  },
  "output": {
    "format": "table",
    "color": true,
    "verbose": false
  }
}
```

### Th√®mes disponibles

- `default` - Couleurs √©quilibr√©es pour usage g√©n√©ral
- `modern` - Couleurs vives pour les environnements de d√©veloppement
- `minimal` - Propre et simple pour les environnements de production
- `neon` - Couleurs √† contraste √©lev√© pour les pr√©sentations

### Styles de barres de progression

PCU prend en charge 6 styles diff√©rents de barres de progression pour un retour visuel am√©lior√© pendant les op√©rations :

- `default` - Barre de progression standard avec style de base
- `gradient` - Barre de progression color√©e en d√©grad√© pour une apparence moderne
- `fancy` - Barre de progression am√©lior√©e avec des √©l√©ments d√©coratifs
- `minimal` - Indicateur de progression propre et simple
- `rainbow` - Barre de progression multicolore pour des affichages vibrants
- `neon` - Barre de progression √† contraste √©lev√© correspondant au th√®me neon

**Exemple de configuration :**

```json
{
  "ui": {
    "theme": "modern",
    "progressBars": true,
    "progressBarStyle": "gradient"
  }
}
```

**Utilisation en ligne de commande :**

```bash
pcu check --progress-style fancy
pcu update --progress-style rainbow
pcu security --progress-style neon
```

## Priorit√© de configuration

Les param√®tres de configuration sont appliqu√©s dans cet ordre de priorit√© :

1. **Drapeaux de ligne de commande** (priorit√© la plus √©lev√©e)
2. **R√®gles sp√©cifiques aux packages** dans `.pcurc.json`
3. **Param√®tres g√©n√©raux** dans `.pcurc.json`
4. **Valeurs par d√©faut** (priorit√© la plus faible)

<Note>
  Les packages li√©s h√©ritent automatiquement des param√®tres de leurs r√®gles de package parent,
  assurant la coh√©rence des versions entre les packages d'√©cosyst√®me.
</Note>

## Exemples

### √âcosyst√®me React

```json
{
  "packageRules": [
    {
      "patterns": ["react", "react-dom"],
      "target": "minor",
      "requireConfirmation": true,
      "relatedPackages": ["@types/react", "@types/react-dom", "react-router-dom"]
    }
  ]
}
```

### Projet TypeScript

```json
{
  "packageRules": [
    {
      "patterns": ["typescript"],
      "target": "minor",
      "requireConfirmation": true
    },
    {
      "patterns": ["@types/*"],
      "target": "latest",
      "autoUpdate": true
    }
  ]
}
```

### Configuration d'entreprise

```json
{
  "defaults": {
    "target": "minor",
    "createBackup": true
  },
  "security": {
    "autoFixVulnerabilities": true,
    "allowMajorForSecurity": true
  },
  "ui": {
    "theme": "minimal",
    "progressBars": true,
    "progressBarStyle": "minimal"
  },
  "advanced": {
    "concurrency": 3,
    "timeout": 60000
  },
  "exclude": ["typescript", "@types/node", "react", "react-dom"]
}
```

---

## Variables d'environnement

Toutes les options CLI peuvent √™tre configur√©es via des variables d'environnement pour l'automatisation et les environnements CI/CD :

<CodeGroup>

```bash {{ title: 'Variables d'environnement globales' }}
# Param√®tres de l'espace de travail
export PCU_WORKSPACE="/path/to/workspace"
export PCU_VERBOSE=true
export PCU_NO_COLOR=true

# Configuration du registre
export PCU_REGISTRY="https://npm.company.com/"
export PCU_TIMEOUT=30000

# Fichier de configuration
export PCU_CONFIG="/path/to/.pcurc.json"
```

```bash {{ title: 'Variables sp√©cifiques aux commandes' }}
# Comportement Check/Update
export PCU_OUTPUT_FORMAT=json
export PCU_UPDATE_TARGET=minor
export PCU_CATALOG=default

# Options de mise √† jour
export PCU_INTERACTIVE=true
export PCU_DRY_RUN=true
export PCU_CREATE_BACKUP=true
export PCU_FORCE=false

# Filtrage
export PCU_INCLUDE="react*,@types/*"
export PCU_EXCLUDE="eslint*"
export PCU_PRERELEASE=false
```

</CodeGroup>

### Priorit√© des variables d'environnement

Les sources de configuration sont charg√©es dans cet ordre (les derni√®res remplacent les premi√®res) :

1. **Valeurs par d√©faut int√©gr√©es** (priorit√© la plus faible)
2. **Configuration globale** (`~/.pcurc.json`)
3. **Configuration du projet** (`.pcurc.json`)
4. **Variables d'environnement** (`PCU_*`)
5. **Drapeaux de ligne de commande** (priorit√© la plus √©lev√©e)

---

## Configuration du registre

PCU lit automatiquement les fichiers de configuration NPM et PNPM pour les param√®tres de registre :

<CodeGroup>

```ini {{ title: '.npmrc / .pnpmrc' }}
# Registre par d√©faut
registry=https://registry.npmjs.org/

# Registres avec port√©e
@mycompany:registry=https://npm.mycompany.com/
@types:registry=https://registry.npmjs.org/

# Jetons d'authentification
//npm.mycompany.com/:_authToken=${NPM_TOKEN}
//registry.npmjs.org/:_authToken=${NPM_PUBLIC_TOKEN}

# Authentification h√©rit√©e (si n√©cessaire)
//npm.mycompany.com/:username=myuser
//npm.mycompany.com/:_password=motdepasseencodeenbase64
//npm.mycompany.com/:email=user@company.com

# Param√®tres SSL et proxy
strict-ssl=true
ca=/path/to/ca.pem
proxy=http://proxy.company.com:8080
https-proxy=http://proxy.company.com:8080
```

```json {{ title: 'Remplacement de registre PCU' }}
{
  "registry": {
    "default": "https://registry.npmjs.org/",
    "scoped": {
      "@mycompany": "https://npm.mycompany.com/",
      "@types": "https://registry.npmjs.org/"
    },
    "auth": {
      "npm.mycompany.com": {
        "token": "${NPM_TOKEN}",
        "type": "Bearer"
      }
    },
    "timeout": 30000,
    "retries": 3,
    "userAgent": "pcu-custom/1.0.0"
  }
}
```

</CodeGroup>

### Priorit√© du registre

1. **Drapeau CLI `--registry`** (priorit√© la plus √©lev√©e)
2. **Configuration PCU** (section registre de `.pcurc.json`)
3. **Projet `.npmrc/.pnpmrc`**
4. **Global `.npmrc/.pnpmrc`**
5. **Registre NPM par d√©faut** (priorit√© la plus faible)

---

## Configuration de cache am√©lior√©e

PCU inclut un syst√®me de cache avanc√© pour am√©liorer les performances :

<CodeGroup>

```json {{ title: 'Configuration du cache' }}
{
  "cache": {
    "enabled": true,
    "ttl": 3600000,
    "maxSize": 52428800,
    "maxEntries": 10000,
    "persistToDisk": true,
    "cacheDir": "~/.pcu/cache",
    "strategy": "lru"
  }
}
```

```bash {{ title: 'Gestion du cache' }}
# Effacer tous les caches
rm -rf ~/.pcu/cache

# Afficher les informations de cache en mode verbeux
pcu -c --verbose

# D√©sactiver le cache pour une seule ex√©cution
pcu -c --no-cache

# D√©finir un r√©pertoire de cache personnalis√©
export PCU_CACHE_DIR="/tmp/pcu-cache"
```

</CodeGroup>

### Param√®tres de cache

<Properties>
  <Property name="enabled" type="boolean" default="true">
    Activer/d√©sactiver le syst√®me de cache
  </Property>
  <Property name="ttl" type="number" default="3600000">
    Dur√©e de vie en millisecondes (1 heure par d√©faut)
  </Property>
  <Property name="maxSize" type="number" default="52428800">
    Taille maximale du cache en octets (50MB par d√©faut)
  </Property>
  <Property name="maxEntries" type="number" default="10000">
    Nombre maximum d'entr√©es de cache
  </Property>
  <Property name="persistToDisk" type="boolean" default="true">
    Sauvegarder le cache sur le disque entre les ex√©cutions
  </Property>
  <Property name="cacheDir" type="string" default="~/.pcu/cache">
    R√©pertoire pour le stockage de cache persistant
  </Property>
  <Property name="strategy" type="enum" default="lru">
    Strat√©gie d'√©viction du cache : lru, fifo, lfu
  </Property>
</Properties>

---

## Configuration de validation

PCU inclut une validation compl√®te avec des suggestions utiles :

<CodeGroup>

```json {{ title: 'Configuration de validation' }}
{
  "validation": {
    "strict": true,
    "warnOnRiskyUpdates": true,
    "requireConfirmationFor": ["major"],
    "suggestions": {
      "enabled": true,
      "includePerformanceTips": true,
      "includeBestPractices": true
    }
  }
}
```

```bash {{ title: 'Exemples de validation' }}
# Activer le mode de validation stricte
pcu -u --force  # Affichera des avertissements sur l'absence de sauvegarde

# Afficher les suggestions de validation
pcu -c --verbose  # Affiche des conseils et suggestions suppl√©mentaires

# Valider le fichier de configuration
node -e "console.log(JSON.parse(require('fs').readFileSync('.pcurc.json')))"
```

</CodeGroup>

### Options de validation

<Properties>
  <Property name="strict" type="boolean" default="false">
    Activer le mode de validation stricte avec des v√©rifications suppl√©mentaires
  </Property>
  <Property name="warnOnRiskyUpdates" type="boolean" default="true">
    Afficher des avertissements pour les mises √† jour potentiellement risqu√©es
  </Property>
  <Property name="requireConfirmationFor" type="array" default="[]">
    Types de mise √† jour n√©cessitant une confirmation : major, minor, patch
  </Property>
  <Property name="suggestions.enabled" type="boolean" default="true">
    Activer les suggestions et conseils utiles
  </Property>
  <Property name="suggestions.includePerformanceTips" type="boolean" default="true">
    Inclure des suggestions d'optimisation des performances
  </Property>
  <Property name="suggestions.includeBestPractices" type="boolean" default="true">
    Inclure des recommandations de bonnes pratiques
  </Property>
</Properties>

---

## Configuration du mode interactif

Configurez les invites interactives et l'exp√©rience utilisateur :

<CodeGroup>

```json {{ title: 'Configuration interactive' }}
{
  "interactive": {
    "enabled": true,
    "pageSize": 15,
    "showPackageDescriptions": true,
    "showReleaseNotes": false,
    "autoComplete": {
      "enabled": true,
      "fuzzyMatching": true,
      "maxSuggestions": 10
    },
    "confirmations": {
      "majorUpdates": true,
      "forceUpdates": true,
      "multiplePackages": false
    }
  }
}
```

```bash {{ title: 'Exemples de mode interactif' }}
# Lancer le mode interactif
pcu -i

# Interactif avec descriptions des packages
pcu -i --verbose  # Affiche plus de d√©tails dans la s√©lection interactive

# Utiliser la s√©lection de th√®me interactive
pcu theme --interactive
```

</CodeGroup>

### Param√®tres interactifs

<Properties>
  <Property name="enabled" type="boolean" default="true">
    Activer les capacit√©s du mode interactif
  </Property>
  <Property name="pageSize" type="number" default="15">
    Nombre d'√©l√©ments affich√©s par page dans les listes
  </Property>
  <Property name="showPackageDescriptions" type="boolean" default="false">
    Afficher les descriptions des packages dans les listes de s√©lection
  </Property>
  <Property name="showReleaseNotes" type="boolean" default="false">
    Afficher les notes de version pour les mises √† jour (n√©cessite le r√©seau)
  </Property>
  <Property name="autoComplete.enabled" type="boolean" default="true">
    Activer l'auto-compl√©tion pour les noms de packages
  </Property>
  <Property name="autoComplete.fuzzyMatching" type="boolean" default="true">
    Activer la correspondance floue pour l'auto-compl√©tion
  </Property>
  <Property name="confirmations.majorUpdates" type="boolean" default="true">
    Exiger une confirmation pour les mises √† jour de version majeure
  </Property>
</Properties>

---

## Configuration Monorepo

PCU fournit des fonctionnalit√©s avanc√©es sp√©cialement con√ßues pour les grands monorepos et la gestion complexe d'espaces de travail.

### Synchronisation des versions

Gardez les packages li√©s synchronis√©s dans votre monorepo :

<CodeGroup>

```json {{ title: 'Configuration de synchronisation de version' }}
{
  "monorepo": {
    "syncVersions": {
      "enabled": true,
      "groups": [
        {
          "name": "react-ecosystem",
          "packages": ["react", "react-dom", "@types/react", "@types/react-dom"],
          "strategy": "exact" // ou "compatible", "latest"
        },
        {
          "name": "testing-libraries",
          "packages": ["jest", "@testing-library/*", "@types/jest"],
          "strategy": "compatible"
        }
      ]
    },
    "catalogPriority": ["default", "react17", "node18"],
    "crossWorkspaceDependencies": {
      "analyze": true,
      "enforce": "warn" // "error", "warn", "off"
    }
  }
}
```

```json {{ title: 'Optimisation des grands espaces de travail' }}
{
  "monorepo": {
    "performance": {
      "batchSize": 50,
      "concurrency": 15,
      "cacheWorkspaceStructure": true,
      "parallelCatalogProcessing": true
    },
    "workspacePackages": {
      "autoDiscover": true,
      "includePrivate": false,
      "excludePatterns": ["**/node_modules", "**/dist", "**/coverage"]
    }
  }
}
```

</CodeGroup>

### Gestion avanc√©e de l'espace de travail

#### Syst√®me de priorit√© des catalogues

D√©finissez quels catalogues ont la priorit√© en cas de conflits :

```json
{
  "catalogPriority": ["production", "default", "experimental"],
  "catalogConflictResolution": "priority" // ou "interactive", "error"
}
```

#### D√©pendances inter-espaces de travail

Analysez et g√©rez les d√©pendances entre les packages de l'espace de travail :

<Properties>
  <Property name="analyze" type="boolean" default="false">
    Analyser les d√©pendances inter-espaces de travail
  </Property>
  <Property name="enforce" type="enum" default="warn">
    Comment g√©rer les incompatibilit√©s de version : error, warn, off
  </Property>
  <Property name="reportUnused" type="boolean" default="true">
    Signaler les packages dans les catalogues non utilis√©s par aucun package d'espace de travail
  </Property>
  <Property name="validateVersions" type="boolean" default="true">
    Valider que tous les packages d'espace de travail utilisent les versions de catalogue
  </Property>
</Properties>

### R√®gles de packages sp√©cifiques aux monorepos

Cr√©ez des r√®gles sophistiqu√©es pour diff√©rentes zones de votre monorepo :

<CodeGroup>

```json {{ title: 'R√®gles de packages Monorepo' }}
{
  "packageRules": [
    {
      "name": "Packages Frontend",
      "patterns": ["react*", "@types/react*", "next*"],
      "workspacePackages": ["apps/web", "apps/admin"],
      "target": "minor",
      "groupUpdate": true,
      "requireConfirmation": true
    },
    {
      "name": "D√©pendances Backend",
      "patterns": ["express*", "@types/express*", "fastify*"],
      "workspacePackages": ["apps/api", "services/*"],
      "target": "patch",
      "autoUpdate": false
    },
    {
      "name": "Outils de d√©veloppement",
      "patterns": ["eslint*", "prettier", "typescript"],
      "workspacePackages": ["*"], // Tous les packages
      "target": "latest",
      "autoUpdate": true,
      "excludeFromProduction": true
    }
  ]
}
```

</CodeGroup>

### Configuration sp√©cifique √† l'espace de travail

Configuration diff√©rente pour diff√©rentes parties de votre monorepo :

<CodeGroup>

```json {{ title: 'R√®gles par espace de travail' }}
{
  "workspaceRules": {
    "apps/web": {
      "defaults": {
        "target": "minor",
        "createBackup": true
      },
      "packageRules": [
        {
          "patterns": ["react*"],
          "target": "patch"
        }
      ]
    },
    "packages/*": {
      "defaults": {
        "target": "latest",
        "requireConfirmation": false
      }
    },
    "tools/*": {
      "defaults": {
        "target": "latest",
        "autoUpdate": true
      }
    }
  }
}
```

</CodeGroup>

### Optimisation des performances pour les grands monorepos

#### Configuration du traitement par lots

<Properties>
  <Property name="batchSize" type="number" default="20">
    Nombre de packages √† traiter dans chaque lot
  </Property>
  <Property name="concurrency" type="number" default="5">
    Nombre maximum d'op√©rations simultan√©es
  </Property>
  <Property name="cacheWorkspaceStructure" type="boolean" default="true">
    Mettre en cache la d√©couverte des packages d'espace de travail entre les ex√©cutions
  </Property>
  <Property name="parallelCatalogProcessing" type="boolean" default="true">
    Traiter plusieurs catalogues en parall√®le
  </Property>
</Properties>

#### Gestion de la m√©moire

```json
{
  "monorepo": {
    "memoryOptimization": {
      "streamingMode": true, // Traiter les packages sans tout charger en m√©moire
      "maxMemoryUsage": "2GB", // Limite de m√©moire pour les grands espaces de travail
      "temporaryFileCleanup": "immediate" // "immediate", "session-end", "manual"
    }
  }
}
```

### Validation Monorepo

Validation compl√®te pour les configurations d'espace de travail complexes :

#### R√®gles de validation

<Properties>
  <Property name="enforceWorkspaceProtocol" type="boolean" default="true">
    Assurer que le protocole workspace: est utilis√© pour les d√©pendances internes
  </Property>
  <Property name="validateCatalogCoverage" type="boolean" default="true">
    Assurer que toutes les d√©pendances sont couvertes par les catalogues
  </Property>
  <Property name="requireConsistentVersions" type="boolean" default="false">
    Exiger que tous les packages d'espace de travail utilisent la m√™me version des d√©pendances
    partag√©es
  </Property>
  <Property name="detectCircularDependencies" type="boolean" default="true">
    D√©tecter les d√©pendances circulaires entre les packages d'espace de travail
  </Property>
</Properties>

### Exemples d'utilisation pour les Monorepos

#### Configuration de monorepo d'entreprise importante

```json
{
  "monorepo": {
    "syncVersions": {
      "enabled": true,
      "groups": [
        {
          "name": "core-frontend",
          "packages": ["react", "react-dom", "react-router", "@types/react*"],
          "strategy": "exact"
        },
        {
          "name": "ui-libraries",
          "packages": ["@company/design-system", "@company/components"],
          "strategy": "workspace"
        }
      ]
    },
    "performance": {
      "batchSize": 100,
      "concurrency": 20,
      "streamingMode": true
    },
    "workspaceRules": {
      "apps/*": { "target": "minor", "requireConfirmation": true },
      "packages/*": { "target": "latest", "autoUpdate": true },
      "tools/*": { "target": "latest", "autoUpdate": true }
    }
  }
}
```

#### Configuration optimis√©e pour CI/CD

```json
{
  "monorepo": {
    "ci": {
      "parallelCatalogProcessing": true,
      "skipInteractivePrompts": true,
      "generateReport": true,
      "reportFormat": "json",
      "exitOnError": true
    },
    "validation": {
      "enforceWorkspaceProtocol": true,
      "validateCatalogCoverage": true,
      "failOnInconsistentVersions": true
    }
  }
}
```
